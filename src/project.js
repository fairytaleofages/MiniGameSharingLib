window.__require=function e(t,o,n){function a(i,s){if(!o[i]){if(!t[i]){var c=i.split("/");if(c=c[c.length-1],!t[c]){var l="function"==typeof __require&&__require;if(!s&&l)return l(c,!0);if(r)return r(c,!0);throw new Error("Cannot find module '"+i+"'")}}var u=o[i]={exports:{}};t[i][0].call(u.exports,function(e){return a(t[i][1][e]||e)},u,u.exports,e,t,o,n)}return o[i].exports}for(var r="function"==typeof __require&&__require,i=0;i<n.length;i++)a(n[i]);return a}({AnimNode:[function(e,t,o){"use strict";cc._RF.push(t,"e3284wLuZFKh46Gwdd+Sdn8","AnimNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../game/manager/mgrCfg"),a=e("../../game/manager/mgrDirector"),r=e("../utils/Tools"),i=e("../component/LifeCycleMonitor"),s=function(e){function t(t){var o=e.call(this)||this;return o.nodeResource=null,o.clipName=null,o.animData=n.default.get("anim_node_db",t),o.addComponent(i.default).setOnLoadCallback(o.onLoad.bind(o)),o}return __extends(t,e),t.prototype.onLoad=function(){this._loadResourceNode()},t.prototype._onPreDestroy=function(){if(cc.isValid(this.nodeResource)){var t=this.nodeResource.getComponent(cc.Animation);cc.isValid(t)&&t.stop()}e.prototype._onPreDestroy&&e.prototype._onPreDestroy.call(this)},t.prototype._loadResourceNode=function(){var e=this,t=this.animData;a.default.loadRes(t.prefabFileName,cc.Prefab,function(t,o){if(t)cc.warn("AnimNode._loadResourceNode error:",t);else if(cc.isValid(e)){var n=cc.instantiate(o);n.parent=e,e.nodeResource=n,e.play(e.clipName),e.callback&&e.registerEventCallback(e.callback)}else cc.warn("AnimNode._loadResourceNode on loadRes finish, this is invalid!")})},t.prototype.reset=function(){this.active=!0,this.rotation=0,this.setPosition(0,0),this.scaleX=this.animData.scaleX,this.scaleY=this.animData.scaleY,this.opacity=255},t.prototype.play=function(e){if(this.clipName=e,this.nodeResource&&cc.isValid(this)){var t=this.nodeResource.getComponent(cc.Animation);if(cc.isValid(t)){if(!e){var o=t.getClips();o.length>0?e=o[0].name:cc.warn("AnimNode.play clip not found!",e)}t.play(e)}}},t.prototype.registerEventCallback=function(e){if(this.callback=e,this.nodeResource&&cc.isValid(this)){this.unregisterEventCallback(),this.callback=e;var t=this.nodeResource.getComponent(cc.Animation);t.on("play",this.onAnimationPlay,this),t.on("stop",this.onAnimationStop,this),t.on("pause",this.onAnimationPause,this),t.on("resume",this.onAnimationResume,this),t.on("lastframe",this.onAnimationLastframe,this),t.on("finished",this.onAnimationFinished,this)}},t.prototype.unregisterEventCallback=function(){if(this.callback=null,this.nodeResource&&cc.isValid(this)){var e=this.nodeResource.getComponent(cc.Animation);e.off("play",this.onAnimationPlay,this),e.off("stop",this.onAnimationStop,this),e.off("pause",this.onAnimationPause,this),e.off("resume",this.onAnimationResume,this),e.off("lastframe",this.onAnimationLastframe,this),e.off("finished",this.onAnimationFinished,this)}},t.prototype.isLoaded=function(){return cc.isValid(this.nodeResource)},t.prototype._onEvent=function(e,t){if(cc.isValid(this.nodeResource)){var o=this.nodeResource.getComponent(cc.Animation).currentClip.name;this.callback instanceof Function&&this.callback({name:t,clipName:o})}},t.prototype.onAnimationPlay=function(e){this._onEvent(e,"play")},t.prototype.onAnimationStop=function(e){this._onEvent(e,"stop")},t.prototype.onAnimationPause=function(e){this._onEvent(e,"pause")},t.prototype.onAnimationResume=function(e){this._onEvent(e,"resume")},t.prototype.onAnimationLastframe=function(e){this._onEvent(e,"lastframe")},t.prototype.onAnimationFinished=function(e){this._onEvent(e,"finished")},t.prototype.setColorEx=function(e){r.default.setCascadeColor(this,e)},t}(cc.Node);o.default=s,cc._RF.pop()},{"../../game/manager/mgrCfg":"mgrCfg","../../game/manager/mgrDirector":"mgrDirector","../component/LifeCycleMonitor":"LifeCycleMonitor","../utils/Tools":"Tools"}],Base64:[function(e,t,o){"use strict";cc._RF.push(t,"b84der7CppMXapFQITVgKSQ","Base64"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(){function e(){}return e.encodeForUrl=function(e){var t=this.encode(e);return t?t=(t=t.replace("+","-")).replace("/","*"):null},e.decodeForUrl=function(e){return e?(e=(e=e.replace("-","+")).replace("*","/"),this.decode(e)):null},e.encode=function(e){var t,o,n,a,r,i,s,c="",l=0;for(e=this._utf8_encode(e);l<e.length;)a=(t=e.charCodeAt(l++))>>2,r=(3&t)<<4|(o=e.charCodeAt(l++))>>4,i=(15&o)<<2|(n=e.charCodeAt(l++))>>6,s=63&n,isNaN(o)?i=s=64:isNaN(n)&&(s=64),c=c+this._keyStr.charAt(a)+this._keyStr.charAt(r)+this._keyStr.charAt(i)+this._keyStr.charAt(s);return c},e.decode=function(e){var t,o,n,a,r,i,s="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=this._keyStr.indexOf(e.charAt(c++))<<2|(a=this._keyStr.indexOf(e.charAt(c++)))>>4,o=(15&a)<<4|(r=this._keyStr.indexOf(e.charAt(c++)))>>2,n=(3&r)<<6|(i=this._keyStr.indexOf(e.charAt(c++))),s+=String.fromCharCode(t),64!=r&&(s+=String.fromCharCode(o)),64!=i&&(s+=String.fromCharCode(n));return s=this._utf8_decode(s)},e._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",o=0;o<e.length;o++){var n=e.charCodeAt(o);n<128?t+=String.fromCharCode(n):n>127&&n<2048?(t+=String.fromCharCode(n>>6|192),t+=String.fromCharCode(63&n|128)):(t+=String.fromCharCode(n>>12|224),t+=String.fromCharCode(n>>6&63|128),t+=String.fromCharCode(63&n|128))}return t},e._utf8_decode=function(e){for(var t="",o=0,n=0,a=0,r=0;o<e.length;)(n=e.charCodeAt(o))<128?(t+=String.fromCharCode(n),o++):n>191&&n<224?(a=e.charCodeAt(o+1),t+=String.fromCharCode((31&n)<<6|63&a),o+=2):(a=e.charCodeAt(o+1),r=e.charCodeAt(o+2),t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&r),o+=3);return t},e._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e=__decorate([a],e)}());o.default=r,cc._RF.pop()},{}],CfgParser:[function(e,t,o){"use strict";cc._RF.push(t,"28a48t7aL9M2aeRvb7tTw6M","CfgParser"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(){function e(){}var t;return t=e,e.parseCfgByJsonObj=function(e,t,o){var n=this.preprocess(e,t);return this.formatDb(e,n,o,t.fields)},e.parseNumber=function(e){var t=parseFloat(e);return isNaN(t)&&(t=null),t},e.parseString=function(e){return e},e.parseArray=function(e){var t=null;try{(t=JSON.parse(e))instanceof Array||(t=null)}catch(e){}return t},e.parseObject=function(e){var t=null;try{(t=JSON.parse(e))instanceof Object||(t=null)}catch(e){}return t},e.parseBoolean=function(e){return"TRUE"==e||"true"==e},e.parseValue=function(e,t){var o=this.PARSE_FUNCTIONS[t];if(!o)return"";var n=o(e);if(null==n){var a=this.PARSE_DEFAULT_VALUE_CREATORS[t]();return e.length>0&&cc.log("[\u8b66\u544a] CfgParser.parseValue \u89e3\u6790\u9519\u8bef\uff1atype="+t+", srcValue=["+e+"], \u9ed8\u8ba4\u503c=["+a+"]]"),a}return n},e.preprocess=function(e,t){var o=[],n=t.types||[],a=t.fields||[],r=t.values||[];if(!(r.length<=0)){if(n.length!=r[0].length||a.length!=r[0].length)return cc.log("[\u8b66\u544a] CfgParser.preprocessData  "+e+" \u6570\u636e\u957f\u5ea6\u4e0d\u5339\u914d\uff01"),[];for(var i=0;i<r.length;i++){for(var s=r[i],c={},l=0;l<s.length;l++){var u=n[l],d=a[l],p=s[l];c[d]=this.parseValue(p,u)}o.push(c)}return o}cc.log("[\u8b66\u544a] CfgParser.preprocessData "+e+" \u6570\u636e\u4e3a\u7a7a")},e.formatDb=function(e,t,o,n){for(var a=o.split(""),r={},i=0;i<t.length;i++){for(var s=t[i],c=r,l=0;l<a.length-1;l++){var u=c[p=s[n[l]]];u||(u=l==a.length-2&&"a"==a[a.length-1]?[]:{},c[p]=u),c=u}var d=a[a.length-1];if("m"==d){var p;if(null!=c[p=s[n[a.length-1]]]){var h="db";for(l=0;l<a.length;l++)h+="["+s[n[l]]+"]";cc.log("[\u8b66\u544a] CfgParser.formatDb  "+e+" \u5b57\u6bb5\u88ab\u8986\u76d6\uff01",h,c[p])}c[p]=s}else"a"==d&&(c instanceof Array||1==a.length&&(r=c=[]),c instanceof Array?c.push(s):cc.log("[\u8b66\u544a] CfgParser.formatDb  "+e+" a\u6a21\u5f0f\uff0c\u5bb9\u5668\u4e0d\u662f\u6570\u7ec4\uff01"))}return r},e.PARSE_FUNCTIONS={A:t.parseArray,O:t.parseObject,N:t.parseString,S:t.parseString,I:t.parseNumber,F:t.parseNumber,B:t.parseBoolean},e.PARSE_DEFAULT_VALUE_CREATORS={A:function(){return[]},O:function(){return{}},N:function(){return""},S:function(){return""},I:function(){return 0},F:function(){return 0},B:function(){return!1}},e=t=__decorate([a],e)}());o.default=r,cc._RF.pop()},{}],Const:[function(e,t,o){"use strict";cc._RF.push(t,"c54bf4JLl9PjLK3VwVekJ0m","Const"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass;n.property;(function(e){e[e.none=1]="none",e[e.releax=2]="releax",e[e.careful=3]="careful"})(o.AdMode||(o.AdMode={})),function(e){e[e.locked=1]="locked",e[e.unlocked=2]="unlocked",e[e.finished=3]="finished",e[e.received=4]="received"}(o.AchievementState||(o.AchievementState={})),function(e){e[e.sprite=1]="sprite",e[e.spine=2]="spine",e[e.particle=3]="particle",e[e.animNode=4]="animNode"}(o.ResourceType||(o.ResourceType={})),function(e){e[e.canSign=1]="canSign",e[e.signed=2]="signed",e[e.signOver=3]="signOver",e[e.waitGap=4]="waitGap"}(o.SignState||(o.SignState={})),function(e){e[e.none_passAll=0]="none_passAll",e[e.none_blockkAll=1]="none_blockkAll",e[e.none_passHole=2]="none_passHole",e[e.mask_passAll=3]="mask_passAll",e[e.mask_blockAll=4]="mask_blockAll",e[e.mask_passHole=5]="mask_passHole"}(o.GuideMaskType||(o.GuideMaskType={})),function(e){e[e.body=1]="body",e[e.side=2]="side",e[e.top=3]="top",e[e.sideDeco=4]="sideDeco",e[e.ornament=5]="ornament",e[e.plate=6]="plate"}(o.CakePartType||(o.CakePartType={}));var r=function(){function e(){}return e.LOCAL_PATCH_INFO=null,e.GAME_VERSION="unknown",e.IS_OPEN_VIDEO_RECORD=!0,e.HAD_TIP_USER_LOGIN=!0,e.IS_SHOW_URL_AD_ICON=!1,e.IS_COP_OPEN_PAY=!1,e.PAY_CHANNEL=null,e.LOCAL_PUBLISH_CHANNEL="",e.ANDROID_SWITCH_THIRD_EXIT=!1,e.ANDROID_SWITCH_MORE_GAME=!1,e.ANDROID_SWITCH_ABOUT=!1,e.ANDROID_SWITCH_MUSIC_ENABLED=!1,e.PACKAGE_VERSION=null,e.B_SDK_HAS_WEB_VIEW=!0,e.ACHIEVEMENT_CATEGORY_LIST=1,e.ACHIEVEMENT_CATEGORY_FARM=2,e.ACHIEVEMENT_CATEGORY_COOKBOOK=3,e.ACHIEVEMENT_CATEGORY_ROOM=4,e.ACHIEVEMENT_CATEGORY_KITCHEN=5,e.ITEM_ID_RMB=1,e.ITEM_ID_GOLD=2,e.ITEM_ID_KEY=3,e.ITEM_ID_ENERGY=4,e.ITEM_ID_MAX_ENERGY=5,e.ITEM_ID_PVE_ITEM=6,e.ITEM_ID_FRAGMENT=7,e.ITEM_ID_OPEN_CHEST=8,e.ITEM_ID_VIDEO_SHARE_COUNT=9,e.ITEM_ID_SHARE_COUNT=10,e.ITEM_ID_WIPE_AD=11,e.ITEM_FLAG_MONEY=1,e.ITEM_FLAG_PART=2,e.ITEM_FLAG_PART_BLUEPRINT=3,e.ITEM_FLAG_MATERIAL=4,e.ITEM_FLAG_PLAYER_ATTR=5,e.ITEM_FLAG_NPC_GIFT=6,e.GLOBAL_ORDER_TIP_ICON=900,e.GLOBAL_ORDER_DIALOG=1e3,e.GLOBAL_ORDER_TIP=1100,e.GLOBAL_ORDER_GUIDE=1200,e.GLOBAL_ORDER_WARP_SCENE_NODE=1e4,e.GLOBAL_ORDER_MASK=10001,e.RESOLUTION_RANGE={maxWidth:768,minWidth:576,maxHeight:1344,minHeight:1024},e.SERVER_HOST="https://rank.ultralisk.cn",e.SERVER_URL_FORMAT="%s/ultralisk/",e.SERVER_APP_ID=57,e.SERVER_RANK_ID=62,e.WARP_SCENE_MIN_LOAD_TIME=.1,e.B_PROMISE_RESOLVE_NEED_WAIT=!0,e.PROMISE_RESOLVE_WAIT_TIME=1,e.AD_VIDEO_VALID_COUNT=1,e.ITEM_ID_PLAYER=99,e.RADIAN2EULAR=180/Math.PI,e=__decorate([a],e)}();o.default=r,cc._RF.pop()},{}],DebugMenu:[function(e,t,o){"use strict";cc._RF.push(t,"c2312XTyQZI+6yxGda96ndc","DebugMenu"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../game/view/node/LayerColor"),a=e("../utils/Tools"),r=function(e){function t(t,o,r,i){void 0===i&&(i=4);var s=e.call(this)||this,c=o+2*i,l=r*t.length+i*(t.length+1),u=new n.default(cc.color(63,63,63,191));u.parent=s,u.setContentSize(c,l),u.setAnchorPoint(0,1);for(var d=-i,p=function(e){var s=t[e],c=s[0],l=s[1],p=new n.default(cc.color(0,0,0,63));p.parent=u,p.setContentSize(o,r),p.x=i+o/2,p.y=d-e*(i+r)-r/2;var h=new cc.Node;h.parent=p;var f=h.addComponent(cc.Label);f.fontSize=20,f.string=c,f.verticalAlign=cc.Label.VerticalAlign.CENTER,a.default.registerTouchHandler(p,function(e){"began"==e.name?h.color=cc.color(0,255,0):"ended"==e.name&&(h.color=cc.color(255,255,255),l())})},h=0;h<t.length;h++)p(h);return s}return __extends(t,e),t}(cc.Node);o.default=r,cc._RF.pop()},{"../../game/view/node/LayerColor":"LayerColor","../utils/Tools":"Tools"}],DebugMouseControlNode:[function(e,t,o){"use strict";cc._RF.push(t,"bfaedijI1JElr+wGeM26gAa","DebugMouseControlNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,cc.Event.EventMouse.BUTTON_RIGHT),i=cc.Event.EventMouse.BUTTON_MIDDLE,s=function(e){function t(){var t=e.call(this)||this;return t.registerEvents(),t}return __extends(t,e),t.prototype.cleanup=function(){this._listener&&cc.eventManager.removeListener(this._listener)},t.prototype.registerEvents=function(){this.mousePressd={},this.registerMouseListener()},t.prototype.registerMouseListener=function(){var e=this,t=cc.EventListener.create({event:cc.EventListener.MOUSE,onMouseUp:function(t){t.name="up",e.onMouseHandler(t)},onMouseMove:function(t){t.name="move",e.onMouseHandler(t)},onMouseDown:function(t){t.name="down",e.onMouseHandler(t)},onMouseScroll:function(t){t.name="scroll",e.onMouseHandler(t)}});cc.eventManager.addListener(t,this)},t.prototype.onCameraTranslation=function(e,t){this.bPressedCtrl&&(e*=.1,t*=.1);var o=this.x,n=this.y;this.setPosition(o+e,n+t)},t.prototype.onCameraZoom=function(e,t,o){e=cc.misc.clampf(e,-1,1),cc.sys.isBrowser&&(e*=-1),this.bPressedCtrl&&(e*=.1);var n=this.convertToNodeSpace(cc.v2(t,o)),a=this.scale;this.scale=Math.max(.5,a+.5*-e);var r=this.convertToWorldSpace(n),i=this.x,s=this.y;this.setPosition(i+(t-r.x),s+(o-r.y))},t.prototype.onMouseHandler=function(e){var t=e.getButton(),o=e.getLocation(),n=(e.getScrollX(),e.getScrollY());switch(e.name){case"down":this.mousePressd[t]=!0;break;case"move":this.mousePressd[r]&&this.onCameraTranslation(e.getDeltaX(),e.getDeltaY());break;case"up":this.mousePressd[t]=!1,t==i&&(this.setPosition(0,0),this.scale=1);break;case"scroll":this.onCameraZoom(n,o.x,o.y)}},t=__decorate([a],t)}(cc.Node);o.default=s,cc._RF.pop()},{}],DialogBase:[function(e,t,o){"use strict";cc._RF.push(t,"1142doFnitPdpYq8C742uzP","DialogBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../game/manager/mgrDirector"),a=e("../../game/view/node/LayerColor"),r=e("../utils/Tools"),i=e("./ViewBase"),s=e("../../game/Const"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._viewName="",n.bClosing=!1,n.DEFAULT_SHADOW_OPACITY=200,n.bOpenCompleted=!1;var a=t.__viewName||"";return a&&(n._viewName=a,o.CUR_VIEWS[a]=!0),n}var o;return __extends(t,e),o=t,t.hasDialogExists=function(){return this.GLOBAL_DIALOG_COUNT>0},t.clearViews=function(){o.CUR_VIEWS={}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),o.GLOBAL_DIALOG_COUNT++},t.prototype.onResourceLoaded=function(){var t=this;if(e.prototype.onResourceLoaded.call(this),this.context.bImmediately)this.layerShadow&&(this.layerShadow.active=!0),this._onOpenDialogCompleted();else{if(this.layerShadow&&(this.layerShadow.active=!0,this.layerShadow.opacity=0,this.layerShadow.runAction(cc.fadeTo(.3,this.getShadowOpacity())).setTag(o.ACTION_TAG_OPEN)),this.bClosing)return;var n=this.getComponent(cc.Animation);if(cc.isValid(n)){var a=n.play("defaultDialogOpen");a.speed=a.duration/.3,n.on("finished",function(){t._onOpenDialogCompleted(),n.targetOff(t)},this),n.setCurrentTime(1/60)}else this.scale=.5,this.runAction(cc.sequence(cc.scaleTo(.3,1).easing(cc.easeBackOut()),cc.callFunc(this._onOpenDialogCompleted.bind(this)))).setTag(o.ACTION_TAG_OPEN)}},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),o.GLOBAL_DIALOG_COUNT--,this.bClosing||(this.bClosing=!0,this.context.fOnDialogClose&&this.context.fOnDialogClose instanceof Function&&this.context.fOnDialogClose())},t.prototype._onOpenDialogCompleted=function(){this.onOpenDialogCompleted(),this.bOpenCompleted=!0},t.prototype.onOpenDialogCompleted=function(){},t.prototype._loadResource=function(){var t=this.getComponent(cc.Animation);if(!t){t=this.addComponent(cc.Animation);for(var o=[n.default.tryGetRes("2d/animation/defaultDialogOpen",cc.AnimationClip),n.default.tryGetRes("2d/animation/defaultDialogClose",cc.AnimationClip)],a=0;a<o.length;a++)t.addClip(o[a])}e.prototype._loadResource.call(this)},t.prototype.openDialog=function(e){void 0===e&&(e=!1);var t=n.default.getUIRoot();if(this.nodeRoot=new cc.Node,this.nodeRoot.parent=t,this.nodeRoot.zIndex=s.default.GLOBAL_ORDER_DIALOG,this.isShadowEnabled()){var o=new a.default(cc.color(0,0,0,this.getShadowOpacity()));o.setContentSize(cc.winSize),o.zIndex=-1,o.parent=this.nodeRoot,o.active=!1,r.default.registerTouchHandler(o,this.onTouchLayerShadow.bind(this),!0),this.layerShadow=o}e=e||this.context.bImmediately,this.context.bImmediately=e,this.parent=this.nodeRoot},t.prototype.closeDialog=function(e){void 0===e&&(e=!1),this.bClosing||(o.CUR_VIEWS[this._viewName]=!1,this.bClosing=!0,this.closeDialogEx(e))},t.prototype.closeDialogEx=function(e){var t=this;if(this.context.fOnDialogClose&&this.context.fOnDialogClose instanceof Function&&this.context.fOnDialogClose(),cc.isValid(this.layerShadow)&&(r.default.unregisterTouchHandler(this.layerShadow),this.layerShadow.stopActionByTag(o.ACTION_TAG_OPEN)),this.stopActionByTag(o.ACTION_TAG_OPEN),cc.isValid(this.nodeRoot))if(e)this.nodeRoot.destroy();else{this.layerShadow&&this.layerShadow.runAction(cc.fadeOut(.2)),this.runAction(cc.spawn(cc.scaleTo(.2,1.2,0).easing(cc.easeBackIn()),cc.sequence(cc.delayTime(.2*.7),cc.fadeOut(.06).easing(cc.easeOut(2)),cc.callFunc(function(){t.nodeRoot.destroy()})))).setTag(o.ACTION_TAG_CLOSE)}},t.prototype.isShadowEnabled=function(){return!0},t.prototype.getShadowOpacity=function(){return this.DEFAULT_SHADOW_OPACITY},t.prototype.isClickShadowClose=function(){return!0},t.prototype.playOpenDialogSound=function(){},t.prototype.onTouchLayerShadow=function(e){e.isClick()&&(this.bOpenCompleted?this.isClickShadowClose()&&(this.sendMsg("MSG_GUIDE_POINT",{id:"DialogBase.shadow.click"}),this.closeDialog()):cc.warn("DialogBase.onTouchLayerShadow dialog is opening"))},t.GLOBAL_DIALOG_COUNT=0,t.CUR_VIEWS={},t.ACTION_TAG_OPEN=1,t.ACTION_TAG_CLOSE=2,t=o=__decorate([l],t)}(i.default));o.default=u,cc._RF.pop()},{"../../game/Const":"Const","../../game/manager/mgrDirector":"mgrDirector","../../game/view/node/LayerColor":"LayerColor","../utils/Tools":"Tools","./ViewBase":"ViewBase"}],EditorCakeItem:[function(e,t,o){"use strict";cc._RF.push(t,"d92bea2hodOHqinGv2YXQkX","EditorCakeItem"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("./../../../ulframework/view/SceneBase"),r=e("../../Const"),i=e("../../../ulframework/view/ReuseList"),s=e("./../../manager/mgrCfg"),c=e("./../../manager/mgrCake"),l=e("./../../../ulframework/utils/Tools"),u=e("./../../manager/mgrTip"),d=e("../../../ulframework/view/ReuseLayouterVBox"),p=e("../node/vAvatar"),h=e("./EditorTransformController"),f=cc._decorator,g=f.ccclass,m=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonBody=null,t.buttonDecoSelectOneBody=null,t.buttonFirstLayerBodySelect=null,t.buttonFirstLayerDecoSelect=null,t.buttonFirstLayerOrnamentSelect=null,t.buttonFirstLayerPlateSelect=null,t.buttonFirstLayerSideSelect=null,t.buttonFirstLayerTopSelect=null,t.buttonInside=null,t.buttonInsideDeco=null,t.buttonOrnament=null,t.buttonOrnamentSelectOneBody=null,t.buttonPlate=null,t.buttonPlateSelectOneBody=null,t.buttonSecondLayerBodySelect=null,t.buttonSecondLayerSideSelect=null,t.buttonSecondLayerTopSelect=null,t.buttonSideSelectOneBody=null,t.buttonThirdLayerBodySelect=null,t.buttonThirdLayerSideSelect=null,t.buttonThirdLayerTopSelect=null,t.buttonTop=null,t.buttonTopSelectOneBody=null,t.labelTitle=null,t.nodeBg=null,t.nodeBodyOperation=null,t.nodeDecoOperation=null,t.nodeEditorControllerParent=null,t.nodeList=null,t.nodeOrnamentOperation=null,t.nodePlateOperation=null,t.nodeRoot=null,t.nodeSideOperation=null,t.nodeTopOperation=null,t.nodeTrash=null,t.curSelectedType=r.CakePartType.body,t.curSelectedPartId=null,t.listParts=null,t.viewAvatar=null,t.editController=null,t.prePartId=0,t}return __extends(t,e),t.prototype._getResourceName=function(){return"_editor/EditorCakeItem"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonBody:{varname:"buttonBody",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonBody"}]},CC_buttonDecoSelectOneBody:{varname:"buttonDecoSelectOneBody",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonDecoSelectOneBody"}]},CC_buttonFirstLayerBodySelect:{varname:"buttonFirstLayerBodySelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonFirstLayerBodySelect"}]},CC_buttonFirstLayerDecoSelect:{varname:"buttonFirstLayerDecoSelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonFirstLayerDecoSelect"}]},CC_buttonFirstLayerOrnamentSelect:{varname:"buttonFirstLayerOrnamentSelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonFirstLayerOrnamentSelect"}]},CC_buttonFirstLayerPlateSelect:{varname:"buttonFirstLayerPlateSelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonFirstLayerPlateSelect"}]},CC_buttonFirstLayerSideSelect:{varname:"buttonFirstLayerSideSelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonFirstLayerSideSelect"}]},CC_buttonFirstLayerTopSelect:{varname:"buttonFirstLayerTopSelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonFirstLayerTopSelect"}]},CC_buttonInside:{varname:"buttonInside",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonInside"}]},CC_buttonInsideDeco:{varname:"buttonInsideDeco",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonInsideDeco"}]},CC_buttonOrnament:{varname:"buttonOrnament",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonOrnament"}]},CC_buttonOrnamentSelectOneBody:{varname:"buttonOrnamentSelectOneBody",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonOrnamentSelectOneBody"}]},CC_buttonPlate:{varname:"buttonPlate",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonPlate"}]},CC_buttonPlateSelectOneBody:{varname:"buttonPlateSelectOneBody",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonPlateSelectOneBody"}]},CC_buttonSecondLayerBodySelect:{varname:"buttonSecondLayerBodySelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonSecondLayerBodySelect"}]},CC_buttonSecondLayerSideSelect:{varname:"buttonSecondLayerSideSelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonSecondLayerSideSelect"}]},CC_buttonSecondLayerTopSelect:{varname:"buttonSecondLayerTopSelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonSecondLayerTopSelect"}]},CC_buttonSideSelectOneBody:{varname:"buttonSideSelectOneBody",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonSideSelectOneBody"}]},CC_buttonThirdLayerBodySelect:{varname:"buttonThirdLayerBodySelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonThirdLayerBodySelect"}]},CC_buttonThirdLayerSideSelect:{varname:"buttonThirdLayerSideSelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonThirdLayerSideSelect"}]},CC_buttonThirdLayerTopSelect:{varname:"buttonThirdLayerTopSelect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonThirdLayerTopSelect"}]},CC_buttonTop:{varname:"buttonTop",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonTop"}]},CC_buttonTopSelectOneBody:{varname:"buttonTopSelectOneBody",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonTopSelectOneBody"}]},CC_labelTitle:{varname:"labelTitle",vartype:cc.Label},CC_nodeBg:{varname:"nodeBg",vartype:cc.Node},CC_nodeBodyOperation:{varname:"nodeBodyOperation",vartype:cc.Node},CC_nodeDecoOperation:{varname:"nodeDecoOperation",vartype:cc.Node},CC_nodeEditorControllerParent:{varname:"nodeEditorControllerParent",vartype:cc.Node},CC_nodeList:{varname:"nodeList",vartype:cc.Node},CC_nodeOrnamentOperation:{varname:"nodeOrnamentOperation",vartype:cc.Node},CC_nodePlateOperation:{varname:"nodePlateOperation",vartype:cc.Node},CC_nodeRoot:{varname:"nodeRoot",vartype:cc.Node},CC_nodeSideOperation:{varname:"nodeSideOperation",vartype:cc.Node},CC_nodeTopOperation:{varname:"nodeTopOperation",vartype:cc.Node},CC_nodeTrash:{varname:"nodeTrash",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buildUi()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){var e=this;this.viewAvatar=new p.default,this.viewAvatar.parent=this.nodeRoot,this.viewAvatar.setTouchNodeCallback(this.onTouchRes.bind(this)),this.editController=new h.default,this.editController.parent=this.nodeEditorControllerParent;var t=(new d.default).setCellSize(200,60).setGap(10).setPending(10),o=new i.default;o.parent=this.nodeList,o.setContentSize(this.nodeList.getContentSize()),o.setLayouter(t),o.setCreator(function(t){var o=new cc.Node;o.addComponent(cc.Label).fontSize=24,o.parent=t,t.item=o,l.default.registerTouchHandler(t,function(o){o.isClick()&&e.selectPart(t.item.data.id)})}),o.setSetter(function(t,o){var n=ul.format("%s",s.default.get_from_cake_part_db(o.id,"name"));t.item.getComponent(cc.Label).string=n,t.item.materialData=o,t.item.color=e.curSelectedPartId==o.id?cc.color(0,255,0):cc.color(255,255,255),t.item.data=o}),this.listParts=o},t.prototype.fillPartListByType=function(e){this.curSelectedType=e;var t=c.default.getPartsByType(e);this.listParts.setDatas(t)},t.prototype.selectPart=function(e){this.curSelectedPartId=e;var t=s.default.get_from_cake_part_db(e);this.nodeBodyOperation.active=t.type==r.CakePartType.body,this.nodeSideOperation.active=t.type==r.CakePartType.side,this.nodeDecoOperation.active=t.type==r.CakePartType.sideDeco,this.nodeTopOperation.active=t.type==r.CakePartType.top,this.nodeOrnamentOperation.active=t.type==r.CakePartType.ornament,this.nodePlateOperation.active=t.type==r.CakePartType.plate,this.listParts.refreshActiveCells(),this.setPrePartId(0),this.viewAvatar.takeOffAll(),this.viewAvatar.replace(e)},t.prototype.__operate_body_showShapePicker=function(e){for(var t=this,o=c.default.getShapesByType(this.curSelectedType),n=[],a=0;a<o.length;a++){var r=o[a],i=c.default.getShapeName(this.curSelectedType,r);n.push({text:i,value:{layer:e,shape:r}})}u.default.showPicker("\u9009\u4e2d\u4e00\u4e2a\u5f62\u72b6",n,function(e){t.__operate_body_SelectOneShape(e)})},t.prototype.__operate_body_SelectOneShape=function(e){for(var t=this,o=c.default.getColorsByTypeShapeType(this.curSelectedType,e.shape),n=[],a=0;a<o.length;a++){var r=o[a];n.push({text:r.colorName,value:{layer:e.layer,shape:e.shape,color:r.colorId}})}u.default.showPicker("\u9009\u4e2d\u4e00\u4e2a\u989c\u8272",n,function(e){t.__operate_body_SelectOneColor(e)})},t.prototype.__operate_body_SelectOneColor=function(e){cc.log("@@@:__operate_body_SelectOneColor");var t=s.default.get_from_cake_part_db(this.curSelectedPartId),o=c.default.getRestByType_ShapeType_Color(this.curSelectedType,e.shape,e.color),n=this.getPreBodyId(this.curSelectedPartId),a=s.default.get_from_cake_type_db(this.curSelectedType);cc.log(a.defaultIndexs);for(var r=a.defaultIndexs[e.layer-1],i=t.editorData[n]||[],l=0;l<i.length;l++){if(i[l].zIndex==r){i.splice(l,1);break}}i.push({resType:o.resType,resId:o.resId,pos:cc.v2(0,0),zIndex:r,scale:1}),t.editorData[n]=i,this.viewAvatar.takeOffAll(),this.viewAvatar.replace(n),this.viewAvatar.setOpacityExByPartId(180,n),this.viewAvatar.offResNodeTouByPartId(n),this.viewAvatar.replace(this.curSelectedPartId)},t.prototype.getPreBodyId=function(e){var t=s.default.get_from_cake_part_db(e);return 0==s.default.get_from_cake_type_db(t.type).prePartType?0:this.getPrePartId()},t.prototype.onTouchRes=function(e){var t=e.target;if(t&&t.__partId==this.curSelectedPartId){for(var o=s.default.get_from_cake_part_db(this.curSelectedPartId),n=1,a={},r=this.getPreBodyId(this.curSelectedPartId),i=o.editorData[r]||[],c=0;c<i.length;c++){var d=i[c];d.resType==t.resType&&d.resId==t.resId&&d.zIndex==t.zIndex&&(n=c),d.zIndex!=n&&(a[d.zIndex]=d.zIndex)}if(l.default.isWorldInLocalNode(this.nodeTrash,t.convertToWorldSpaceAR(cc.v2(0,0))))i.splice(n,1),this.viewAvatar.takeOffAll(),this.viewAvatar.replace(this.curSelectedPartId);else{t.setPosition(t.parent.convertToNodeSpaceAR(e.getLocation()));var p=i[n];p.pos=t.position,p.scale=t.scale,p.zIndex=t.zIndex,this.editController.setTarget(t,function(){if(null==a[t.zIndex]){var e=i[n];e.pos=t.position,e.scale=t.scale,e.zIndex=t.zIndex}else u.default.showMsgTip("\u51fa\u9519\u5566, \u5c42\u7ea7\u91cd\u590d, \u5feb\u68c0\u67e5\u4e00\u4e0b\u5427")})}}},t.prototype.showBodyPicker=function(){for(var e=this,t=[],o=c.default.getPartsByType(r.CakePartType.body),n=0;n<o.length;n++){var a=o[n];t.push({text:a.name,value:a.id})}u.default.showPicker("\u9009\u4e00\u4e2a\u7cd5\u4f53\u5427",t,function(t){e.setPrePartId(t),e.viewAvatar.replace(t),e.viewAvatar.setOpacityExByPartId(180,t),e.viewAvatar.offResNodeTouByPartId(t)})},t.prototype.setPrePartId=function(e){this.prePartId=e},t.prototype.getPrePartId=function(){return this.prePartId},t.prototype.onTouchButtonBody=function(e){this.fillPartListByType(r.CakePartType.body)},t.prototype.onTouchButtonInside=function(e){this.fillPartListByType(r.CakePartType.side)},t.prototype.onTouchButtonInsideDeco=function(e){this.fillPartListByType(r.CakePartType.sideDeco)},t.prototype.onTouchButtonOrnament=function(e){this.fillPartListByType(r.CakePartType.ornament)},t.prototype.onTouchButtonPlate=function(e){this.fillPartListByType(r.CakePartType.plate)},t.prototype.onTouchButtonTop=function(e){this.fillPartListByType(r.CakePartType.top)},t.prototype.onTouchButtonFirstLayerBodySelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(1)},t.prototype.onTouchButtonSecondLayerBodySelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(2)},t.prototype.onTouchButtonThirdLayerBodySelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(3)},t.prototype.onTouchButtonSideSelectOneBody=function(e){e.isClick()&&this.showBodyPicker()},t.prototype.onTouchButtonFirstLayerSideSelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(1)},t.prototype.onTouchButtonSecondLayerSideSelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(2)},t.prototype.onTouchButtonThirdLayerSideSelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(3)},t.prototype.onTouchButtonTopSelectOneBody=function(e){e.isClick()&&this.showBodyPicker()},t.prototype.onTouchButtonFirstLayerTopSelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(1)},t.prototype.onTouchButtonSecondLayerTopSelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(2)},t.prototype.onTouchButtonThirdLayerTopSelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(3)},t.prototype.onTouchButtonDecoSelectOneBody=function(e){e.isClick()&&this.showBodyPicker()},t.prototype.onTouchButtonFirstLayerDecoSelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(1)},t.prototype.onTouchButtonOrnamentSelectOneBody=function(e){e.isClick()&&this.showBodyPicker()},t.prototype.onTouchButtonFirstLayerOrnamentSelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(1)},t.prototype.onTouchButtonPlateSelectOneBody=function(e){e.isClick()&&this.showBodyPicker()},t.prototype.onTouchButtonFirstLayerPlateSelect=function(e){e.isClick()&&this.__operate_body_showShapePicker(1)},t=__decorate([g],t)}(a.default));o.default=m,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/ReuseLayouterVBox":"ReuseLayouterVBox","../../../ulframework/view/ReuseList":"ReuseList","../../Const":"Const","../node/vAvatar":"vAvatar","./../../../ulframework/utils/Tools":"Tools","./../../../ulframework/view/SceneBase":"SceneBase","./../../manager/mgrCake":"mgrCake","./../../manager/mgrCfg":"mgrCfg","./../../manager/mgrTip":"mgrTip","./EditorTransformController":"EditorTransformController"}],EditorTransformController:[function(e,t,o){"use strict";cc._RF.push(t,"2b268ZXNMNN8aRnHlnZiYYE","EditorTransformController"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/ViewBase"),a=cc._decorator,r=a.ccclass,i=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editboxScale=null,t.editboxX=null,t.editboxY=null,t.editboxZ=null,t.target=null,t.onValueChanged=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"_editor/EditorTransformController"},t.prototype._getResourceBindingConfig=function(){return{CC_editboxScale:{varname:"editboxScale",vartype:cc.EditBox},CC_editboxX:{varname:"editboxX",vartype:cc.EditBox},CC_editboxY:{varname:"editboxY",vartype:cc.EditBox},CC_editboxZ:{varname:"editboxZ",vartype:cc.EditBox}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.editboxX.node.on("text-changed",this.__on_value_changed.bind(this)),this.editboxY.node.on("text-changed",this.__on_value_changed.bind(this)),this.editboxZ.node.on("text-changed",this.__on_value_changed.bind(this)),this.editboxScale.node.on("text-changed",this.__on_value_changed.bind(this))},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fillData=function(){this.target&&cc.isValid(this.target)?(this.editboxX.string=this.target.x.toString(),this.editboxY.string=this.target.y.toString(),this.editboxZ.string=this.target.zIndex.toString(),this.editboxScale.string=this.target.scale.toString()):(this.editboxX.string="zero",this.editboxY.string="zero",this.editboxZ.string="zero",this.editboxZ.string="zero")},t.prototype.__on_value_changed=function(){this.target&&cc.isValid(this.target)&&(this.target.setPosition(parseFloat(this.editboxX.string)||this.target.x,parseFloat(this.editboxY.string)||this.target.y),this.target.zIndex=Math.floor(parseFloat(this.editboxZ.string)||this.target.zIndex),cc.log(this.editboxScale.string),this.target.scale=parseFloat(this.editboxScale.string)||this.target.scale,this.onValueChanged(this.target))},t.prototype.setTarget=function(e,t){this.target=e,this.fillData(),this.onValueChanged=t},t=__decorate([r],t)}(n.default));o.default=i,cc._RF.pop()},{"../../../ulframework/view/ViewBase":"ViewBase"}],EventTouchEx:[function(e,t,o){"use strict";cc._RF.push(t,"c5c052Cml9LpJLJJGhORhUX","EventTouchEx"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.CLICK_RANGE_SQ=400,t.name="",t}return __extends(t,e),t.prototype.isClick=function(){return!1},t.prototype.isInClickRange=function(){return!1},t=__decorate([a],t)}(cc.Event.EventTouch));o.default=r;cc.Event.EventTouch.prototype.isClick=function(){if("ended"!=this.name&&"cancelled"!=this.name)return!1;var e=this.getStartLocation(),t=this.getLocation();return e.sub(t).magSqr()<=400},cc.Event.EventTouch.prototype.isInClickRange=function(){var e=this.getStartLocation(),t=this.getLocation();return e.sub(t).magSqr()<=400},cc._RF.pop()},{}],FSMObject:[function(e,t,o){"use strict";cc._RF.push(t,"78340ZFwntCqJb7oj6CQ375","FSMObject"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,-1),i=function(){function e(){var e;this._currentStateID=r,this._nextStateID=r,this._states=((e={})[r]={leave:null,execute:null,enter:null},e)}return e.prototype.registerState=function(e,t,o,n){void 0===t&&(t=null),void 0===o&&(o=null),void 0===n&&(n=null),null!=this._states[e]&&cc.warn("\u8b66\u544a] FSMObject.registerState state override!",e),this._states[e]={enter:t,execute:o,leave:n}},e.prototype.removeState=function(e){this._states[e]=null},e.prototype.update=function(e){if(null!=this._nextStateID){var t=this._states[this._currentStateID].leave;t&&t(),this._currentStateID=this._nextStateID,this._nextStateID=null;var o=this._states[this._currentStateID].enter;if(o&&(o(),this._nextStateID))return this.update(e)}if(this._states){var n=this._states[this._currentStateID].execute;n&&n(e)}},e.prototype.setNextState=function(e){this._nextStateID=e},e.prototype.getState=function(){return this._currentStateID},e.prototype.getNextState=function(){return this._nextStateID},e.prototype.destroy=function(){this._states=null},e=__decorate([a],e)}();o.FSMObject=i,cc._RF.pop()},{}],FSMSceneBase:[function(e,t,o){"use strict";cc._RF.push(t,"a2b1eJc0CRLSqpq/jnoMOnx","FSMSceneBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/FSMObject"),a=e("./SceneBase"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){this._fsmObject=new n.FSMObject,e.prototype.onLoad.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t),this._fsmObject&&this._fsmObject.update(t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this._fsmObject&&this._fsmObject.destroy()},t.prototype.getState=function(){return this._fsmObject.getState()},t.prototype.getNextState=function(){return this._fsmObject.getNextState()},t.prototype.setNextState=function(e){this._fsmObject.setNextState(e)},t.prototype.removeState=function(e){this._fsmObject.removeState(e)},t.prototype.registerState=function(e,t,o,n){var a=null,r=null,i=null;t&&(a=this[t])&&(a=a.bind(this)),o&&(r=this[o])&&(r=r.bind(this)),n&&(i=this[n])&&(i=i.bind(this)),this._fsmObject.registerState(e,a,r,i)},t=__decorate([i],t)}(a.default));o.default=s,cc._RF.pop()},{"../utils/FSMObject":"FSMObject","./SceneBase":"SceneBase"}],IPoolManagerCacheableObject:[function(e,t,o){"use strict";cc._RF.push(t,"f7e8cE+m5FBIKVP1uVaqX4s","IPoolManagerCacheableObject"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],IReuseLayouter:[function(e,t,o){"use strict";cc._RF.push(t,"b30d6M0rXJDLLQUbIdDTyu1","IReuseLayouter"),Object.defineProperty(o,"__esModule",{value:!0}),cc._RF.pop()},{}],LayerColor:[function(e,t,o){"use strict";cc._RF.push(t,"9dcecZrzvBF8Z+r3MsJQolH","LayerColor"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../manager/mgrDirector"),a=function(e){function t(t){var o=e.call(this)||this,a=new cc.Node;a.parent=o;var r=t.getA();t.setA(255),a.color=t,a.opacity=r,t.setA(r),o.nodeSprite=a;var i=a.addComponent(cc.Sprite);return i.sizeMode=cc.Sprite.SizeMode.CUSTOM,n.default.loadRes("2d/default/white_dot",cc.SpriteFrame,function(e,t){if(!e){var o=a.getContentSize();i.spriteFrame=t,a.setContentSize(o)}}),o}return __extends(t,e),t.prototype.setContentSize=function(t,o){e.prototype.setContentSize.call(this,t,o),this.nodeSprite.setContentSize(t,o)},t.prototype.setAnchorPoint=function(t,o){e.prototype.setAnchorPoint.call(this,t,o),this.nodeSprite.setAnchorPoint(t,o)},Object.defineProperty(t.prototype,"color",{set:function(e){this._color=e,this.nodeSprite.color=e},enumerable:!0,configurable:!0}),t}(cc.Node);o.default=a,cc._RF.pop()},{"../../manager/mgrDirector":"mgrDirector"}],LifeCycleMonitor:[function(e,t,o){"use strict";cc._RF.push(t,"20ed8Gu2q1A3quCZsuyhsNt","LifeCycleMonitor"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fOnLoad=null,t.fStart=null,t.fUpdate=null,t.fOnDestroy=null,t}return __extends(t,e),t.prototype.onLoad=function(){this.fOnLoad&&this.fOnLoad()},t.prototype.start=function(){this.fStart&&this.fStart()},t.prototype.update=function(e){this.fUpdate&&this.fUpdate(e)},t.prototype.onDestroy=function(){this.fOnDestroy&&this.fOnDestroy()},t.prototype.setOnLoadCallback=function(e){this.fOnLoad=e},t.prototype.setUpdateCallback=function(e){this.fUpdate=e},t.prototype.setStartCallback=function(e){this.fStart=e},t.prototype.setOnDestroyCallback=function(e){this.fOnDestroy=e},t=__decorate([a],t)}(cc.Component));o.default=r,cc._RF.pop()},{}],Manager:[function(e,t,o){"use strict";cc._RF.push(t,"bb517iTiWxAha7AbPfnKLLw","Manager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/MsgHandler"),a=e("../utils/Tools"),r=cc._decorator,i=r.ccclass,s=(r.property,function(){function e(){}var t;return t=e,e.loadAllManagers=function(){for(var e=0;e<this._managerInstances.length;e++){var t=this._managerInstances[e];try{t.onLoad()}catch(e){cc.error("Manager.loadAllManager has error",e)}}},e.init=function(){t._managerInstances.push(this),this._msgHander=new n.default,this._msgHander.startProcMsg()},e.onLoad=function(){this.registerListeners({MSG_RECORD_RESET:this.loadRecord}),this._bNetworkResponseRegistered||(this._bNetworkResponseRegistered=!0,this.onRegisterNetworkResponseListeners())},e.loadRecord=function(){},e.saveRecord=function(){},e.onRegisterNetworkResponseListeners=function(){},e.registerListeners=function(e){var t=this;a.default.forEachMap(e,function(o,n){e[o]=n.bind(t)}),this._msgHander.registerListeners(e)},e.startProcMsg=function(){this._msgHander.startProcMsg()},e.stopProcMsg=function(){this._msgHander.stopProcMsg()},e.sendMsg=function(e,t){this._msgHander.sendMsg(e,t)},e._managerInstances=[],e._bNetworkResponseRegistered=!1,e=t=__decorate([i],e)}());o.default=s,cc._RF.pop()},{"../utils/MsgHandler":"MsgHandler","../utils/Tools":"Tools"}],MsgHandler:[function(e,t,o){"use strict";cc._RF.push(t,"0852c+vjjFK2r/FdcXtbrUO","MsgHandler"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Tools"),a=function(){function e(e){this.eventTarget=e||cc.game,this.registeredListeners={},this.startedListeners={},this.bStarted=!1}return e.prototype.registerListeners=function(e){var t=this;n.default.forEachMap(e,function(e,o){null!=t.registeredListeners[e]&&cc.log("[\u8b66\u544a] MsgHandler.registerListeners msg\u91cd\u590d\u6ce8\u518c\uff01 msgName="+e);t.registeredListeners[e]=function(e){try{o(e)}catch(e){cc.error("MsgHandler.listener has error!",e)}}}),this.bStarted&&this.startProcMsg()},e.prototype.startProcMsg=function(){var e=this;this.bStarted=!0,n.default.forEachMap(this.registeredListeners,function(t,o){if(!e.startedListeners[t]){var n=e.registeredListeners[t];e.eventTarget.on(t,n,e),e.startedListeners[t]=n}})},e.prototype.stopProcMsg=function(){var e=this;n.default.forEachMap(this.startedListeners,function(t,o){e.eventTarget.off(t,o,e)}),this.bStarted=!1,this.startedListeners={}},e.prototype.sendMsg=function(e,t){try{this.eventTarget.emit(e,t)}catch(e){cc.error("MsgHandler.sendMsg has exception",e)}},e}();o.default=a,cc._RF.pop()},{"./Tools":"Tools"}],NetworkAdapterBase:[function(e,t,o){"use strict";cc._RF.push(t,"19f10Ph5gxPjZVUGeVhqU2/","NetworkAdapterBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/Tools"),a=e("../utils/Timer"),r=cc._decorator,i=r.ccclass,s=(r.property,function(){function e(){}return e.prototype.setReceiveCallback=function(e){return this.fOnReceive=e,this},e.prototype.setFaildCallback=function(e){return this.fOnFaild=e,this},e.prototype.triggerReceiveCallback=function(e){this.fOnReceive&&this.fOnReceive(e)},e.prototype.triggerFaildCallback=function(e){this.fOnFaild&&this.fOnFaild(e)},e.prototype.send=function(e){var t=this;a.default.callLater(.1,function(o){if("CMD_1"==e.cmd){var a={cmd:e.cmd,info:"response."+e.info};t.triggerReceiveCallback(a)}else if("CMD_2"==e.cmd)if(n.default.random(100)<50){a={cmd:e.cmd,info:"response."+e.info};t.triggerReceiveCallback(a)}else t.triggerFaildCallback("random faild")})},e.prototype.connect=function(){},e.prototype.disconnect=function(){},e.prototype.update=function(e){},e=__decorate([i],e)}());o.NetworkAdapterBase=s,cc._RF.pop()},{"../utils/Timer":"Timer","../utils/Tools":"Tools"}],NetworkAdapterHttpUlServer:[function(e,t,o){"use strict";cc._RF.push(t,"ba6a3sqZGhIbanIFIQ9RJtc","NetworkAdapterHttpUlServer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./NetworkAdapterBase"),a=e("../utils/Timer"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeout=5e3,t}return __extends(t,e),t.prototype.setHost=function(e){this.host=e},t.prototype.setUrlFormat=function(e){this.urlFormat=e},t.prototype.setUlServerArg=function(e,t,o,n){this.signkey=e,this.platform=t,this.appid=o,this.channel=n},t.prototype.setTimeout=function(e){this.timeout=e},t.prototype.send=function(e){var t=JSON.stringify(e);t=encodeURIComponent(t);var o=ul.format("signkey=%s&platform=%s&appid=%s&channel=%s&data=%s",this.signkey,this.platform,this.appid,this.channel,t),n=ul.format(this.urlFormat,this.host);cc.log("send",n,o);var a=cc.loader.getXMLHttpRequest();a.onreadystatechange=this.onReadyStateChange.bind(this),a.open("POST",n),a.timeout=1e3*this.timeout,this.xhr=a,this.startTimeoutTimer(),a.send(o)},t.prototype.onReadyStateChange=function(){var e=this.xhr;if(e&&4==e.readyState){if(200==e.status){var t=e.response||"",o={str:null},n=void 0;try{n=JSON.parse(t)}catch(e){}n?o=n:o.str=t,this.triggerReceiveCallback(o)}else this.triggerFaildCallback(ul.format("http error: readyState=[%s], status=[%s]",e.readyState,e.status));this.stopTimeoutTimer(),this.disconnect()}},t.prototype.disconnect=function(){if(this.xhr)try{this.xhr.abort(),this.xhr=null}catch(e){console.log("disconnect error"),this.xhr=null}},t.prototype.startTimeoutTimer=function(){var e=this;this.stopTimeoutTimer();var t=new a.default(this.timeout,1,function(){e.stopTimeoutTimer(),e.disconnect()});t.start(),this.timeoutTimer=t},t.prototype.stopTimeoutTimer=function(){this.timeoutTimer&&(this.timeoutTimer.stop(),this.timeoutTimer=null)},t=__decorate([i],t)}(n.NetworkAdapterBase));o.NetworkAdapterHttpUlServer=s,cc._RF.pop()},{"../utils/Timer":"Timer","./NetworkAdapterBase":"NetworkAdapterBase"}],NetworkAdapterHttp:[function(e,t,o){"use strict";cc._RF.push(t,"fd376cjprVCg6tz28Mt+EGm","NetworkAdapterHttp"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./NetworkAdapterBase"),a=e("../utils/Timer"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.timeout=5e3,t}return __extends(t,e),t.prototype.setTimeout=function(e){this.timeout=e},t.prototype.send=function(e){var t=e.url;if(t){var o=e.requestType||"GET",n=e.postData||"",a=cc.loader.getXMLHttpRequest();a.onreadystatechange=this.onReadyStateChange.bind(this),a.open(o,t),a.timeout=this.timeout,this.xhr=a,this.startTimeoutTimer(),a.send(n)}else cc.warn("\u8b66\u544a] NetworkAdapterHttp.send url not found!")},t.prototype.onReadyStateChange=function(){var e=this.xhr;if(e&&4==e.readyState){if(200==e.status){var t={response:e.response||""};this.triggerReceiveCallback(t)}else this.triggerFaildCallback(ul.format("http error: readyState=[%s], status=[%s]",e.readyState,e.status));this.stopTimeoutTimer(),this.disconnect()}},t.prototype.disconnect=function(){if(this.xhr)try{this.xhr.abort(),this.xhr=null}catch(e){console.log("disconnect error1"),this.xhr=null}},t.prototype.startTimeoutTimer=function(){var e=this;this.stopTimeoutTimer();var t=new a.default(this.timeout,1,function(){e.stopTimeoutTimer(),e.disconnect()});t.start(),this.timeoutTimer=t},t.prototype.stopTimeoutTimer=function(){this.timeoutTimer&&(this.timeoutTimer.stop(),this.timeoutTimer=null)},t=__decorate([i],t)}(n.NetworkAdapterBase));o.NetworkAdapterHttp=s,cc._RF.pop()},{"../utils/Timer":"Timer","./NetworkAdapterBase":"NetworkAdapterBase"}],NetworkManager:[function(e,t,o){"use strict";cc._RF.push(t,"33b8bnH9ttOA7UWhgWmkZ7E","NetworkManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/FSMObject"),a=e("./NetworkTask"),r=1,i=2,s=3,c=4,l=function(e){function t(t){var o=e.call(this)||this;return o.bAutoDoNextTask=!0,o.currTask=null,o.tasks=[],o.adapter=null,o.adapter=t,t.setReceiveCallback(o.onReceive.bind(o)),t.setFaildCallback(o.onFaild.bind(o)),o.registerState(r,o.onEnterStandby.bind(o),o.onExecuteStandby.bind(o),null),o.registerState(i,o.onEnterRequest.bind(o),o.onExecuteRequest.bind(o),null),o.registerState(s,o.onEnterResponse.bind(o),o.onExecuteResponse.bind(o),null),o.registerState(c,o.onEnterFaild.bind(o),null,null),o.setNextState(r),o}return __extends(t,e),t.prototype.setAutoDoNextTaskEnabled=function(e){this.bAutoDoNextTask=e},t.prototype.update=function(t){e.prototype.update.call(this,t),this.adapter.update(t)},t.prototype.onEnterStandby=function(){0},t.prototype.onExecuteStandby=function(){var e=this.tasks;if(e.length>0){var t=e[0];this.currTask=t,this.setNextState(i)}},t.prototype.onEnterRequest=function(){var e=this.currTask;e.triggerRequestCallback(),this.adapter.send(e.getRequestData())},t.prototype.onExecuteRequest=function(){},t.prototype.onEnterResponse=function(){var e=this.currTask;e?e.triggerResponseCallback():this.setNextState(r)},t.prototype.onExecuteResponse=function(){this.bAutoDoNextTask&&this.doNextTask()},t.prototype.onEnterFaild=function(){var e=this.currTask;e?e.triggerFaildCallback():this.setNextState(r)},t.prototype.onReceive=function(e){if(this.getState()==i){var t=this.currTask;t?(t.setResponseData(e),this.setNextState(s)):cc.log("[warn] NetworkManager.onReceive, currTask !found!")}else cc.log("[warn] NetworkManager.onReceive, state is !ST_REQUEST!")},t.prototype.onFaild=function(e){if(this.getState()==i){var t=this.currTask;t?(t.setFaildMsg(e),this.setNextState(c)):cc.log("[warn] NetworkManager.onReceive, currTask !found!")}else cc.log("[warn] NetworkManager.onReceive, state is !ST_REQUEST!")},t.prototype.addTask=function(e,t,o,n,r){if(e){var i=new a.NetworkTask;i.setRequestData(e),i.setOnReceiveCallback(t),i.setOnFaildCallback(o),i.setOnRequestCallback(n),i.setBackgroundEnabled(r),this.tasks.push(i)}else cc.log("[warn] NetworkManager.addTask, requestData is null!")},t.prototype.getCurrentTask=function(){return this.tasks[0]},t.prototype.getTasks=function(){return this.tasks},t.prototype.retryCurrentTask=function(){this.getState()==c?this.setNextState(r):cc.log("[warn] NetworkManager.retryCurrentTask, state is !ST_FAILD, no need to retry!")},t.prototype.stopAllTasks=function(){this.tasks=[],this.currTask=null,this.adapter.disconnect(),this.setNextState(r)},t.prototype.doNextTask=function(){this.currTask&&(this.currTask=null,this.tasks.shift(),this.setNextState(r))},t}(n.FSMObject);o.NetworkManager=l,cc._RF.pop()},{"../utils/FSMObject":"FSMObject","./NetworkTask":"NetworkTask"}],NetworkTask:[function(e,t,o){"use strict";cc._RF.push(t,"fef47QyITxJGal2U1lUImfJ","NetworkTask"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(){function e(){this.fOnRequest=null,this.fOnFaild=null,this.fOnReceive=null,this.faildMsg="",this.responseData=null,this.requestData={}}return e.prototype.setBackgroundEnabled=function(e){return this.bBackgroundEnabled=e,this},e.prototype.isBackgroundEnabled=function(){return this.bBackgroundEnabled},e.prototype.setRequestData=function(e){return this.requestData=e,this},e.prototype.getRequestData=function(){return this.requestData},e.prototype.setResponseData=function(e){return this.responseData=e,this},e.prototype.getResponseData=function(){return this.responseData},e.prototype.setFaildMsg=function(e){return this.faildMsg=e,this},e.prototype.getFaildMsg=function(){return this.faildMsg},e.prototype.setOnRequestCallback=function(e){return this.fOnRequest=e,this},e.prototype.setOnReceiveCallback=function(e){return this.fOnReceive=e,this},e.prototype.setOnFaildCallback=function(e){return this.fOnFaild=e,this},e.prototype.triggerRequestCallback=function(){this.fOnRequest&&this.fOnRequest(this)},e.prototype.triggerResponseCallback=function(){this.fOnReceive&&this.fOnReceive(this)},e.prototype.triggerFaildCallback=function(){this.fOnFaild&&this.fOnFaild(this)},e=__decorate([a],e)}());o.NetworkTask=r,cc._RF.pop()},{}],Particle:[function(e,t,o){"use strict";cc._RF.push(t,"a10b8ZLs3ZDqYswx11SLC3c","Particle"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../game/manager/mgrCfg"),a=e("../../game/manager/mgrDirector"),r=function(e){function t(t){var o=e.call(this)||this;o.bLoaded=!1;var r=n.default.get_from_particle_db(t),i=o.addComponent(cc.ParticleSystem);return""!=r.positionType&&(i.positionType=parseInt(r.positionType)),o.particleData=r,o.bAutoRemoveOnFinish=r.bPlayOnce,r.texturename&&a.default.loadRes(r.texturename,cc.SpriteFrame,function(e,t){e?cc.warn("Particle loadRes error:",e.message):cc.isValid(o)&&(i.spriteFrame=t)}),a.default.loadRes(r.filename,cc.ParticleAsset,function(e,t){e?cc.warn("Particle loadRes error:",e.message):cc.isValid(o)&&(i.file=t,o.bLoaded=!0)}),o}return __extends(t,e),t.prototype.reset=function(){var e=this.getComponent(cc.ParticleSystem);e.autoRemoveOnFinish=this.bAutoRemoveOnFinish,e.resetSystem()},t.prototype.setAutoRemoveOnFinish=function(e){this.bAutoRemoveOnFinish=e,this.getComponent(cc.ParticleSystem).autoRemoveOnFinish=this.bAutoRemoveOnFinish},t.prototype.isLoaded=function(){return this.bLoaded},t}(cc.Node);o.default=r,cc._RF.pop()},{"../../game/manager/mgrCfg":"mgrCfg","../../game/manager/mgrDirector":"mgrDirector"}],PoolManager:[function(e,t,o){"use strict";cc._RF.push(t,"a121cUYpppN0Zm8VXjSKZa4","PoolManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Tools"),a=cc._decorator,r=a.ccclass,i=(a.property,function(){function e(){this.pools={},this.poolConfigs={}}return e.prototype._getPool=function(e,t){var o=this.pools[e];o||(o={},this.pools[e]=o);var n=o[t];return n||(n=[],o[t]=n),n},e.prototype._safeRelease=function(e){},e.prototype.register=function(e,t,o,n,a,r){this.poolConfigs[e]={creator:t,resetter:o,cleanuper:n,destroyer:a,maxCount:r}},e.prototype.get=function(e,t){if(e){var o=this.poolConfigs[e];if(o){null==t&&(t="__default__");for(var n=this._getPool(e,t),a=0;a<n.length;a++)n[a];var r=n.shift();for(a=0;a<n.length;a++)n[a];return r&&r.parent&&(cc.warn("[warn] PoolManager.get, node already has a parent!"),r=null),r||(r=o.creator(t))&&(r.__pool_id=e,r.__pool_key=t),r&&(o.resetter&&o.resetter(r),r.__pool_flag_inpool=null),r}cc.warn(ul.format("PoolManager.get config not found! poolId = %s",e))}else cc.warn("PoolManager.get need a poolId")},e.prototype.put=function(e){if(e){var t=e.__pool_id,o=e.__pool_key;if(t)if(o)if(cc.isValid(e)){var n=this.poolConfigs[t];if(n)if(e.__pool_flag_inpool)cc.warn("PoolManager.put obj is already in pool!");else{var a=this._getPool(t,o);a.length<n.maxCount?(n.cleanuper&&n.cleanuper(e),e.__pool_flag_inpool=!0,a.push(e)):(n.destroyer&&n.destroyer(e),this._safeRelease(e))}else cc.warn(ul.format("PoolManager.put config not found! poolId = %s",t))}else cc.warn("PoolManager.put obj not valid.");else cc.warn("PoolManager.put obj.__pool_key not found!")}else cc.warn("PoolManager.put node is nil!")},e.prototype.clean=function(e,t){var o=this;n.default.forEachMap(this.pools,function(a,r){if(!e||e==a){var i=o.poolConfigs[a].destroyer;n.default.forEachMap(r,function(e,n){if(!t||t==e){for(var a=0;a<n.length;a++){var s=n[a];i&&i(s),o._safeRelease(s)}r[e]=null}})}})},e=__decorate([r],e)}());o.default=i,cc._RF.pop()},{"./Tools":"Tools"}],Randomizer:[function(e,t,o){"use strict";cc._RF.push(t,"92d72KdO7hG8YoOt/riTl26","Randomizer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./Tools"),a=function(){function e(e){null==e&&(e=(new Date).getTime()),this.originSeed=e,this.seed=e}return e.prototype.getSeed=function(){return this.seed},e.prototype.getOriginSeed=function(){return this.originSeed},e.prototype.setSeed=function(e){this.originSeed=e,this.seed=e},e.prototype.random=function(e,t){this.seed=(9301*this.seed+49297)%233280;var o=this.seed/233280;return null==e&&null==t?o:null==t?Math.floor(o*e+1):Math.floor(o*(t-e+1)+e)},e.prototype._pureRandomWithoutReturn=function(){this.seed=(9301*this.seed+49297)%233280},e._getStaticRandomizer=function(){return this.staticFixedRandomizer||(this.staticFixedRandomizer=new e),this.staticFixedRandomizer},e.calcFixedRandom=function(e,t,o,n){t<0&&(cc.warn("FixedRandomizer.calcFixedRandom index must >= 0"),t=0);var a=this._getStaticRandomizer();a.setSeed(e);for(var r=0;r<t;r++)a._pureRandomWithoutReturn();return a.random(o,n)},e.calcFixedRandoms=function(e,t,o,n){var a=[],r=this._getStaticRandomizer();r.setSeed(e);for(var i=0;i<t;i++)a.push(r.random(o,n));return a},e._test=function(){cc.log("randomizer(1)");for(var t=new e(1),o=0;o<10;o++)cc.log(o,t.random(100),t.getSeed());cc.log("calcFixedRandoms(1)");var a=e.calcFixedRandoms(1,10,100);for(o=0;o<a.length;o++)cc.log(o,a[o]);cc.log("calcFixedRandom(1)");for(o=0;o<10;o++)cc.log(o,e.calcFixedRandom(1,o,100));cc.log("randomizer(2)"),t=new e(2);for(o=0;o<10;o++)cc.log(o,t.random(100),t.getSeed());cc.log("\u968f\u673a\u5206\u5e03\u6d4b\u8bd5");var r={};t=new e(1);for(o=0;o<1e3;o++){r[i=t.random(100)]=(r[i]||0)+1}cc.log(r),cc.log("\u7cfb\u7edfrandom\u5206\u5e03\u6d4b\u8bd5"),r={};for(o=0;o<1e3;o++){var i;r[i=n.default.random(100)]=(r[i]||0)+1}cc.log(r)},e.staticFixedRandomizer=null,e}();o.default=a,cc._RF.pop()},{"./Tools":"Tools"}],ResourceNode:[function(e,t,o){"use strict";cc._RF.push(t,"fdf91oWa0hH9pol5x0DZP7K","ResourceNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../game/Const"),a=e("../../game/manager/mgrPool"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(t,o,n){var a,r,i=e.call(this)||this;t instanceof Array?(a=t[0],r=t[1]):(a=t,r=o);var s=new cc.Node;return null!=a&&r?(i.resType=a,i.resId=r,i.movName=n,i.loadRes(),i):s}return __extends(t,e),t.prototype._onPreDestroy=function(){this.unloadRes(),e.prototype._onPreDestroy&&e.prototype._onPreDestroy.call(this)},t.prototype.loadRes=function(){this.unloadRes();var e=this.resType,t=this.resId;if(e==n.ResourceType.sprite){if(t&&""!=t){var o=a.default.get("sprite",t);o.parent=this,this.nodeSprite=o}}else if(e==n.ResourceType.spine){var r=a.default.get("spine",t);r&&(r.parent=this,this.spine=r,this.movName&&this.spine.play(this.movName,!0))}else if(e==n.ResourceType.particle){var i=a.default.get("particle",t);i&&(i.parent=this,this.particle=i)}else if(e==n.ResourceType.animNode){var s=a.default.get("animNode",t);s&&(s.parent=this,s.play())}},t.prototype.unloadRes=function(){var e=this.resType;this.resId;e==n.ResourceType.sprite?(cc.isValid(this.nodeSprite)&&(this.nodeSprite.removeFromParent(),a.default.put(this.nodeSprite)),this.nodeSprite=null):e==n.ResourceType.spine?(cc.isValid(this.spine)&&(this.spine.removeFromParent(),a.default.put(this.spine)),this.spine=null):e==n.ResourceType.particle&&(cc.isValid(this.particle)&&(this.particle.removeFromParent(),a.default.put(this.particle)),this.particle=null)},t.prototype.tryPlaySpineMov=function(e,t){cc.isValid(this.spine)&&this.spine.play(e,t)},t.prototype.setAnchorPoint=function(t,o){e.prototype.setAnchorPoint.call(this,t,o),this.nodeSprite&&this.nodeSprite.setAnchorPoint(t,o)},t=__decorate([i],t)}(cc.Node));o.default=s,cc._RF.pop()},{"../../game/Const":"Const","../../game/manager/mgrPool":"mgrPool"}],ReuseLayouterHBox:[function(e,t,o){"use strict";cc._RF.push(t,"80ad6lBxMFIz5G/a2oiNaax","ReuseLayouterHBox"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(){function e(){this.cellSize=cc.size(0,0),this.gap=0,this.pending=0,this.containerHeight=0,this.cellTop=0}return e.prototype.setCellSize=function(e,t){return e instanceof cc.Size?this.cellSize=e:this.cellSize=cc.size(e,t||0),this.tryBuildHeight(),this},e.prototype.setGap=function(e){return this.gap=e,this},e.prototype.setPending=function(e){return this.pending=e,this},e.prototype.setContainerHeight=function(e){return this.containerHeight=e,this.tryBuildHeight(),this},e.prototype.tryBuildHeight=function(){var e=this.cellSize.height,t=this.containerHeight;0!=e&&0!=t&&(this.cellTop=Math.floor((t-e)/2))},e.prototype.getPos=function(e){var t=this.pending+e*(this.cellSize.width+this.gap),o=-this.cellTop;return t+=this.cellSize.width/2,o-=this.cellSize.height/2,cc.v2(t,o)},e.prototype.getCellSize=function(){return this.cellSize},e.prototype.setListSize=function(e){this.setContainerHeight(e.height)},e.prototype.getContainerSize=function(e){var t=2*this.pending+this.cellSize.width*e+this.gap*(e-1);return cc.size(t,this.containerHeight)},e.prototype.getPending=function(){return this.pending},e.prototype.getJumpOffset=function(){return cc.v2(-this.pending,0)},e.prototype.isHorizontalScroll=function(){return!0},e.prototype.isVerticalScroll=function(){return!1},e=__decorate([a],e)}());o.default=r,cc._RF.pop()},{}],ReuseLayouterHGrid:[function(e,t,o){"use strict";cc._RF.push(t,"35f5czwDvtMA6NDCYUSl2jj","ReuseLayouterHGrid"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(){function e(){this.cellSize=cc.size(0,0),this.rows=0,this.hgap=0,this.vgap=0,this.pending=0,this.containerHeight=0,this.cellTop=0}return e.prototype.setCellSize=function(e,t){return e instanceof cc.Size?this.cellSize=e:this.cellSize=cc.size(e,t||0),this.tryBuildTop(),this},e.prototype.setRows=function(e){return this.rows=e,this.tryBuildTop(),this},e.prototype.setGap=function(e,t){return this.hgap=e,this.vgap=t,this},e.prototype.setPending=function(e){return this.pending=e,this},e.prototype.setContainerHeight=function(e){return this.containerHeight=e,this.tryBuildTop(),this},e.prototype.tryBuildTop=function(){var e=this.rows,t=this.cellSize.height,o=this.containerHeight,n=this.vgap;if(0!=e&&0!=t&&0!=o){var a=e*t+(e-1)*n;this.cellTop=Math.floor((o-a)/2)}},e.prototype.getPos=function(e){var t=Math.floor(e/this.rows),o=e%this.rows,n=this.pending+t*(this.cellSize.width+this.hgap),a=-this.cellTop-o*(this.cellSize.height+this.vgap);return n+=this.cellSize.width/2,a-=this.cellSize.height/2,cc.v2(n,a)},e.prototype.getCellSize=function(){return this.cellSize},e.prototype.setListSize=function(e){this.setContainerHeight(e.height)},e.prototype.getContainerSize=function(e){var t=Math.ceil(e/this.rows),o=2*this.pending+this.cellSize.width*t+this.hgap*(t-1);return cc.size(o,this.containerHeight)},e.prototype.getPending=function(){return this.pending},e.prototype.getJumpOffset=function(){return cc.v2(-this.pending,0)},e.prototype.isHorizontalScroll=function(){return!0},e.prototype.isVerticalScroll=function(){return!1},e=__decorate([a],e)}());o.default=r,cc._RF.pop()},{}],ReuseLayouterVBox:[function(e,t,o){"use strict";cc._RF.push(t,"b1de5hw1QtHOp9XvYtOMMAS","ReuseLayouterVBox"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(){function e(){this.cellSize=cc.size(0,0),this.gap=0,this.pending=0,this.containerWidth=0,this.cellLeft=0}return e.prototype.setCellSize=function(e,t){return e instanceof cc.Size?this.cellSize=e:this.cellSize=cc.size(e,t||0),this.tryBuildLeft(),this},e.prototype.setGap=function(e){return this.gap=e,this},e.prototype.setPending=function(e){return this.pending=e,this},e.prototype.setContainerWidth=function(e){return this.containerWidth=e,this.tryBuildLeft(),this},e.prototype.tryBuildLeft=function(){var e=this.cellSize.width,t=this.containerWidth;0!=e&&0!=t&&(this.cellLeft=Math.floor((t-e)/2))},e.prototype.getPos=function(e){var t=this.cellLeft,o=-this.pending-e*(this.cellSize.height+this.gap);return t+=this.cellSize.width/2,o-=this.cellSize.height/2,cc.v2(t,o)},e.prototype.getCellSize=function(){return this.cellSize},e.prototype.setListSize=function(e){this.setContainerWidth(e.width)},e.prototype.getContainerSize=function(e){var t=2*this.pending+this.cellSize.height*e+this.gap*(e-1);return cc.size(this.containerWidth,t)},e.prototype.getPending=function(){return this.pending},e.prototype.getJumpOffset=function(){return cc.v2(0,-this.pending)},e.prototype.isHorizontalScroll=function(){return!1},e.prototype.isVerticalScroll=function(){return!0},e=__decorate([a],e)}());o.default=r,cc._RF.pop()},{}],ReuseLayouterVGrid:[function(e,t,o){"use strict";cc._RF.push(t,"103774IVeNDcKnA1XUhN5I/","ReuseLayouterVGrid"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(){function e(){this.cellSize=cc.size(0,0),this.cols=0,this.hgap=0,this.vgap=0,this.pending=0,this.containerWidth=0,this.cellLeft=0}return e.prototype.setCellSize=function(e,t){return e instanceof cc.Size?this.cellSize=e:this.cellSize=cc.size(e,t||0),this.tryBuildLeft(),this},e.prototype.setCols=function(e){return this.cols=e,this.tryBuildLeft(),this},e.prototype.setGap=function(e,t){return this.hgap=e,this.vgap=t,this},e.prototype.setPending=function(e){return this.pending=e,this},e.prototype.setContainerWidth=function(e){return this.containerWidth=e,this.tryBuildLeft(),this},e.prototype.tryBuildLeft=function(){var e=this.cols,t=this.cellSize.width,o=this.containerWidth,n=this.hgap;if(0!=e&&0!=t&&0!=o){var a=e*t+(e-1)*n;this.cellLeft=Math.floor((o-a)/2)}},e.prototype.getPos=function(e){var t=e%this.cols,o=Math.floor(e/this.cols),n=this.cellLeft+t*(this.cellSize.width+this.hgap),a=-this.pending-o*(this.cellSize.height+this.vgap);return n+=this.cellSize.width/2,a-=this.cellSize.height/2,cc.v2(n,a)},e.prototype.getCellSize=function(){return this.cellSize},e.prototype.setListSize=function(e){this.setContainerWidth(e.width)},e.prototype.getContainerSize=function(e){var t=Math.ceil(e/this.cols),o=2*this.pending+this.cellSize.height*t+this.vgap*(t-1);return cc.size(this.containerWidth,o)},e.prototype.getPending=function(){return this.pending},e.prototype.getJumpOffset=function(){return cc.v2(0,-this.pending)},e.prototype.isHorizontalScroll=function(){return!1},e.prototype.isVerticalScroll=function(){return!0},e=__decorate([a],e)}());o.default=r,cc._RF.pop()},{}],ReuseList:[function(e,t,o){"use strict";cc._RF.push(t,"4aa41F5bWpCm4a0dSfgUa1x","ReuseList"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../game/view/node/LayerColor"),a=e("../utils/Timer"),r=e("./ViewBase"),i=cc._decorator,s=i.ccclass,c=(i.property,function(e){function t(){var t=e.call(this)||this;return t._CELL_ID=0,t.datas=[],t.cells=[],t.cellPool=[],t.bInit=!1,t.bDebugLineEnabled=!1,t.bClippingEnabled=!0,t.bReuseEnabled=!0,t.bElasticEnabled=!0,t.bTouchScrollEnabled=!0,t.bAsyncSetterEnabled=!1,t.fOnContainerMoved=null,t}return __extends(t,e),t.prototype.onAsyncTimerSpan=function(e){var t=this.asyncSetterTasks;if(null!=t&&t.length>0){var o=t[0];t.splice(0,1);var n=o[0],a=o[1];this.setter(n,a),n.active=!0}},t.prototype.init=function(){var e=this,t=this.layouter,o=this.getContentSize();if(t.setListSize(o),this.bDebugLineEnabled){var a=new n.default(cc.color(255,255,0,63));a.parent=this,a.setContentSize(this.getContentSize()),a.setAnchorPoint(this.getAnchorPoint())}var r=new cc.Node;r.setAnchorPoint(0,1),r.parent=this,r.setPosition(0,0),this.nodeContainer=r;var i=this.addComponent(cc.ScrollView);i.horizontal=t.isHorizontalScroll(),i.vertical=t.isVerticalScroll(),i.content=r,i.cancelInnerEvents=!1,i.elastic=this.bElasticEnabled;var s=i.onEnable;if(i.onEnabled=function(){s(),e._tryApplayTouchScrollEnabled()},this._tryApplayTouchScrollEnabled(),this.bClippingEnabled)this.addComponent(cc.Mask);this.on("scrolling",this.onScrolling,this)},t.prototype.reloadList=function(){if(null!=this.layouter)if(null!=this.creator)if(null!=this.setter){this.bInit||(this.bInit=!0,this.init());var e=this.layouter,t=this.datas,o=(this.cells,this.getContentSize()),n=e.getContainerSize(t.length),a=Math.max(o.width,n.width),r=Math.max(o.height,n.height),i=this.getComponent(cc.ScrollView),s=i.getScrollOffset();this.nodeContainer.setContentSize(a,r),i.scrollToOffset(s);for(var c=0;c<this.cells.length;c++){var l=this.cells[c];this.putCellToPool(l)}this.cells=[],this.onContainerMoved()}else cc.log("[\u9519\u8bef] ReuseList.reloadList setter not found!");else cc.log("[\u9519\u8bef] ReuseList.reloadList creator not found!");else cc.log("[\u9519\u8bef] ReuseList.reloadList layouter not found!")},t.prototype.updateCellState=function(){for(var e=this,t=this.layouter,o=this.nodeContainer,n=this.datas,a=this.cells,r=this.width*this.anchorX,i=this.height*this.anchorY,s=o.x+r,c=o.y+i,l=this.getContentSize(),u=-(c-l.height),d=-c,p=-s,h=-s+l.width,f=t.getCellSize(),g=f.width,m=f.height,v=function(o){if(!e.bReuseEnabled)return!0;var n=t.getPos(o);return d<n.y+m/2&&n.y-m/2<u&&p<n.x+g/2&&n.x-g/2<h},_=[],y=0;y<a.length;y++){if(v(T=(S=a[y]).__data_index))break;_.push(y)}for(var C=_.length-1;C>=0;C--){var S=a[y=_[C]];a.splice(y,1),this.putCellToPool(S)}var b=a[0];if(b)for(var T=b.__data_index-1;T>=0&&v(T);T--){S=this.getCellFromPool();a.splice(0,0,S);var R=n[T];this._callCellSetter(S,R),S.__data_index=T,S.zIndex=T,S.data=R,S.setPosition(t.getPos(T))}else for(T=0;T<n.length;T++)if(v(T)){S=this.getCellFromPool();a.push(S);R=n[T];this._callCellSetter(S,R),S.__data_index=T,S.zIndex=T,S.data=R,S.setPosition(t.getPos(T))}for(y=a.length-1;y>=0;y--){if(v(T=(S=a[y]).__data_index))break;this.putCellToPool(S),a.splice(y,1)}var k=a[a.length-1];if(k)for(T=k.__data_index+1;T<n.length;T++)if(v(T)){S=this.getCellFromPool();a.push(S);R=n[T];this._callCellSetter(S,R),S.__data_index=T,S.zIndex=T,S.data=R,S.setPosition(t.getPos(T))}},t.prototype.getCellFromPool=function(){var e=this.cellPool,t=null;if(e.length>0&&(t=e.splice(0,1)[0]),!t){var o=this.layouter.getCellSize();if(this._CELL_ID++,(t=new r.default).parent=this.nodeContainer,t.setContentSize(o),t.__cell_id=this._CELL_ID,this.creator(t),this.bDebugLineEnabled){var n=new cc.Node;n.setContentSize(o),n.parent=t;var a=n.addComponent(cc.Graphics);a.clear(),a.lineWidth=2,a.strokeColor=cc.color(255,255,0,255),a.rect(0,0,o.width,o.height),a.stroke();var i=new cc.Node;i.parent=t;var s=i.addComponent(cc.Label);s.string=t.__cell_id.toString(),s.fontSize=14,i.setAnchorPoint(0,1),i.setPosition(-o.width/2+2,o.height/2-2),i.color=cc.color(255,255,0,255)}}return t.active=!0,t},t.prototype.putCellToPool=function(e){e.active=!1,this.cellPool.push(e)},t.prototype._calcPercentPos=function(e,t){var o=this.getContentSize(),n=this.nodeContainer.getContentSize(),a=e/(n.width-o.width),r=t/(n.height-o.height);return r=1-r,a=cc.misc.clampf(a,0,1),r=cc.misc.clampf(r,0,1),cc.v2(a,r)},t.prototype._callCellSetter=function(e,t){if(this.bAsyncSetterEnabled){var o=this.asyncSetterTasks;null==o&&(o=[],this.asyncSetterTasks=o),e.active=!1;for(var n=o.length-1;n>=0;n--){o[n][0]==e&&o.splice(n,1)}o.push([e,t])}else this.setter(e,t)},t.prototype.setLayouter=function(e){return this.layouter=e,this},t.prototype.setCreator=function(e){return this.creator=e,this},t.prototype.setSetter=function(e){return this.setter=e,this},t.prototype.setDatas=function(e){return this.datas=e,this.reloadList(),this},t.prototype.getDatas=function(){return this.datas},t.prototype.getActiveCellsByFilter=function(e){for(var t=[],o=0;o<this.cells.length;o++){var n=this.cells[o];e(n)&&t.push(n)}return t},t.prototype.setDebugLineEnabled=function(e){return this.bDebugLineEnabled=e,this},t.prototype.setReuseEnabled=function(e){return this.bReuseEnabled=e,this},t.prototype.setClippingEnabled=function(e){return this.bClippingEnabled=e,this},t.prototype.setElasticEnabled=function(e){return this.bElasticEnabled=e,this},t.prototype.setTouchScrollEnabled=function(e){return this.bTouchScrollEnabled=e,this._tryApplayTouchScrollEnabled(),this},t.prototype._tryApplayTouchScrollEnabled=function(){var e=this.getComponent(cc.ScrollView);cc.isValid(e)&&(this.bTouchScrollEnabled?e._registerEvent():e._unregisterEvent())},t.prototype.setAsyncSetterEnabled=function(e){return this.bAsyncSetterEnabled=e,e?null==this.asyncTimer&&(cc.log("start Timer"),this.asyncTimer=new a.default(1/60,-1,this.onAsyncTimerSpan.bind(this)),this.asyncTimer.startAndBindToNode(this)):null!=this.asyncTimer&&this.asyncTimer.stop(),this},t.prototype.setOnContainerMoved=function(e){return this.fOnContainerMoved=e,this},t.prototype.refreshActiveCells=function(){for(var e=this.cells,t=this.datas,o=0;o<e.length;o++){var n=e[o],a=t[n.__data_index];this._callCellSetter(n,a)}},t.prototype.jumpToHead=function(){this.scrollToHead(0,!1)},t.prototype.jumpToTail=function(){this.scrollToTail(0,!1)},t.prototype.jumpToIndex=function(e,t){this.scrollToIndex(e,t,0,!1)},t.prototype.jumpToData=function(e,t){this.scrollToData(e,t,0,!1)},t.prototype.scrollToHead=function(e,t){void 0===e&&(e=.3),void 0===t&&(t=!0);var o=this.getComponent(cc.ScrollView);o.vertical&&o.horizontal?o.scrollToTopLeft(e,t):o.vertical?o.scrollToTop(e,t):o.horizontal&&o.scrollToLeft(e,t),e<=0&&this.onContainerMoved()},t.prototype.scrollToTail=function(e,t){void 0===e&&(e=.3),void 0===t&&(t=!0);var o=this.getComponent(cc.ScrollView);o.vertical&&o.horizontal?o.scrollToBottomRight(e,t):o.vertical?o.scrollToBottom(e,t):o.horizontal&&o.scrollToRight(e,t),e<=0&&this.onContainerMoved()},t.prototype.scrollToIndex=function(e,t,o,n){void 0===o&&(o=.3),void 0===n&&(n=!0);var a=this.getComponent(cc.ScrollView);cc.log("jumpToIndex",e);var r=this.layouter.getPos(e),i=this.layouter.getCellSize(),s=r.x,c=-r.y,l=this.layouter.getJumpOffset();s+=-i.width/2+l.x,c+=-i.height/2+l.y;var u=this._calcPercentPos(s,c);a.stopAutoScroll(),a.scrollTo(u,o,n),this.onContainerMoved()},t.prototype.scrollToData=function(e,t,o,n){void 0===o&&(o=.3),void 0===n&&(n=!0);var a=this.datas.indexOf(e);a<0||this.scrollToIndex(a,t,o,n)},t.prototype.onContainerMoved=function(e){this.updateCellState(),this.fOnContainerMoved&&this.fOnContainerMoved(this,this.cells)},t.prototype.onScrolling=function(e){this.onContainerMoved(e)},t=__decorate([s],t)}(cc.Node));o.default=c,cc._RF.pop()},{"../../game/view/node/LayerColor":"LayerColor","../utils/Timer":"Timer","./ViewBase":"ViewBase"}],ReusePageView:[function(e,t,o){"use strict";cc._RF.push(t,"65fdazMNa9BV6Lsa+An3z73","ReusePageView"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./ReuseList"),a=e("../utils/Tools"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){var t=e.call(this)||this;return t.fOnCellMoved=null,t.indexWhenBegan=0,t.touchBeganTime=0,a.default.registerTouchHandler(t,t.onTouchHandler.bind(t)),t}return __extends(t,e),t.prototype.onTouchHandler=function(e){if("began"==e.name){var t=this.calcNearestIndex();this.indexWhenBegan=t,this.touchBeganTime=(new Date).getTime()}else if("ended"==e.name||"cancelled"==e.name){t=this.calcNearestIndex();var o=e.getStartLocation(),n=e.getLocation(),a=((new Date).getTime()-this.touchBeganTime)/100,r=(o.x-n.x)/a,i=this.datas.length-1;t>=0&&(t==this.indexWhenBegan&&(r>=50&&t<i?t+=1:r<=-50&&t>0&&(t-=1)),0==t&&0==this.indexWhenBegan&&r<0||t==i&&this.indexWhenBegan==i&&r>0||this.scrollToIndex(t,null,.5,!0))}},t.prototype.calcNearestIndex=function(){for(var e=this.getListCenterInScrollX(),t=Number.POSITIVE_INFINITY,o=-1,n=0;n<this.cells.length;n++){var a=this.cells[n],r=(a.getContentSize(),a.getPosition().x),i=Math.abs(e-r);i<t&&(t=i,o=a.__data_index)}return o},t.prototype.getCellByDataIndex=function(e){for(var t=0;t<this.cells.length;t++){var o=this.cells[t];if(o.__data_index==e)return o}},t.prototype.getListCenterInScrollX=function(){var e=this.getComponent(cc.ScrollView).getScrollOffset();return this.getContentSize().width/2-e.x},t.prototype.onContainerMoved=function(t){if(e.prototype.onContainerMoved.call(this),this.fOnCellMoved)for(var o=this.getListCenterInScrollX(),n=0;n<this.cells.length;n++){var r=this.cells[n],i=r.getContentSize(),s=r.getPosition().x,c=Math.abs(o-s),l=a.default.scaleInRange(c,5,i.width,0,Math.PI/2),u=a.default.scaleInRange(Math.sin(l),0,1,1,0);this.fOnCellMoved(r,u,c)}},t.prototype.setOnCellMovedListener=function(e){this.fOnCellMoved=e},t=__decorate([i],t)}(n.default));o.default=s,cc._RF.pop()},{"../utils/Tools":"Tools","./ReuseList":"ReuseList"}],SceneBase:[function(e,t,o){"use strict";cc._RF.push(t,"5b505L37y1I6Zz2EV3Ib1Z3","SceneBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./ViewBase"),a=e("../../game/manager/mgrDirector"),r=cc._decorator.ccclass,i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.refreshSize(),this.registerListeners({MSG_VIEW_RESIZE:this.onMsgViewResize}),this.sendMsg("MSG_SCENE_LOADED")},t.prototype.refreshSize=function(){var e=a.default.size;this.setContentSize(e),this.nodeResource.setContentSize(e);for(var t=this.nodeResource.getComponentsInChildren(cc.Widget),o=0;o<t.length;o++){t[o].updateAlignment()}},t.prototype.onMsgViewResize=function(){this.refreshSize()},t=__decorate([r],t)}(n.default);o.default=i,cc._RF.pop()},{"../../game/manager/mgrDirector":"mgrDirector","./ViewBase":"ViewBase"}],ScleableButton:[function(e,t,o){"use strict";cc._RF.push(t,"d73bdn/VphF27UW9pqVYirD","ScleableButton"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../utils/Tools"),a=cc._decorator,r=a.ccclass,i=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.fOnTouchCallback=null,t._bFocused=!1,t.isAction=!0,t}var o;return __extends(t,e),o=t,t.setSoundPlayHandler=function(e){this.soundPlayHandler=e},t.prototype.onLoad=function(){},t.prototype.onEnable=function(){n.default.registerTouchHandler(this.node,this.onTouchHandler.bind(this))},t.prototype.onDisable=function(){n.default.unregisterTouchHandler(this.node)},t.prototype.registerOnTouchCallback=function(e){this.fOnTouchCallback=e},t.prototype.triggerOnTouchCallback=function(e){this.fOnTouchCallback&&this.fOnTouchCallback(e)},t.prototype._doDownAction=function(e,t){if(0!=this.isAction){var o=this.node;o.stopAllActions(),o.runAction(cc.scaleTo(.1,.85*e,.85*t).easing(cc.easeIn(2)))}},t.prototype._doUpAction=function(e,t){if(0!=this.isAction){var o=this.node;o.stopAllActions(),o.runAction(cc.sequence(cc.scaleTo(.1,1.1*e,1.1*t).easing(cc.easeIn(2)),cc.scaleTo(.075,.95*e,.95*t),cc.scaleTo(.03,1*e,1*t)))}},t.prototype._doCancellAction=function(e,t){if(0!=this.isAction){var o=this.node;o.stopAllActions(),o.runAction(cc.sequence(cc.scaleTo(.15,1.05*e,1.05*t).easing(cc.easeQuadraticActionInOut()),cc.scaleTo(.1,1*e,1*t).easing(cc.easeOut(2))))}},t.prototype.setActionEnable=function(e){this.isAction=e},t.prototype.onTouchHandler=function(e){if("began"==e.name)this.touchDownRect=n.default.calcNodeBoundingBoxToWorld(this.node),this._doDownAction(1,1),this._bFocused=!0,o.soundPlayHandler instanceof Function&&o.soundPlayHandler();else if("moved"==e.name){var t=this.touchDownRect.contains(e.getLocation());this._bFocused?t||(this._bFocused=!1,this._doCancellAction(1,1)):t&&(this._bFocused=!0,this._doDownAction(1,1))}else this._bFocused&&(this._bFocused=!1,this._doUpAction(1,1));this.triggerOnTouchCallback(e)},t.soundPlayHandler=null,t=o=__decorate([r],t)}(cc.Component));o.default=i,cc._RF.pop()},{"../utils/Tools":"Tools"}],Spine:[function(e,t,o){"use strict";cc._RF.push(t,"70a27a8rPxBe6fHsejteGfY","Spine"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../game/manager/mgrCfg"),a=e("../../game/manager/mgrDirector"),r=e("../utils/Tools"),i=function(e){function t(t){var o=e.call(this)||this;o.bLoaded=!1,o.asyncData=null,o.asyncAttach=[],o.asyncMix=[],o.skinName="normal",o.spineData=n.default.get("spine_db",t);o.addComponent(sp.Skeleton);return o._loadSkeletonData(),o}return __extends(t,e),t.prototype._loadSkeletonData=function(){var e=this,t=this.spineData;a.default.loadRes(t.jsonFileName,sp.SkeletonData,function(o,n){if(o)cc.warn("Spine._loadSkeletonData error:",o);else if(cc.isValid(e)){var a=e.getComponent(sp.Skeleton);a.skeletonData=n,a.defaultSkin=e.skinName,a.premultipliedAlpha=1==t.bPremultipliedAlpha,a._updateSkeletonData(),e.bLoaded=!0,e.asyncData&&e.play(e.asyncData.movNames,e.asyncData.bLoop);for(var r=0;r<e.asyncAttach.length;r++){var i=e.asyncAttach[r];a.setAttachment(i[0],i[1])}for(r=0;r<e.asyncMix.length;r++){i=e.asyncMix[r];a.setMix(i[0],i[1],i[2])}}})},t.prototype.reset=function(){this.active=!0,this.rotation=0,this.setPosition(0,0),this.scaleX=this.spineData.scaleX,this.scaleY=this.spineData.scaleY,this.color=cc.color(255,255,255),this.opacity=255;var e=this.getComponent(sp.Skeleton);e.timeScale=1,e.setToSetupPose()},t.prototype.play=function(e,t){if(e instanceof Array||(e=[e]),null==t&&(t=!0),e.length<=0)cc.warn("Spine.play movName of found!");else if(this.asyncData={movNames:e,bLoop:t},this.bLoaded&&cc.isValid(this)){this.asyncData=null;for(var o=this.spineData,n=this.getComponent(sp.Skeleton),a=0;a<e.length;a++){var r=e[a];o[r]&&(r=o[r]);var i=!!t&&a==e.length-1;0==a?(n.defaultAnimation=r,n.setAnimation(0,r,i)):n.addAnimation(0,r,i)}}},t.prototype.setPause=function(e){this.getComponent(sp.Skeleton).timeScale=e?0:1},t.prototype.setTimeScale=function(e){this.getComponent(sp.Skeleton).timeScale=e},t.prototype.registerEventCallback=function(e){var t=this;if(this.unregisterEventCallback(),e){var o=function(o,n){var a=o.animation,i=a?a.name:"unknown",s="unknown";r.default.forEachMap(t.spineData,function(e,t){if(t==i)return s=e,!0});var c={name:n,movName:i,movKey:s,bLoop:o.loop};e(c)},n=this.getComponent(sp.Skeleton);n.setStartListener(function(e){o(e,"start")}),n.setEndListener(function(e){o(e,"end")}),n.setCompleteListener(function(e){o(e,"cpmplete")}),n.setEventListener(function(e){o(e,"event")})}},t.prototype.unregisterEventCallback=function(){var e=this.getComponent(sp.Skeleton);e.setStartListener(null),e.setEndListener(null),e.setCompleteListener(null),e.setEventListener(null)},t.prototype.isLoaded=function(){return this.bLoaded},t.prototype.trySetAttachment=function(e,t){this.bLoaded?this.getComponent(sp.Skeleton).setAttachment(e,t):this.asyncAttach.push([e,t])},t.prototype.trySetMix=function(e,t,o){var n=this.spineData,a=n[e],r=n[t];a&&r&&(this.bLoaded?this.getComponent(sp.Skeleton).setMix(a,r,o):this.asyncMix.push([a,r,o]))},t.prototype.trySetSkin=function(e){(this.skinName=e,this.bLoaded)&&this.getComponent(sp.Skeleton).setSkin(e)},t}(cc.Node);o.default=i,cc._RF.pop()},{"../../game/manager/mgrCfg":"mgrCfg","../../game/manager/mgrDirector":"mgrDirector","../utils/Tools":"Tools"}],SpriteBasedClippingNode:[function(e,t,o){"use strict";cc._RF.push(t,"3b2ceHkR4BDN5w0zFQ6Kgvv","SpriteBasedClippingNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=1048576,a=function(e){function t(t,o){var a=e.call(this)||this;a.bInverted=!1,a.renderWidth=t,a.renderHeight=o,a.setContentSize(t,o);var r=new cc.RenderTexture(t,o);a._sgNode.addChild(r),a.renderTexture=r;var i=new cc.Node;i.parent=a,i.x=n,i.y=o/2,a.nodeRender=i;var s=new cc.Node;return s.parent=a,s.x=n,s.y=o/2,a.nodeStencil=s,a}return __extends(t,e),t.prototype.setInverted=function(e){},t.prototype.getRenderNode=function(){return this.nodeRender},t.prototype.getStencilNode=function(){return this.nodeStencil},t.prototype.flush=function(){var e=this.nodeRender,t=this.nodeStencil,o=this.renderTexture;o.clear(0,0,0,0),o.begin(),e.x=this.renderWidth/2,e._sgNode.visit(),e.x=n;for(var a=this.bInverted?770:771,r=t.getComponentsInChildren(cc.Sprite),i=0;i<r.length;i++){var s=r[i];s.srcBlendFactor=0,s.dstBlendFactor=a}t.x=this.renderWidth/2,t._sgNode.visit(),t.x=n,o.end()},t}(cc.Node);o.default=a,cc._RF.pop()},{}],SpriteEx:[function(e,t,o){"use strict";cc._RF.push(t,"2ebb8PW5WZNko0gGOLpZht+","SpriteEx"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../game/manager/mgrDirector");cc.Sprite.prototype.loadSpriteFrame=function(e){var t=this;n.default.loadRes(e,cc.SpriteFrame,function(e,o){e?cc.error(e.message):cc.isValid(t)&&(t.spriteFrame=o)})},cc.Sprite.prototype.loadSpriteFrameAndKeepSize=function(e){var t=this,o=this.node;o?n.default.loadRes(e,cc.SpriteFrame,function(e,n){if(e)cc.error(e.message);else if(cc.isValid(t)){t.__origin_width||(t.__origin_width=o.width*o.scaleX,t.__origin_height=o.height*o.scaleY);var a=t.__origin_width,r=t.__origin_height;t.spriteFrame=n,o.scale=Math.min(a/o.width,r/o.height)}}):cc.warn("SpriteEx.loadSpriteFrameAndKeepSize node not found!")},cc.Sprite.prototype.setSpriteFrameAndKeepSize=function(e){var t=this.node;if(t){if(cc.isValid(e)){this.__origin_width||(this.__origin_width=t.width*t.scaleX,this.__origin_height=t.height*t.scaleY);var o=this.__origin_width,n=this.__origin_height;this.spriteFrame=e,t.scale=Math.min(o/t.width,n/t.height)}}else cc.warn("SpriteEx.setSpriteFrameAndKeepSize node not found!")},cc._RF.pop()},{"../../game/manager/mgrDirector":"mgrDirector"}],StageScriptBase:[function(e,t,o){"use strict";cc._RF.push(t,"78127dtW6JFVp0bXsdSxa3P","StageScriptBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../manager/mgrCfg"),a=e("../manager/mgrStage"),r=e("../manager/mgrDirector"),i=e("../../ulframework/utils/Tools"),s=function(){function e(e){this.context={},this.minCount=4,this.pools={},this.context=e;for(var t=n.default.get_from_stage_db(this.context.stageId),o=1;o<=6;o++){var a=t["pool"+o.toString()];this.pools[o]=a}}return e.prototype.generateCustomerIds=function(){var e=n.default.get_from_stage_db(this.context.stageId);return ul.clone(e.customerIds)},e.prototype.generatePartIds=function(e){for(var t=n.default.get_from_stage_db(this.context.stageId),o=[],a=0,r=1;r<=6;r++){if(e)if(n.default.get_from_cake_part_db(e).type==r){o.push(e),a++,e=0;continue}var s=t["pool"+r.toString()],c=t["pool"+r.toString()+"Ratio"];if(c=6-r<=this.minCount-a?100:c,s.length>0&&c>=i.default.random(1,100)){var l=s[i.default.random(0,s.length-1)];o.push(l),a++}}return o},e.prototype.isShowStar=function(){return!0},e.prototype.isShowScore=function(){return!1},e.prototype.isPartDefaultOpen=function(){return!1},e.prototype.finishGame=function(e){var t=e.remainTime,o=a.default.finishStage(this.context.stageId,t);o.rating>0?r.default.openDialog("vGameSettlementDialog",{result:o}):r.default.openDialog("vGameFailedDialog",{result:o})},e}();o.default=s,cc._RF.pop()},{"../../ulframework/utils/Tools":"Tools","../manager/mgrCfg":"mgrCfg","../manager/mgrDirector":"mgrDirector","../manager/mgrStage":"mgrStage"}],StageScriptInfinite:[function(e,t,o){"use strict";cc._RF.push(t,"e369cKi6eFKZLPujt9Vak/h","StageScriptInfinite"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../manager/mgrCfg"),a=e("../manager/mgrDirector"),r=e("../../ulframework/utils/Tools"),i=function(){function e(e){this.context={},this.minCount=4,this.pools={},this.context=e;var t={};n.default.forDb_from_cake_part_db(function(e,o){t[o.type]||(t[o.type]=[]),t[o.type].push(o.id)}),this.pools=t}return e.prototype.generateCustomerIds=function(){for(var e=[],t=0;t<1e3;)n.default.forDb_from_customer_db(function(o,n){Math.random()>.5&&(t++,e.push(n.id))});return e},e.prototype.generatePartIds=function(e){for(var t,o=this.pools,n=((t={})[1]=100,t[2]=100,t[3]=100,t[4]=50,t[5]=50,t[6]=100,t),a=[],i=0,s=1;s<=6;s++){var c=o[s],l=n[s];if(l=6-s<=this.minCount-i?100:l,c.length>0&&l>=r.default.random(1,100)){var u=c[r.default.random(0,c.length-1)];a.push(u),i++}}return a},e.prototype.isShowStar=function(){return!1},e.prototype.isShowScore=function(){return!0},e.prototype.isPartDefaultOpen=function(){return!0},e.prototype.finishGame=function(e){a.default.openDialog("vInfiniteSettlementDialog",{score:e.score,customerCount:e.customerCount,bAddition:e.bAddition})},e}();o.default=i,cc._RF.pop()},{"../../ulframework/utils/Tools":"Tools","../manager/mgrCfg":"mgrCfg","../manager/mgrDirector":"mgrDirector"}],TaskManager:[function(e,t,o){"use strict";cc._RF.push(t,"29a59H2eEFBFLzr4u37WBFW","TaskManager"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(){this.taskList=[]}return e.prototype.push=function(e){!e||e.length<=0||this.taskList.push(e)},e.prototype.start=function(e){this.executeFinishCallback=e,this.__goNext()},e.prototype.__goNext=function(){var e=this;if(this.taskList.length>0)for(var t=this.taskList.shift(),o=0,n=0;n<t.length;n++){(0,t[n])(function(){++o==t.length&&e.__goNext()})}else this.executeFinishCallback()},e}();o.default=n,cc._RF.pop()},{}],TestAnimNode:[function(e,t,o){"use strict";cc._RF.push(t,"f627cotooNCU61V4ITZRD/h","TestAnimNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/SceneBase"),a=e("../../../ulframework/view/DebugMenu"),r=e("../../manager/mgrDirector"),i=e("../../../ulframework/view/DebugMouseControlNode"),s=e("../node/LayerColor"),c=e("../../manager/mgrPool"),l=e("../../../ulframework/view/ReuseList"),u=e("../../../ulframework/utils/Tools"),d=e("../../../ulframework/view/ReuseLayouterVBox"),p=e("../../manager/mgrCfg"),h=e("../../manager/mgrTip"),f=cc._decorator,g=f.ccclass,m=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelTitle=null,t.layoutBg=null,t.layoutList=null,t.selectedAnimId=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"_devtest/TestAnimNode"},t.prototype._getResourceBindingConfig=function(){return{CC_labelTitle:{varname:"labelTitle",vartype:cc.Label},CC_layoutBg:{varname:"layoutBg",vartype:cc.Layout},CC_layoutList:{varname:"layoutList",vartype:cc.Layout}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buildUi()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){var e=this,t=new a.default([["dispose",function(){e.animNode&&(e.animNode.removeFromParent(),c.default.put(e.animNode),e.animNode=null)}],["playOnce",function(){e.selectedAnimId&&h.default.playAnimNodeOnce(e.selectedAnimId,u.default.random(r.default.width),u.default.random(r.default.height))}]],250,50,4);t.parent=this,t.x=this.width/2+10-310,t.y=this.height/2-60;var o=new l.default;o.parent=this.layoutList.node,o.setLayouter((new d.default).setCellSize(292,50).setGap(4).setPending(4)),o.setCreator(function(t){var o=new s.default(cc.color(0,0,0,63));o.parent=t,o.setContentSize(t.getContentSize()),t.layerBg=o;var n=new cc.Node;n.parent=t;var a=n.addComponent(cc.Label);a.fontSize=18,a.verticalAlign=cc.Label.VerticalAlign.CENTER,t.label=a,u.default.registerTouchHandler(t,function(t){var o=t.target;"ended"==t.name&&e.onSelectAnimId(o.data.id)})}),o.setSetter(function(t,o){cc.color(255,255,255);t.label.node.color=o.id==e.selectedAnimId?cc.color(127,255,127):cc.color(255,255,255),t.label.string=ul.format("%s-%s",o.id,o.name)}),o.setContentSize(this.layoutList.node.getContentSize());var n=[];p.default.forDb("anim_node_db",function(e,t){n.push(t)}),o.setDatas(n),this.reuseList=o;var f=new i.default;f.parent=this,f.setPosition(0,-r.default.height/4),this.nodeRoot=f;var g=new s.default(cc.color(255,0,0,255));g.parent=f,g.zIndex=2,g.setContentSize(4,4)},t.prototype.onSelectAnimId=function(e){this.selectedAnimId=e,this.reuseList.refreshActiveCells();var t=p.default.get("anim_node_db",e);this.labelTitle.string=ul.format("%s-%s",t.id,t.name),this.animNode&&(this.animNode.removeFromParent(),c.default.put(this.animNode),this.animNode=null);var o=c.default.get("animNode",e);o.parent=this.nodeRoot,o.play(),this.animNode=o,o.registerEventCallback(function(e){cc.log("onAnimEvent",e)})},t=__decorate([g],t)}(n.default));o.default=m,cc._RF.pop()},{"../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/DebugMenu":"DebugMenu","../../../ulframework/view/DebugMouseControlNode":"DebugMouseControlNode","../../../ulframework/view/ReuseLayouterVBox":"ReuseLayouterVBox","../../../ulframework/view/ReuseList":"ReuseList","../../../ulframework/view/SceneBase":"SceneBase","../../manager/mgrCfg":"mgrCfg","../../manager/mgrDirector":"mgrDirector","../../manager/mgrPool":"mgrPool","../../manager/mgrTip":"mgrTip","../node/LayerColor":"LayerColor"}],TestFunc:[function(e,t,o){"use strict";cc._RF.push(t,"790d8biHgJIjqqqL4Fm2Q4W","TestFunc"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/SceneBase"),a=e("../../../ulframework/view/ReuseList"),r=e("../../../ulframework/view/ReuseLayouterVBox"),i=e("../node/LayerColor"),s=e("../../../ulframework/utils/Tools"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelTitle=null,t.layoutBg=null,t.layoutList=null,t.reuseList=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"_devtest/TestFunc"},t.prototype._getResourceBindingConfig=function(){return{CC_labelTitle:{varname:"labelTitle",vartype:cc.Label},CC_layoutBg:{varname:"layoutBg",vartype:cc.Layout},CC_layoutList:{varname:"layoutList",vartype:cc.Layout}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this);var t=new a.default;t.parent=this.layoutList.node,t.setLayouter((new r.default).setCellSize(292,50).setGap(4).setPending(4)),t.setCreator(function(e){var t=new i.default(cc.color(0,0,0,63));t.parent=e,t.setContentSize(e.getContentSize()),e.layerBg=t;var o=new cc.Node;o.parent=e;var n=o.addComponent(cc.Label);n.fontSize=18,n.verticalAlign=cc.Label.VerticalAlign.CENTER,e.label=n,s.default.registerTouchHandler(e,function(e){var t=e.target;"ended"==e.name&&t.data.func()})}),t.setSetter(function(e,t){e.label.string=ul.format("%s",t.name)}),t.setContentSize(this.layoutList.node.getContentSize());var o=[{name:"\u6df1\u5ea6\u62f7\u8d1d\u6d4b\u8bd5",func:function(){var e,t=[1,2,3,"abc","def","__a"];cc.log("org,arr:",t);var o=ul.clone(t);cc.log(o);var n=((e={}).abc=123,e[123]="abc",e[0]=1,e[1]=1,e[2]=1,e[3]=1,e[4]=1,e);cc.log("org,obj:",n);var a=ul.clone(n);cc.log(a)}}];t.setDatas(o),this.reuseList=t},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=__decorate([l],t)}(n.default));o.default=u,cc._RF.pop()},{"../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/ReuseLayouterVBox":"ReuseLayouterVBox","../../../ulframework/view/ReuseList":"ReuseList","../../../ulframework/view/SceneBase":"SceneBase","../node/LayerColor":"LayerColor"}],TestParticle:[function(e,t,o){"use strict";cc._RF.push(t,"17c9drHzM1GMq/2dDe3oY9Y","TestParticle"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/SceneBase"),a=e("../../../ulframework/view/DebugMenu"),r=e("../../../ulframework/view/ReuseList"),i=e("../../../ulframework/view/ReuseLayouterVBox"),s=e("../node/LayerColor"),c=e("../../../ulframework/utils/Tools"),l=e("../../manager/mgrCfg"),u=e("../../../ulframework/view/DebugMouseControlNode"),d=e("../../manager/mgrDirector"),p=e("../../manager/mgrPool"),h=e("../../manager/mgrTip"),f=cc._decorator,g=f.ccclass,m=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelTitle=null,t.layoutBg=null,t.layoutList=null,t.selectedParticleId=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"_devtest/TestParticle"},t.prototype._getResourceBindingConfig=function(){return{CC_labelTitle:{varname:"labelTitle",vartype:cc.Label},CC_layoutBg:{varname:"layoutBg",vartype:cc.Layout},CC_layoutList:{varname:"layoutList",vartype:cc.Layout}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buildUi()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){var e=this,t=new a.default([["dispose",function(){e.particle&&(e.particle.removeFromParent(),p.default.put(e.particle),e.particle=null)}],["playOnce",function(){e.selectedParticleId&&h.default.playParticleOnce(e.selectedParticleId,c.default.random(d.default.width),c.default.random(d.default.height))}],["\u8bfb\u53d6\u6570\u636e",function(){if(e.selectedParticleId){ul.dump(jsb);var t=l.default.get("particle_db",e.selectedParticleId),o=cc.url.raw(ul.format("resources/%s.plist",t.filename));cc.loader.load(o,function(e,t){cc.log("particle:"),cc.log(o),cc.log(t)})}}]],250,50,4);t.parent=this,t.x=this.width/2-260,t.y=this.height/2-60;var o=new r.default;o.parent=this.layoutList.node,o.setLayouter((new i.default).setCellSize(292,50).setGap(4).setPending(4)),o.setCreator(function(t){var o=new s.default(cc.color(0,0,0,63));o.parent=t,o.setContentSize(t.getContentSize()),t.layerBg=o;var n=new cc.Node;n.parent=t;var a=n.addComponent(cc.Label);a.fontSize=18,a.verticalAlign=cc.Label.VerticalAlign.CENTER,t.label=a,c.default.registerTouchHandler(t,function(t){var o=t.target;"ended"==t.name&&e.onSelectParticleId(o.data.id)})}),o.setSetter(function(t,o){cc.color(255,255,255);t.label.node.color=o.id==e.selectedParticleId?cc.color(127,255,127):cc.color(255,255,255),t.label.string=ul.format("%s-%s",o.id,o.name)}),o.setContentSize(this.layoutList.node.getContentSize());var n=[];l.default.forDb("particle_db",function(e,t){n.push(t)}),o.setDatas(n),this.reuseList=o;var f=new u.default;f.parent=this,f.setPosition(0,-d.default.height/4),this.nodeRoot=f;var g=new s.default(cc.color(255,0,0,255));g.parent=f,g.zIndex=2,g.setContentSize(4,4)},t.prototype.onSelectParticleId=function(e){this.selectedParticleId=e,this.reuseList.refreshActiveCells();var t=l.default.get("particle_db",e);this.labelTitle.string=ul.format("%s-%s",t.id,t.name),this.particle&&(this.particle.removeFromParent(),p.default.put(this.particle),this.particle=null);var o=p.default.get("particle",e);o.parent=this.nodeRoot;o.getComponent(cc.ParticleSystem);t.bPlayOnce||(this.particle=o)},t=__decorate([g],t)}(n.default));o.default=m,cc._RF.pop()},{"../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/DebugMenu":"DebugMenu","../../../ulframework/view/DebugMouseControlNode":"DebugMouseControlNode","../../../ulframework/view/ReuseLayouterVBox":"ReuseLayouterVBox","../../../ulframework/view/ReuseList":"ReuseList","../../../ulframework/view/SceneBase":"SceneBase","../../manager/mgrCfg":"mgrCfg","../../manager/mgrDirector":"mgrDirector","../../manager/mgrPool":"mgrPool","../../manager/mgrTip":"mgrTip","../node/LayerColor":"LayerColor"}],TestSound:[function(e,t,o){"use strict";cc._RF.push(t,"d733a3pO81OjIfHWXw8G5wW","TestSound"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/SceneBase"),a=e("../../../ulframework/view/ReuseList"),r=e("../../../ulframework/view/ReuseLayouterVBox"),i=e("../node/LayerColor"),s=e("../../manager/mgrCfg"),c=e("../../../ulframework/utils/Tools"),l=e("../../../ulframework/view/DebugMenu"),u=e("../../manager/mgrTip"),d=e("../../manager/mgrSound"),p=cc._decorator,h=p.ccclass,f=(p.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.layoutBg=null,t.layoutList=null,t.sliderEffect=null,t.sliderMusic=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"_devtest/TestSound"},t.prototype._getResourceBindingConfig=function(){return{CC_layoutBg:{varname:"layoutBg",vartype:cc.Layout},CC_layoutList:{varname:"layoutList",vartype:cc.Layout},CC_sliderEffect:{varname:"sliderEffect",vartype:cc.Slider},CC_sliderMusic:{varname:"sliderMusic",vartype:cc.Slider}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buildUi()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){var e=this,t=new a.default;t.parent=this.layoutList.node,t.setLayouter((new r.default).setCellSize(292,50).setGap(4).setPending(4)),t.setCreator(function(t){var o=new i.default(cc.color(0,0,0,255));o.parent=t,o.setContentSize(t.getContentSize()),t.layerBg=o;var n=new cc.Node;n.parent=t;var a=n.addComponent(cc.Label);a.fontSize=18,a.verticalAlign=cc.Label.VerticalAlign.CENTER,t.label=a,c.default.registerTouchHandler(t,function(o){o.isClick()&&e.onSelectSound(t.data.id)})}),t.setSetter(function(t,o){t.label.string=ul.format("%d[%d]-%s",o.id,o.type,o.name),t.label.node.color=e.selectedSoundId==o.id?cc.color(0,255,0):cc.color(255,255,255)}),t.setContentSize(this.layoutList.node.getContentSize());var o=[];s.default.forDb("sound_db",function(e,t){o.push(t)}),t.setDatas(o);var n=new l.default([["\u64ad\u653e",function(){var t=e.selectedSoundId;t?d.default.play(t):u.default.showMsgTip("\u8bf7\u5148\u9009\u62e9\u4e00\u4e2a\u58f0\u97f3")}],["\u505c\u6b62",function(){d.default.stopAll()}]],250,50,4);n.parent=this,n.x=-this.width/2+10+310,n.y=this.height/2-60,this.sliderMusic.node.on("slide",this.onSlideSliderMusic.bind(this)),this.sliderEffect.node.on("slide",this.onSlideSliderEffect.bind(this)),this.sliderMusic.progress=d.default.getMusicVolmue(),this.sliderEffect.progress=d.default.getEffectVolume(),this.reuseList=t},t.prototype.onSelectSound=function(e){this.selectedSoundId=e,this.reuseList.refreshActiveCells()},t.prototype.onSlideSliderMusic=function(e){var t=e.target.getComponent(cc.Slider);cc.log("onSlideSliderMusic",t.progress),d.default.setMusicVomue(t.progress)},t.prototype.onSlideSliderEffect=function(e){var t=e.target.getComponent(cc.Slider);cc.log("onSlideSliderEffect",t.progress),d.default.setEffectVolume(t.progress)},t=__decorate([h],t)}(n.default));o.default=f,cc._RF.pop()},{"../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/DebugMenu":"DebugMenu","../../../ulframework/view/ReuseLayouterVBox":"ReuseLayouterVBox","../../../ulframework/view/ReuseList":"ReuseList","../../../ulframework/view/SceneBase":"SceneBase","../../manager/mgrCfg":"mgrCfg","../../manager/mgrSound":"mgrSound","../../manager/mgrTip":"mgrTip","../node/LayerColor":"LayerColor"}],TestSpine:[function(e,t,o){"use strict";cc._RF.push(t,"2ad0fJwPe9DaqKZhsBEvEkX","TestSpine"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/SceneBase"),a=e("../../../ulframework/view/DebugMenu"),r=e("../../../ulframework/view/ReuseList"),i=e("../../../ulframework/view/ReuseLayouterVBox"),s=e("../node/LayerColor"),c=e("../../../ulframework/utils/Tools"),l=e("../../manager/mgrCfg"),u=e("../../../ulframework/view/DebugMouseControlNode"),d=e("../../manager/mgrDirector"),p=e("../../manager/mgrPool"),h=e("../../manager/mgrTip"),f=cc._decorator,g=f.ccclass,m=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelTitle=null,t.layoutBg=null,t.layoutList=null,t.selectedSpineId=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"_devtest/TestSpine"},t.prototype._getResourceBindingConfig=function(){return{CC_labelTitle:{varname:"labelTitle",vartype:cc.Label},CC_layoutBg:{varname:"layoutBg",vartype:cc.Layout},CC_layoutList:{varname:"layoutList",vartype:cc.Layout}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buildUi()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.spine&&(this.spine.removeFromParent(),p.default.put(this.spine),this.spine=null)},t.prototype.buildUi=function(){var e=this,t=new a.default([["dispose",function(){e.spine&&(e.spine.removeFromParent(),p.default.put(e.spine),e.spine=null)}],["mov_1",function(){e.spine&&e.spine.play("mov_1",e.spine.spineData._bDebugLoop)}],["mov_2",function(){e.spine&&e.spine.play("mov_2",e.spine.spineData._bDebugLoop)}],["mov_3",function(){e.spine&&e.spine.play("mov_3",e.spine.spineData._bDebugLoop)}],["mov_4",function(){e.spine&&e.spine.play("mov_4",e.spine.spineData._bDebugLoop)}],["mov_5",function(){e.spine&&e.spine.play("mov_5",e.spine.spineData._bDebugLoop)}],["mov_6",function(){e.spine&&e.spine.play("mov_6",e.spine.spineData._bDebugLoop)}],["mov_7",function(){e.spine&&e.spine.play("mov_7",e.spine.spineData._bDebugLoop)}],["mov_8",function(){e.spine&&e.spine.play("mov_8",e.spine.spineData._bDebugLoop)}],["mov_9",function(){e.spine&&e.spine.play("mov_9",e.spine.spineData._bDebugLoop)}],["skin1",function(){e.spine&&e.spine.getComponent(sp.Skeleton).setSkin("normal")}],["skin2",function(){e.spine&&e.spine.getComponent(sp.Skeleton).setSkin("normal1")}],["skin3",function(){e.spine&&e.spine.getComponent(sp.Skeleton).setSkin("normal2")}],["skin4",function(){e.spine&&e.spine.getComponent(sp.Skeleton).setSkin("normal3")}],["skin5",function(){e.spine&&e.spine.getComponent(sp.Skeleton).setSkin("normal4")}],["playOnce",function(){e.selectedSpineId&&h.default.playSpineOnce(e.selectedSpineId,c.default.random(d.default.width),c.default.random(d.default.height))}],["head",function(){if(e.spine){switch(e.headIndex||(e.headIndex=1),e.headIndex){case 1:e.spine.getComponent(sp.Skeleton).setAttachment("toukui","toukui");break;case 2:e.spine.getComponent(sp.Skeleton).setAttachment("toukui","toukui02");break;case 3:e.spine.getComponent(sp.Skeleton).setAttachment("toukui","toukui03");break;case 4:e.spine.getComponent(sp.Skeleton).setAttachment("toukui",null)}e.headIndex++,e.headIndex>4&&(e.headIndex=1)}}],["cloth",function(){if(e.spine){switch(e.clothIndex||(e.clothIndex=1),e.clothIndex){case 1:e.spine.getComponent(sp.Skeleton).setAttachment("fangdanyi","fangdanyi");break;case 2:e.spine.getComponent(sp.Skeleton).setAttachment("fangdanyi","fangdanyi02");break;case 3:e.spine.getComponent(sp.Skeleton).setAttachment("fangdanyi","fangdanyi03");break;case 4:e.spine.getComponent(sp.Skeleton).setAttachment("fangdanyi",null)}e.clothIndex++,e.clothIndex>4&&(e.clothIndex=1)}}],["gun",function(){if(e.spine){switch(e.gunIndex||(e.gunIndex=1),e.gunIndex){case 1:e.spine.getComponent(sp.Skeleton).setAttachment("qiang","98K"),e.spine.getComponent(sp.Skeleton).setAttachment("danjia",null);break;case 2:e.spine.getComponent(sp.Skeleton).setAttachment("qiang","AK47"),e.spine.getComponent(sp.Skeleton).setAttachment("danjia","AK47-danjia");break;case 3:e.spine.getComponent(sp.Skeleton).setAttachment("qiang","AWM"),e.spine.getComponent(sp.Skeleton).setAttachment("danjia","AWM-danjia");break;case 4:e.spine.getComponent(sp.Skeleton).setAttachment("qiang","HK416"),e.spine.getComponent(sp.Skeleton).setAttachment("danjia","HK416-danjia");break;case 5:e.spine.getComponent(sp.Skeleton).setAttachment("qiang","M16"),e.spine.getComponent(sp.Skeleton).setAttachment("danjia","M16-danjia");break;case 6:e.spine.getComponent(sp.Skeleton).setAttachment("qiang","M249"),e.spine.getComponent(sp.Skeleton).setAttachment("danjia","M249-danjia");break;case 7:e.spine.getComponent(sp.Skeleton).setAttachment("qiang","SPAS12"),e.spine.getComponent(sp.Skeleton).setAttachment("danjia",null);break;case 8:e.spine.getComponent(sp.Skeleton).setAttachment("qiang","UMP45"),e.spine.getComponent(sp.Skeleton).setAttachment("danjia","UMP45-danjia")}e.gunIndex++,e.gunIndex>8&&(e.gunIndex=1)}}]],250,50,4);t.parent=this,t.x=this.width/2-260,t.y=this.height/2-60;var o=new r.default;o.parent=this.layoutList.node,o.setLayouter((new i.default).setCellSize(292,50).setGap(4).setPending(4)),o.setCreator(function(t){var o=new s.default(cc.color(0,0,0,63));o.parent=t,o.setContentSize(t.getContentSize()),t.layerBg=o;var n=new cc.Node;n.parent=t;var a=n.addComponent(cc.Label);a.fontSize=18,a.verticalAlign=cc.Label.VerticalAlign.CENTER,t.label=a,c.default.registerTouchHandler(t,function(t){var o=t.target;"ended"==t.name&&e.onSelectSpineId(o.data.id)})}),o.setSetter(function(t,o){cc.color(255,255,255);t.label.node.color=o.id==e.selectedSpineId?cc.color(127,255,127):cc.color(255,255,255),t.label.string=ul.format("%s-%s",o.id,o.name)}),o.setContentSize(this.layoutList.node.getContentSize());var n=[];l.default.forDb("spine_db",function(e,t){n.push(t)}),o.setDatas(n),this.reuseList=o;var f=new u.default;f.parent=this,f.setPosition(0,-d.default.height/4),this.nodeRoot=f;var g=new s.default(cc.color(255,0,0,255));g.parent=f,g.zIndex=2,g.setContentSize(4,4)},t.prototype.onSelectSpineId=function(e){this.selectedSpineId=e,this.reuseList.refreshActiveCells();var t=l.default.get("spine_db",e);this.labelTitle.string=ul.format("%s-%s",t.id,t.name),this.spine&&(this.spine.removeFromParent(),p.default.put(this.spine),this.spine=null);var o=p.default.get("spine",e);o.parent=this.nodeRoot,o.play("mov_2",!0),this.spine=o;var n=c.default.time();o.registerEventCallback(function(e){cc.log("onSpineEvent",e),cc.log("used time ",n-c.default.time()),n=c.default.time()})},t=__decorate([g],t)}(n.default));o.default=m,cc._RF.pop()},{"../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/DebugMenu":"DebugMenu","../../../ulframework/view/DebugMouseControlNode":"DebugMouseControlNode","../../../ulframework/view/ReuseLayouterVBox":"ReuseLayouterVBox","../../../ulframework/view/ReuseList":"ReuseList","../../../ulframework/view/SceneBase":"SceneBase","../../manager/mgrCfg":"mgrCfg","../../manager/mgrDirector":"mgrDirector","../../manager/mgrPool":"mgrPool","../../manager/mgrTip":"mgrTip","../node/LayerColor":"LayerColor"}],Timer:[function(e,t,o){"use strict";cc._RF.push(t,"f3111ePoeBAwIQ8CGVyY16w","Timer"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function e(e,t,o){this._repeatCount=-1,this._span=1,this._callback=null,this._intervalId=null,this._count=0,this._span=e,this._repeatCount=t,this._callback=o}return e.callLater=function(t,o,n){var a=new e(t,1,o);n?a.startAndBindToNode(n):a.start()},e.callLoop=function(t,o,n){var a=new e(t,-1,o);if(1==n){var r=n;a.start(r)}else if(n instanceof cc.Node){a.startAndBindToNode(n)}else a.start()},e.prototype._onSpan=function(){if(this._count++,this._callback)try{this._callback(this)}catch(e){cc.warn("\u8b66\u544a] Timer._onSpan callback has error",e)}this._repeatCount>=0&&this._count>=this._repeatCount&&this.stop()},e.prototype.isRunning=function(){return null!=this._intervalId},Object.defineProperty(e.prototype,"count",{get:function(){return this._count},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"span",{get:function(){return this._span},enumerable:!0,configurable:!0}),e.prototype.startAndBindToNode=function(e){var t=this,o=new cc.Node,n=o.addComponent(cc.Component);return 0==n._isOnLoadCalled?n.onLoad=function(){t.start(!0)}:this.start(!0),n.onDestroy=function(){t.stop()},o.parent=e,this._bindingNode=o,this},e.prototype.start=function(e){return void 0===e&&(e=!1),this.stop(),this._callback?(!e&&this._repeatCount<0&&(cc.warn("\u8b66\u544a] Timer.start, this timer will never stop!"),cc.warn("\u8b66\u544a]     please use startAndBindToNode"),cc.warn("\u8b66\u544a]     or your can stop timer in callback. use e:stop()")),this._count=0,this._intervalId=setInterval(this._onSpan.bind(this),1e3*this.span),this):(cc.warn("\u8b66\u544a] Timer.start callback\u672a\u8bbe\u7f6e\uff01"),this)},e.prototype.stop=function(){return null!=this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null),this},e}();o.default=n,cc._RF.pop()},{}],Tools:[function(e,t,o){"use strict";cc._RF.push(t,"ddcc2p3lQhKBYTlLASMxtxW","Tools"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../game/Const"),a=cc._decorator,r=a.ccclass,i=(a.property,function(){function e(){}var t;return t=e,e.time=function(){return null!=this._debugTime?this._debugTime:(new Date).getTime()/1e3},e._setDebugTime=function(e){this._debugTime=e},e.isOneDay=function(e,t){var o=new Date(1e3*e),n=new Date(1e3*t);return o.getFullYear()==n.getFullYear()&&o.getMonth()==n.getMonth()&&o.getDate()==n.getDate()},e.registerTouchHandler=function(e,t,o){void 0===o&&(o=!1);var n=e;if(n&&t){n.on(cc.Node.EventType.TOUCH_START,function(e){var a=e.getID()||0;return!(!o&&null!=n.__touch_id||(e.name="began",e.stopPropagation(),n.__touch_id=a,t(e),0))}),n.on(cc.Node.EventType.TOUCH_MOVE,function(e){var a=e.getID()||0;(o||a==n.__touch_id)&&(e.name="moved",t(e))}),n.on(cc.Node.EventType.TOUCH_END,function(e){var a=e.getID()||0;(o||a==n.__touch_id)&&(e.name="ended",n.__touch_id=null,t(e))}),n.on(cc.Node.EventType.TOUCH_CANCEL,function(e){var a=e.getID()||0;(o||a==n.__touch_id)&&(e.name="cancelled",n.__touch_id=null,t(e))})}},e.unregisterTouchHandler=function(e){e.off(cc.Node.EventType.TOUCH_START,null),e.off(cc.Node.EventType.TOUCH_MOVE,null),e.off(cc.Node.EventType.TOUCH_END,null),e.off(cc.Node.EventType.TOUCH_CANCEL,null)},e.getObjSize=function(e){if(!e)return 0;if(Array.isArray(e))return e.length;var o=0;return t.forEachMap(e,function(e,t){o++}),o},e.random=function(e,t){return null==e&&null==t?Math.random():null==t?Math.floor(Math.random()*e+1):Math.floor(Math.random()*(t-e+1)+e)},e.scaleInRange=function(e,t,o,n,a){return t<o?(e<t&&(e=t),e>o&&(e=o)):(e<o&&(e=o),e>t&&(e=t)),(e-t)/(o-t)*(a-n)+n},e.isWorldInLocalNode=function(e,o,n){var a=t.calcNodeBoundingBoxToWorld(e);return null!=n&&(a.x-=n,a.y-=n,a.width+=2*n,a.height+=2*n),a.contains(o)},e.calcRecursiveScale=function(e){var t=1;do{t*=e.getScale(),e=e.parent}while(null!=e);return t},e.calcWheelTarget=function(e,t){for(var o=0,n=0;n<e.length;n++){var a=e[n],r=parseInt(a[t]);if(isNaN(r))return cc.warn(ul.format("Tools.calcWheelTarget weight field not found! key=[%s]",t)),null;o+=r}var i=this.random(o);for(n=0;n<e.length;n++){a=e[n];if(i<=(r=parseInt(a[t])))return a;i-=r}return null},e.sortArrayByField=function(e,t){t="string"==typeof t?[t]:t;var o=[];for(var n in t){if((s=t[n])&&""!=s)if("-"===s.substring(0,1)){var a=s.substring(1,s.length);a&&""!=a&&o.push([a,!0])}else o.push([s,!1])}for(var r=[],i=0;i<e.length;i++){var s=e[i];r.push(s)}return r.sort(function(e,t){var n=0;for(var a in o){var r=o[a],i=r[0],s=r[1],c=e[i],l=t[i];if(null!=c&&0!=(n=s?l-c:c-l))return n}return n}),r},e.bubbleSort=function(e,t){for(var o=e.length,n=0;n<o;n++)for(var a=0;a<o-1-n;a++){if(t(e[a],e[a+1])>0){var r=e[a+1];e[a+1]=e[a],e[a]=r}}return e},e.forEachMap=function(e,t){if(e)for(var o=Object.keys(e),n=0;n<o.length;n++){var a=o[n],r=e[a];if(null!=r&&t(a,r))break}},e._origin_sortTiles=function(e){for(var t=function(e,t){return t.right>e.x&&t.top>e.y},o=[],n=e.length,a=0;a<n;a++)for(var r=e[a],i=o.indexOf(r),s=0,c=e.length;s<c;s++)if(a!=s){var l=e[s];if(t(r,l)){var u=o.indexOf(l);i<0&&(o.push(r),i=o.length-1),u<0&&(o.push(l),u=o.length-1),u<i&&(o.splice(i,1),o.splice(u,0,r),i=u)}}for(a=0;a<e.length;a++){r=e[a];o.indexOf(r)<0&&o.push(r)}return o},e.sortTiles=function(e){for(var t=function(e,t){return t.right>e.x&&t.top>e.y},o=0;o<e.length;o++){e[o]._id=o}var n=[],a={},r=e.length;for(o=0;o<r;o++)for(var i=a[(d=e[o])._id],s=0;s<r;s++)if(o!=s){var c=e[s];if(t(d,c)){var l=a[c._id];if(null==i&&(n.push(d),i=n.length-1,a[d._id]=i),null==l&&(n.push(c),l=n.length-1,a[c._id]=l),l<i){for(var u=l;u<i;u++){a[n[u]._id]++}n.splice(i,1),n.splice(l,0,d),i=l,a[d._id]=i}}}for(o=0;o<e.length;o++){var d;null==a[(d=e[o])._id]&&n.push(d)}return n},e.convertRectToNodeSpace=function(e,t){if(!t)return null;var o=cc.v2(t.xMin,t.yMin),n=cc.v2(t.xMax,t.yMax);o=e.convertToNodeSpaceAR(o),n=e.convertToNodeSpaceAR(n);var a=Math.min(o.x,n.x),r=Math.min(o.y,n.y),i=Math.max(o.x,n.x)-a,s=Math.max(o.y,n.y)-r;return new cc.Rect(a,r,i,s)},e.convertRectToWorldSpace=function(e,t){if(!t)return null;var o=cc.v2(t.xMin,t.yMin),n=cc.v2(t.xMax,t.yMax);o=e.convertToWorldSpaceAR(o),n=e.convertToWorldSpaceAR(n);var a=Math.min(o.x,n.x),r=Math.min(o.y,n.y),i=Math.max(o.x,n.x)-a,s=Math.max(o.y,n.y)-r;return new cc.Rect(a,r,i,s)},e.calcNodeBoundingBoxToWorld=function(e,o){var n=e.getBoundingBox();return o&&(n.x-=o,n.y-=o,n.width+=2*o,n.height+=2*o),t.convertRectToWorldSpace(e.parent,n)},e.formatTime=function(e,t){var o=Math.floor(e/3600),n=Math.floor(e/60)%60,a=Math.floor(e)%60;return t.match("%h")&&(t=t.replace("%h",o.toString())),t.match("%H")&&(t=t.replace("%H",ul.format("%02d",o))),t.match("%m")&&(t=t.replace("%m",n.toString())),t.match("%M")&&(t=t.replace("%M",ul.format("%02d",n))),t.match("%s")&&(t=t.replace("%s",a.toString())),t.match("%S")&&(t=t.replace("%S",ul.format("%02d",a))),t},e.formatFullTime=function(e,t){var o=new Date(e),n=o.getFullYear(),a=o.getMonth()+1,r=o.getDate(),i=o.getHours(),s=o.getMinutes(),c=o.getSeconds();return t.match("%y")&&(t=t.replace("%y",n.toString())),t.match("%m")&&(t=t.replace("%m",a.toString())),t.match("%M")&&(t=t.replace("%M",ul.format("%02d",a))),t.match("%d")&&(t=t.replace("%d",r.toString())),t.match("%D")&&(t=t.replace("%D",ul.format("%02d",r))),t.match("%h")&&(t=t.replace("%h",i.toString())),t.match("%H")&&(t=t.replace("%H",ul.format("%02d",i))),t.match("%tm")&&(t=t.replace("%tm",s.toString())),t.match("%TM")&&(t=t.replace("%TM",ul.format("%02d",s))),t.match("%s")&&(t=t.replace("%s",c.toString())),t.match("%S")&&(t=t.replace("%S",ul.format("%02d",c))),t},e.setCascadeColor=function(e,t){e.color=t;for(var o=0;o<e.children.length;o++){var n=e.children[o];this.setCascadeColor(n,t)}},e.generateUUID=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var o=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?o:3&o|8).toString(16)})},e.parseLogicExpressionArray=function(e){for(var t=!0,o=!1,n=null,a=0;a<e.length;a++){var r=e[a];switch(Array.isArray(r)&&(r=this.parseLogicExpressionArray(r)),typeof r){case"string":switch(r){case"not":o=!o;break;case"and":n&&cc.warn(ul.format("Tools.parseLogicExpressionArray exp='%s' symbol overload index=[%d], origin_symbol=[%s], new_symbol=[%s]",JSON.stringify(e),a,n,r)),n="and";break;case"or":n&&cc.warn(ul.format("Tools.parseLogicExpressionArray exp='%s' symbol overload index=[%d], origin_symbol=[%s], new_symbol=[%s]",JSON.stringify(e),a,n,r)),n="or";break;default:cc.warn(ul.format("Tools.parseLogicExpressionArray exp='%s' unknown symbol index=[%d], symbol=[%s]",JSON.stringify(e),a,r))}break;case"boolean":o&&(r=!r,o=!1),t=n&&"and"!=n?t||r:t&&r}}return t},e.recursionChildren=function(e,t){if(cc.isValid(e)&&t)for(var o=0;o<e.children.length;o++){var n=e.children[o];cc.isValid(n)&&(t(n),this.recursionChildren(n,t))}},e.formatNumToStr=function(e){var t=e.toString();return e>=1e12?t=Math.floor(e/10/1e3/1e3/1e3)/100+"mm":e>=1e9?t=Math.floor(e/10/1e3/1e3)/100+"km":e>=1e6?t=Math.floor(e/10/1e3)/100+"m":e>=1e3&&(t=Math.floor(e/10)/100+"k"),t},e.getNodeWorldPosAR=function(e){return e.parent.convertToWorldSpaceAR(e.getPosition())},e.getIntersectPointLineWithRect=function(e,t,o){var n=null,a=null;(o.contains(e)||o.contains(t))&&(n=e.clone());var r=cc.v2(o.xMin,o.yMin),i=cc.v2(o.xMin,o.yMax),s=cc.v2(o.xMax,o.yMin),c=cc.v2(o.xMax,o.yMax);return this.isIntersectLineWithLine(e,t,r,i)&&(a=this.getIntersectPointLineWithLine(e,t,r,i)),this.isIntersectLineWithLine(e,t,i,c)&&(a=this.getIntersectPointLineWithLine(e,t,i,c)),this.isIntersectLineWithLine(e,t,c,s)&&(a=this.getIntersectPointLineWithLine(e,t,c,s)),this.isIntersectLineWithLine(e,t,s,r)&&(a=this.getIntersectPointLineWithLine(e,t,s,r)),a&&(n=a),n},e.isIntersectLineWithLine=function(e,t,o,n){return this.quickReject(e,t,o,n)&&this.straddle(e,t,o,n)},e.quickReject=function(e,t,o,n){var a=Math.max(e.x,t.x),r=Math.max(e.y,t.y),i=Math.min(e.x,t.x),s=Math.min(e.y,t.y),c=Math.max(o.x,n.x),l=Math.max(o.y,n.y),u=Math.min(o.x,n.x),d=Math.min(o.y,n.y);return!(a<u||r<d||c<i||l<s)},e.straddle=function(e,t,o,n){var a=e.x,r=t.x,i=e.y,s=t.y,c=o.x,l=n.x,u=o.y,d=n.y;return!(((a-c)*(d-u)-(i-u)*(l-c))*((r-c)*(d-u)-(s-u)*(l-c))>0||((c-a)*(s-i)-(u-i)*(r-a))*((l-a)*(s-i)-(d-i)*(r-a))>0)},e.getIntersectPointLineWithLine=function(e,t,o,n){var a=e.x,r=t.x,i=e.y,s=t.y,c=o.x,l=n.x,u=o.y,d=n.y,p=(s-i)*(l-c)-(a-r)*(u-d);if(0==p)return null;var h=((r-a)*(l-c)*(u-i)+(s-i)*(l-c)*a-(d-u)*(r-a)*c)/p,f=-((s-i)*(d-u)*(c-a)+(r-a)*(d-u)*i-(l-c)*(s-i)*u)/p;return(h-a)*(h-r)<=0&&(f-i)*(f-s)<=0&&(h-c)*(h-l)<=0&&(f-u)*(f-d)<=0?cc.v2(h,f):null},e.getRotateByVector=function(e){var t=0,o=e.x,a=e.y;0!=o?t=-1*Math.atan(a/o)*n.default.RADIAN2EULAR:a>0?t=-90:a<0&&(t=90);return t},e.degreesToVector=function(e){var t=cc.misc.degreesToRadians(e);return cc.v2(1,0).rotate(-t)},e.vectorToDegress=function(e){var t=cc.v2(1,0),o=e.signAngle(t);return cc.misc.radiansToDegrees(o)},e.calcResourcesRawUrl=function(e){return cc.url.raw("resources/")+e.replace("resources/","")},e._debugTime=null,e.calcPointOnArc=function(e,t,o,n){var a=n*Math.PI/180;return[Math.cos(a)*o+e,Math.sin(a)*o+t]},e=t=__decorate([r],e)}());o.default=i,cc._RF.pop()},{"../../game/Const":"Const"}],ULNativeController:[function(e,t,o){"use strict";cc._RF.push(t,"3ed3b2mFs9JvqZRCOlbXot4","ULNativeController"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../ulsdkdemo/ulsdkmiddleware/ulsdkdemomiddleware.js"),a=function(){function e(){}return e.sendMsgToSdk=function(e){n.request(e)},e.setGameCallback=function(e){n.setGameCallback(e)},e.initSdk=function(){n.initSdk()},e}();o.default=a,cc._RF.pop()},{"../ulsdkdemo/ulsdkmiddleware/ulsdkdemomiddleware.js":"ulsdkdemomiddleware"}],UnitTestCase:[function(e,t,o){"use strict";cc._RF.push(t,"1575fu8zohGiKKS7rO7tRc3","UnitTestCase"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(){function e(){this.assertCount=0,this.assertFaildCount=0}return e.prototype.prepare=function(){},e.prototype.run=function(){},e.prototype.cleanup=function(){},e.prototype.assertEquals=function(e,t,o){this.assertCount++,o!=t?(cc.error(ul.format("%s: \u65ad\u8a00\u5f02\u5e38\uff1a%s \u671f\u671b==[%s] \u5b9e\u9645\u503c\uff1a[%s]",this.name,e,o,t)),this.assertFaildCount++):this.isLogPassInfo()&&cc.log(ul.format("%s: \u65ad\u8a00\u901a\u8fc7: %s",this.name,e))},e.prototype.assertNotEquals=function(e,t,o){this.assertCount++,o==t?(cc.error(ul.format("%s: \u65ad\u8a00\u5f02\u5e38\uff1a%s \u671f\u671b!=[%s] \u5b9e\u9645\u503c\uff1a[%s]",this.name,e,o,t)),this.assertFaildCount++):this.isLogPassInfo()&&cc.log(ul.format("%s: \u65ad\u8a00\u901a\u8fc7: %s",this.name,e))},e.prototype.isLogPassInfo=function(){return!1},e=__decorate([a],e)}());o.default=r,cc._RF.pop()},{}],ViewBase:[function(e,t,o){"use strict";cc._RF.push(t,"61455sbxEVAr5Ssh4NM0iMG","ViewBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../game/manager/mgrDirector"),a=e("../component/LifeCycleMonitor"),r=e("../utils/MsgHandler"),i=e("../utils/Tools"),s=function(e){function t(t){void 0===t&&(t={});var o=e.call(this)||this;return t||(t={}),o.context=t,o._msgHander=new r.default,o._bindLifeCycle(),o}return __extends(t,e),t.prototype._onPreDestroy=function(){this.onDestroy(),e.prototype._onPreDestroy&&e.prototype._onPreDestroy.call(this)},t.prototype.onLoad=function(){this.startProcMsg(),this._loadResource()},t.prototype.onResourceLoaded=function(){},t.prototype.start=function(){},t.prototype.update=function(e){},t.prototype.onDestroy=function(){this.stopProcMsg()},t.prototype.registerListeners=function(e){var t=this;i.default.forEachMap(e,function(o,n){e[o]=n.bind(t)}),this._msgHander.registerListeners(e)},t.prototype.startProcMsg=function(){this._msgHander.startProcMsg()},t.prototype.stopProcMsg=function(){this._msgHander.stopProcMsg()},t.prototype.sendMsg=function(e,t){this._msgHander.sendMsg(e,t)},t.prototype._getResourceName=function(){return""},t.prototype._getResourceBindingConfig=function(){return{}},t.prototype._loadResource=function(){var e=this,t=this._getResourceName();if(!t)return this.nodeResource=this,this.onResourceLoaded(),void(this.nodeResource=this);n.default.loadNode(t,function(o){var n=o;if(cc.isValid(e)){cc.log("@@@resourceName: ",t);var a=new cc.Node;a.parent=e,n.parent=a,0==n.x&&0==n.y||n.setPosition(0,0);var r=e._buildNodeMapping(n);i.default.forEachMap(e._getResourceBindingConfig(),function(t,o){var n=r[t];if(n){var a=null;if(o.vartype==cc.Node)a=n;else if(a=n.getComponent(o.vartype)){var i=o.events;if(i)for(var s=0;s<i.length;s++){var c=i[s],l=c.bindMethod,u=c.method;a[l]instanceof Function?e[u]instanceof Function?a[l](e[u].bind(e)):cc.warn(ul.format("ViewBase._loadResource method not found! varname=[%s] method=[%s]",c.varname,u)):cc.warn(ul.format("ViewBase._loadResource bindMethod not found! varname=[%s] bindMethodName=[%s]",c.varname,l))}}else cc.warn("ViewBase._loadResource obj not found!",t);e[o.varname]=a}else cc.warn("ViewBase._loadResource node not found!",t)}),cc.log("  after loaded, trigger onResourceLoaded"),e.nodeResource=n,e.onResourceLoaded()}else cc.warn("ViewBase._loadResource when nodeResource laod finished, this is unvaliad!")})},t.prototype._buildNodeMapping=function(e,t){t||(t={}),e.name&&(t[e.name]=e);for(var o=e.children,n=0;n<o.length;n++){var a=o[n];this._buildNodeMapping(a,t)}return t},t.prototype._bindLifeCycle=function(){var e=this.addComponent(a.default);e.setOnLoadCallback(this.onLoad.bind(this)),e.setStartCallback(this.start.bind(this)),e.setUpdateCallback(this.update.bind(this))},t.prototype.isResourceLoaded=function(){return cc.isValid(this.nodeResource)},t}(cc.Node);o.default=s,cc._RF.pop()},{"../../game/manager/mgrDirector":"mgrDirector","../component/LifeCycleMonitor":"LifeCycleMonitor","../utils/MsgHandler":"MsgHandler","../utils/Tools":"Tools"}],init:[function(e,t,o){"use strict";cc._RF.push(t,"c811f+28JBJvILU83JHrwdf","init"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./game/manager/mgrCfg"),a=e("./game/manager/mgrDirector"),r=e("./game/manager/mgrRecord"),i=e("./game/manager/mgrPlayer"),s=e("./game/manager/mgrDebug"),c=e("./game/manager/mgrNetwork"),l=e("./game/manager/mgrTip"),u=e("./game/manager/mgrPool"),d=e("./game/manager/mgrCop"),p=e("./game/manager/mgrAlu"),h=e("./game/manager/mgrSound"),f=e("./game/manager/mgrWordFilter"),g=e("./game/manager/mgrGuide"),m=e("./game/manager/mgrAd"),v=e("./game/manager/mgrNative"),_=e("./game/manager/mgrSdk"),y=e("./game/manager/mgrAchievement"),C=e("./game/manager/mgrShop"),S=e("./game/manager/mgrSign"),b=e("./game/manager/mgrStage"),T=e("./game/manager/mgrCake"),R=e("./game/manager/mgrRank"),k=e("./game/manager/mgrRole");window.ul={},n.default.init(),r.default.init(),a.default.init(),u.default.init(),l.default.init(),f.default.init(),d.default.init(),p.default.init(),v.default.init(),g.default.init(),s.default.init(),i.default.init(),c.default.init(),C.default.init(),h.default.init(),_.default.init(),m.default.init(),b.default.init(),c.default.init(),R.default.init(),S.default.init(),y.default.init(),T.default.init(),k.default.init(),cc._RF.pop()},{"./game/manager/mgrAchievement":"mgrAchievement","./game/manager/mgrAd":"mgrAd","./game/manager/mgrAlu":"mgrAlu","./game/manager/mgrCake":"mgrCake","./game/manager/mgrCfg":"mgrCfg","./game/manager/mgrCop":"mgrCop","./game/manager/mgrDebug":"mgrDebug","./game/manager/mgrDirector":"mgrDirector","./game/manager/mgrGuide":"mgrGuide","./game/manager/mgrNative":"mgrNative","./game/manager/mgrNetwork":"mgrNetwork","./game/manager/mgrPlayer":"mgrPlayer","./game/manager/mgrPool":"mgrPool","./game/manager/mgrRank":"mgrRank","./game/manager/mgrRecord":"mgrRecord","./game/manager/mgrRole":"mgrRole","./game/manager/mgrSdk":"mgrSdk","./game/manager/mgrShop":"mgrShop","./game/manager/mgrSign":"mgrSign","./game/manager/mgrSound":"mgrSound","./game/manager/mgrStage":"mgrStage","./game/manager/mgrTip":"mgrTip","./game/manager/mgrWordFilter":"mgrWordFilter"}],main:[function(e,t,o){"use strict";cc._RF.push(t,"99ca5HYPuhJE6hdQAgv4xEb","main"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./game/view/scene/vLoadingScene"),a=cc._decorator,r=a.ccclass,i=a.property,s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.sceneRoot=null,t}return __extends(t,e),t.prototype.start=function(){(new n.default).parent=this.sceneRoot},__decorate([i({type:cc.Node})],t.prototype,"sceneRoot",void 0),t=__decorate([r],t)}(cc.Component);o.default=s,cc._RF.pop()},{"./game/view/scene/vLoadingScene":"vLoadingScene"}],mgrAchievement:[function(e,t,o){"use strict";cc._RF.push(t,"4ce5b3KZpVOT7mHCSwy/wjw","mgrAchievement"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("../struct/sAchievement"),r=e("../Const"),i=e("./mgrTip"),s=e("./mgrRecord"),c=e("../../ulframework/utils/Tools"),l=e("./mgrCfg"),u=e("./mgrPlayer"),d=e("../../ulframework/utils/Timer"),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this.loadRecord(),this.registerListeners({MSG_ACHIEVEMENT_STATE_CHANGED:this.onMsgAchievementStateChanged,MSG_ITEM_AMOUNT_CHANGED:this.onMsgItemAmountChanged,MSG_STAGE_RATING_CHAGNED:this.onMsgStageRatingChanged,MSG_PET_LEVEL_CHANGED:this.onMsgPetLevelChanged,MSG_PET_ADVENTURE_CHANGED:this.onMsgPetAdventureChanged,MSG_PET_COMBINE_LOG_CHANGED:this.onMsgPetCombineLogChanged,MSG_PVE_COUNT_CHANGED:this.onMsgPveCountChanged}),d.default.callLoop(.1,this.onTimerLoop.bind(this),!0)},t.loadRecord=function(){var t=this;e.loadRecord.call(this);var o=(s.default.getData("achievement")||{}).achievementDatas||{};l.default.forDb_from_achievement_db(function(e,n){var i=new a.default(n.id),s=o[n.id];s?i.setState(s.state):i.setState(r.AchievementState.unlocked),t.achievements[n.id]=i}),this.refreshAchievement(null,!0)},t.saveRecord=function(){e.saveRecord.call(this);var t={};c.default.forEachMap(this.achievements,function(e,o){t[o.id]={state:o.state}});var o={achievementDatas:t};s.default.setData("achievement",o)},t.onTimerLoop=function(e){this.tryRefreshAchievement()},t.refreshAchievement=function(e,t){var o=this,n=!1;c.default.forEachMap(this.achievements,function(a,r){var i=r.refreshState(e);n=n||i,i&&!t&&o.sendMsg("MSG_ACHIEVEMENT_STATE_CHANGED",{achievementId:r.id,state:r.state})}),n&&this.saveRecord()},t.obtainReward=function(e,t){var o=this.achievements[e];if(!o)return cc.warn(ul.format("mgrAchievement.obtainReward, achievement not found! aid = %s",e)),[null,null];if(o.state!=r.AchievementState.finished)return cc.warn(ul.format("mgrAchievement.obtainReward, achievement state id not finished! aid = %s",e)),[null,null];var n=o.template.rewardItemId,a=o.template.rewardAmount;return 0!=n&&u.default.addItemAmount(n,a,t),o.setState(r.AchievementState.received),this.saveRecord(),this.sendMsg("MSG_ACHIEVEMENT_STATE_CHANGED",{achievementId:o.id,state:o.state}),[n,a]},t.getAchievement=function(e){var t=this.achievements[e];return t||(cc.warn(ul.format("mgrAchievement.getAchievement achievement not found, aid = %s",e)),null)},t.getAchievementsByCategory=function(e){var t=[];return c.default.forEachMap(this.achievements,function(o,n){n.template.category==e&&t.push(n)}),t},t.tryRefreshAchievement=function(){var e=null;if(c.default.forEachMap(this.cmdQueue,function(t,o){e||(e=[]),e.push(t)}),e){this.cmdQueue={};for(var t=0;t<e.length;t++){var o=e[t];this.refreshAchievement(o)}}},t.isAchievementCompleted=function(e){if(!e)return!1;var t=this.getAchievement(e);if(!t)return!1;var o=t.state;return o==r.AchievementState.finished||o==r.AchievementState.received},t.isAchievementsAllCompleted=function(e){if(!e)return!1;for(var t=0;t<e.length;t++){var o=e[t];if(!this.isAchievementCompleted(o))return!1}return!0},t.getAchievementCanReceiveCount=function(e){var t=0;return c.default.forEachMap(this.achievements,function(o,n){n.template.category==e&&n.state==r.AchievementState.finished&&t++}),t},t.playAchievementTip=function(e){this.bAchievementTipEnabled&&i.default.showMsgTip(ul.format("\u6210\u5c31\u5b8c\u6210\uff1a%s",e.template.name))},t._setAchievementTipEnabled=function(e){this.bAchievementTipEnabled=e},t.getShowAchievementsByCategory=function(e){var t={};c.default.forEachMap(this.achievements,function(o,n){n.template.category==e&&(t[n.template.subCategory]||(t[n.template.subCategory]=[]),t[n.template.subCategory].push(n))});var o=[];return c.default.forEachMap(t,function(e,t){t=c.default.sortArrayByField(t,"id");for(var n=0;n<t.length;n++){var a=t[n];if(n<t.length-1){if(a.state<=r.AchievementState.finished){o.push(a);break}}else o.push(a)}}),o},t.getAchievementLevel=function(e){var o=t.getAchievement(e),n=o.template.category,a=o.template.subCategory,r=[];c.default.forEachMap(this.achievements,function(e,t){t.template.category==n&&t.template.subCategory==a&&r.push(t)}),r=c.default.sortArrayByField(r,"id");for(var i=0;i<r.length;i++){if(r[i].id==e)return[i+1,r.length]}return[1,1]},t.onMsgAchievementStateChanged=function(e){var t=e,o=t.achievementId;if(t.state==r.AchievementState.finished){var n=this.achievements[o];n.template.bNeedTip&&this.playAchievementTip(n)}this.cmdQueue.MSG_ACHIEVEMENT_STATE_CHANGED=!0},t.onMsgItemAmountChanged=function(e){this.cmdQueue.MSG_ITEM_AMOUNT_CHANGED=!0},t.onMsgStageRatingChanged=function(e){this.cmdQueue.MSG_STAGE_RATING_CHAGNED=!0},t.onMsgPetLevelChanged=function(e){this.cmdQueue.MSG_PET_LEVEL_CHANGED=!0},t.onMsgPetAdventureChanged=function(e){this.cmdQueue.MSG_PET_ADVENTURE_CHANGED=!0},t.onMsgPetCombineLogChanged=function(e){this.cmdQueue.MSG_PET_COMBINE_LOG_CHANGED=!0},t.onMsgPveCountChanged=function(e){this.cmdQueue.MSG_PVE_COUNT_CHANGED=!0},t.achievements={},t.cmdQueue={},t.bAchievementTipEnabled=!0,t}(n.default);o.default=p,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Timer":"Timer","../../ulframework/utils/Tools":"Tools","../Const":"Const","../struct/sAchievement":"sAchievement","./mgrCfg":"mgrCfg","./mgrPlayer":"mgrPlayer","./mgrRecord":"mgrRecord","./mgrTip":"mgrTip"}],mgrAd:[function(e,t,o){"use strict";cc._RF.push(t,"20276rxf1BCtI/uXv/IKIg9","mgrAd"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrRecord"),r=e("../../ulframework/utils/Tools"),i=e("./mgrCfg"),s=e("./mgrAlu"),c=e("./mgrSdk"),l=e("./mgrPlayer"),u=e("./mgrSound"),d=e("./mgrTip"),p=e("../../ulframework/utils/Timer"),h=e("./mgrDirector"),f=e("../Const"),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this.loadRecord(),this.registerListeners({MSG_ADV_SHOW_RESULT:this.onMsgAdvShowResult,MSG_ADV_CLOSE_RESULT:this.onMsgAdvCloseResult,MSG_ADV_INFO_RESULT:this.onMsgAdvInfoResult,MSG_LIFE_CYCLE:this.onMsgLifeCycle,MSG_AD_EVENT_SUCCESSD:this.onMsgAdEventSuccessd,MSG_ITEM_AMOUNT_CHANGED:this.onMsgItemAmountChanged})},t.loadRecord=function(){e.loadRecord.call(this);var t=a.default.getData("ad")||{};this.lastFinishedTimes=t.lastFinishedTimes||{}},t.saveRecord=function(){e.saveRecord.call(this);var t={lastFinishedTimes:this.lastFinishedTimes||{}};a.default.setData("ad",t)},t.isAdEventHasChanceTrigger=function(e){var t=i.default.get("ad_event_db",e);if(!t)return!1;if(!s.default.check(t.aluId))return!1;var o=t.ratio;return t.ratioFromCopKey&&(o=c.default.getCopNumberValueByKey(t.ratioFromCopKey)),!(o<=0)&&(!(t.wipeItemId>0&&l.default.getItemAmount(t.wipeItemId)>0)||(cc.log("  \u53bb\u5e7f\u544a\uff0c\u4e0d\u901a\u8fc7"),!1))},t.preCheckCanTriggerAdEvent=function(e){return this.getAdEventRemainCd(e)>0?(cc.log("  \u51b7\u5374\u65f6\u95f4\u672a\u5230\uff0c\u4e0d\u901a\u8fc7"),!1):this.preCheckCanTriggerAdEventWithoutCd(e)},t.preCheckCanTriggerAdEventWithoutCd=function(e){if(c.default.getCopAdMode()==f.AdMode.none)return!1;var t=i.default.get("ad_event_db",e);if(!t)return!1;if(cc.log("mgrAd.preCheckCanTriggerAdEvent",e,t),!this.isAdTypeValid(e))return cc.log("  \u5e7f\u544a\u6ca1\u6709\u6b21\u6570\u4e86 "),!1;if(!s.default.check(t.aluId))return cc.log("  alu\u4e0d\u901a\u8fc7\uff0c\u4e0d\u901a\u8fc7"),!1;var o=t.ratio;if(t.ratioFromCopKey&&(o=c.default.getCopNumberValueByKey(t.ratioFromCopKey),cc.log("  use cop ratio:",o)),cc.log("  \u89e6\u53d1\u51e0\u7387\uff1a",o),!(r.default.random(100)>o))return!(t.wipeItemId>0&&l.default.getItemAmount(t.wipeItemId)>0)||(cc.log("  \u53bb\u5e7f\u544a\uff0c\u4e0d\u901a\u8fc7"),!1);cc.log("  \u6982\u7387\u4e0d\u901a\u8fc7\uff0c\u4e0d\u901a\u8fc7")},t.triggerAdEvent=function(e,o,n){var a=i.default.get("ad_event_db",e);if(a)if(cc.log("mgrAd.\u89e6\u53d1\u5e7f\u544a\u4e8b\u4ef6",e,o,n),n||this.preCheckCanTriggerAdEvent(e))if(this.getAdEventRemainCd(e)>0)cc.log("  \u51b7\u5374\u65f6\u95f4\u672a\u5230\uff0c\u4e0d\u901a\u8fc7");else{var s={};if(r.default.forEachMap(a.param,function(e,t){s[e]=t}),o&&r.default.forEachMap(o,function(e,t){s[e]=t}),s.adEventId=e,s.advInfo=a.advInfo,s.serialNumber=this.AD_EVENT_SERIAL_NUMBER,this.AD_EVENT_SERIAL_NUMBER++,a.bPauseSound&&u.default.pauseSound(),this.lastTriggerAdEventId=e,this.lastTriggerAdEventParam=o,a.timeout>0&&(this.showWaiting(),this.startTimeoutTimer(a.timeout)),!(a.bCanReplaceToNativeInstitial&&this.preCheckCanTriggerAdEvent(t.NATIVE_INTERSITIAL_AD_EVENT_ID)&&this.tryShowNativeInstitial(e,s))){if(this.markFinished(e),cc.log("  \u5f00\u59cb\u5e7f\u544a",a.cmd,a.type),this.isIgnoreAd())this.sendMsg("MSG_ADV_SHOW_RESULT",{advData:{type:a.type,displayTime:a.displayTime>0&&a.displayTime||null,gravity:""!=a.gravity&&a.gravity||null,userData:JSON.stringify(s)},code:1}),this.sendMsg("MSG_ADV_CLOSE_RESULT",{type:a.type,displayTime:a.displayTime>0&&a.displayTime||null,gravity:""!=a.gravity&&a.gravity||null,userData:JSON.stringify(s),code:1});else{var l={cmd:a.cmd,data:{type:a.type,displayTime:a.displayTime>0&&a.displayTime||null,gravity:""!=a.gravity&&a.gravity||null,userData:JSON.stringify(s),advId:a.advId||"",nativeType:a.nativeType||null,code:a.code||null}};ul.dump(l),c.default.sendMsgToSdk(l)}a.statisticsSdkEvent&&a.statisticsSdkEvent.length>0&&c.default.statisCommonEvent(a.statisticsSdkEvent)}}else cc.log("    preCheckCanTriggerAdEvent \u4e0d\u901a\u8fc7")},t.retryLastTriggerAdEvent=function(){this.lastTriggerAdEventId?this.triggerAdEvent(this.lastTriggerAdEventId,this.lastTriggerAdEventParam,!0):cc.warn("mgrAd.retryLastTriggerAdEvent lastTriggerAdEventId not found!")},t.startTimeoutTimer=function(e){var t=this;this.stopTimeoutTimer(),this.timeoutTimer=new p.default(e,1,function(){t.stopTimeoutTimer(),t.showFaild()}),this.timeoutTimer.start()},t.stopTimeoutTimer=function(){this.timeoutTimer&&(this.timeoutTimer.stop(),this.timeoutTimer=null)},t.showWaiting=function(){},t.hideWaiting=function(){this.sendMsg("MSG_AD_CLOSE_WAITING")},t.showFaild=function(){},t.hideFaild=function(){this.sendMsg("MSG_AD_CLOSE_FAILD")},t.getNativeDataByAdEventId=function(e){var t=i.default.get("ad_event_db",e);return t?this.getNativeDataByNativeType(t.nativeType):null},t.getNativeDataByNativeType=function(e){return this.cacheNativeDatas[e]},t.tryRequestAllNativeData=function(e){var t=this,o={};i.default.forDb("ad_event_db",function(n,a){a.nativeType&&(!e&&o[a.nativeType]||(o[a.nativeType]=!0,t.tryRequestNativeData(a.id,e)))})},t.tryRequestNativeData=function(e,t){var o=this,n=i.default.get("ad_event_db",e);if(n&&this.isAdEventHasChanceTrigger(e)){var a=n.nativeType;if(!t)if(this.cacheNativeDatas[a])return;var s=this.lastRequestNativeDataTimes[a]||0,l=c.default.getCopNumberValueByKey("ad_native_close_request_cd");if(r.default.time()-s<=l)cc.warn("mgrAd:tryRequestNativeData \u8bf7\u6c42cd\u4e2d\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5");else{this.lastRequestNativeDataTimes[a]=r.default.time();var u={nativeType:a};if(this.cacheNativeDatas[a]=null,this.sendMsg("MSG_AD_NATIVE_DATA_REFRESH",{nativeType:a}),cc.sys.isNative){var d={cmd:"/adv/getAdvInfo",data:{type:n.type,userData:JSON.stringify(u),advId:n.advId||"",nativeType:a}};c.default.sendMsgToSdk(d)}else p.default.callLater(.1,function(){var e=r.default.random(10)-1,t={url:["http://www.ultralisk.cn/d/file/HotGames/2018-07-24/69328da45b23639618d79c124f8c0c3a.png","http://www.ultralisk.cn/d/file/HotGames/2018-05-09/7757d65d1a7103f00418059774993bf3.png","http://www.ultralisk.cn/d/file/HotGames/2018-04-18/765538bd4f97e0b100d026350746de59.png","http://www.ultralisk.cn/d/file/HotGames/2018-01-23/8fa7b4928924aaed8615ae7ded47d28e.png","http://www.ultralisk.cn/d/file/HotGames/2018-01-23/ad353a84a90d4d0139f42adefafe4b1e.png","http://www.ultralisk.cn/d/file/HotGames/2017-09-14/17ef0556ffd313cf58abb5f212945edd.png","http://www.ultralisk.cn/d/file/HotGames/2017-09-07/44b3c9d560729bd57c1f2f4f9c886745.png","http://www.ultralisk.cn/d/file/yeluoli/2017-05-08/9ba813e1d318382891ce4dbe7303c2fd.jpg","http://www.ultralisk.cn/d/file/FriendLink/2016-11-16/ce089ef6334447830d22d61d610bbdeb.png","http://www.ultralisk.cn/d/file/FriendLink/2016-09-19/269d373c9a2e89a73f17985431df3b19.png"][e],title:["\u6d4b\u8bd5","\u6d4b\u8bd5\u6807\u9898","\u6d4b\u8bd5\u6807\u9898\u6807\u9898","\u6d4b\u8bd5\u6807\u9898\u6807\u9898\u6807\u9898","\u6d4b\u8bd5\u6807\u9898\u6807\u9898\u6807\u9898\u6807\u9898","\u6d4b\u8bd5\u6807\u9898\u6807\u9898\u6807\u9898\u6807\u9898\u6807\u9898","\u6d4b\u8bd5\u6807\u9898\u6807\u9898\u6807\u9898\u6807\u9898\u6807\u9898\u6807\u9898","\u6d4b\u8bd5\u6807\u9898\u6807\u9898\u6807\u9898\u6807\u9898\u6807\u9898\u6807\u9898\u6807\u9898","\u6d4b\u8bd5\u6807\u989812412412412","\u6d4b\u8bd5\u6807\u9898\u6d4b\u8bd5\u6807\u9898\u6d4b\u8bd5\u6807\u9898\u6d4b\u8bd5\u6807\u9898"][e],desc:"\u6d4b\u8bd5\u5185\u5bb9\u6d4b\u8bd5\u5185\u5bb9\u6d4b\u8bd5\u5185\u5bb9\u6d4b\u8bd5\u5185\u5bb9\u6d4b\u8bd5\u5185\u5bb9"+e,targetTitle:"\u67e5\u770b\u8be6\u60c5"+e};o.sendMsg("MSG_ADV_INFO_RESULT",{cmd:"/adv/advInfoResult",code:"1",type:n.type,userData:JSON.stringify(u),nativeData:JSON.stringify(t)})})}}},t.tryShowNativeInstitial=function(e,o){return cc.log("mgrAd:tryShowNativeInstitial",e),this.getNativeDataByAdEventId(t.NATIVE_INTERSITIAL_AD_EVENT_ID)?(h.default.openDialog("vAdNativeDialog",{adEventId:t.NATIVE_INTERSITIAL_AD_EVENT_ID,originAdEventId:e,originUserData:o}),!0):(t.tryRequestNativeData(t.NATIVE_INTERSITIAL_AD_EVENT_ID),!1)},t.onNativeAdDisplayed=function(e){var t=i.default.get("ad_event_db",e);if(t&&0!=t.nativeType){cc.log("\u539f\u751f\u5e7f\u544a\u5c55\u793a\u6210\u529f",e);var o={cmd:t.cmd,data:{type:t.type,userData:{},nativeType:t.nativeType||1,code:1}};c.default.sendMsgToSdk(o)}},t.onReceiveSdkAvailableNativeTypes=function(e){this.availableNativeTypes=e;for(var t={},o=0;o<e.length;o++){var n=e[o];t[n]=!0}i.default.forDb("ad_event_db",function(e,o){o.nativeType&&!t[o.nativeType]&&(cc.log(ul.format("mgrAd overwrite nativeType. adEventId: %s, nativeType: %d->%d",o.id,o.nativeType,1)),o.nativeType=1)})},t.onMsgAdvShowResult=function(e){var t=e;console.info("mgrAd.onMsgAdvShowResult"),ul.dump(t,"data");var o=t.advData,n=JSON.parse(o.userData||"")||{},a=n.adEventId||0,r=i.default.get("ad_event_db",a);if(r){r.timeout>0&&(this.hideWaiting(),this.hideFaild(),this.stopTimeoutTimer());var s=parseInt(t.code);0==s?r.bPauseSound&&u.default.resumeSound():1==s?(r.bPauseSound&&u.default.resumeSound(),this.markFinished(a)):2==s&&r.bPauseSound&&u.default.resumeSound(),s==r.successCode&&this._doAdEventSuccessdLogic(a,n)}else cc.log("[warn] ul.mgrAd.onMsgAdvShowResult adEventId not found!")},t._doAdEventSuccessdLogic=function(e,t){var o=parseInt(t.serialNumber)||0;if(this.successedAdEventSerialNumbers[o])cc.warn(ul.format("mgrAd.onMsgAdvShowResult ad already do successd! adEventId=%s, serialNumber=%d",e,o));else{this.successedAdEventSerialNumbers[o]=!0;var n=i.default.get("ad_event_db",e),a=[],r=t.rewards||n.param.rewards;r&&r.forEach(function(e){var t=e[0],o=e[1],r=e[2],i=e[3],s=0;s=o?r?Math.random()*(r-o)+o:o:r,s=Math.floor(s),l.default.addItemAmount(t,s,n.statisticsSdkEvent),i||a.push({itemId:t,amount:s,amountSteps:[[s,0]],customerContext:{bBanAdReward:!0}})});var s=null!=t.rewardBoxId?t.rewardBoxId:n.param.rewardBoxId;if(s)l.default.openItemBox(s).forEach(function(e){var t=e[0],o=e[1];l.default.addItemAmount(t,o,n.statisticsSdkEvent),a.push({itemId:t,amount:o,amountSteps:[[o,0]],customerContext:{bBanAdReward:!0}})});a.length>0&&d.default.addGotItemTipGroup(a),this.sendMsg("MSG_AD_EVENT_SUCCESSD",{adEventId:e,userData:t})}},t.onMsgAdvCloseResult=function(e){var t=e;console.info("mgrAd.onMsgAdvCloseResult"),ul.dump(t,"data");var o=JSON.parse(t.userData||"")||{},n=o.adEventId||0;i.default.get("ad_event_db",n)?1==t.code&&this.sendMsg("MSG_AD_EVENT_CLOSED",{adEventId:n,userData:o}):cc.log("[warn] ul.mgrAd.onMsgAdvShowResult adEventId not found!")},t.onMsgAdvInfoResult=function(e){var o=this,n=e,a=JSON.parse(n.userData||"")||{},r=parseInt(a.nativeType);if(r){var i=JSON.parse(n.nativeData||"")||{};if(i.title||(i.title="\u5e7f\u544a\u6807\u9898"),i.desc||(i.desc="\u5e7f\u544a\u5185\u5bb9"),i.targetTitle||(i.targetTitle="\u67e5\u770b\u8be6\u60c5"),i.url)return this.downloadedImgFrame[i.url]?(cc.log("\u56fe\u7247\u8d44\u6e90\u5df2\u7f13\u5b58\uff0c\u76f4\u63a5\u4f7f\u7528"),i.frame=this.downloadedImgFrame[i.url],t.NATIVE_ID++,i.id=t.NATIVE_ID,this.cacheNativeDatas[r]=i,void this.sendMsg("MSG_AD_NATIVE_DATA_REFRESH",{nativeType:r})):void cc.loader.load({url:i.url,type:"png"},function(e,n){if(e)cc.error(" onMsgAdvInfoResult load err: ",e.message);else{var a=new cc.SpriteFrame(n);i.frame=a,o.downloadedImgFrame[i.url]=a,t.NATIVE_ID++,i.id=t.NATIVE_ID,o.cacheNativeDatas[r]=i,o.sendMsg("MSG_AD_NATIVE_DATA_REFRESH",{nativeType:r})}});cc.warn(" onMsgAdvInfoResult nativeData.url is null, url : ",i.url)}else cc.warn("mgrAd.onMsgAdvInfoResult nativeType not found!")},t.onMsgLifeCycle=function(e){},t.onMsgAdEventSuccessd=function(e){var t=e.adEventId,o=i.default.get("ad_event_db",t);o&&(o.remainCountItemId>0&&l.default.addItemAmount(o.remainCountItemId,-1,"\u5e7f\u544a\u64ad\u653e\u6b21\u6570"),0!=o.nativeType&&(this.lastRequestNativeDataTimes[o.nativeType]=null,this.tryRequestNativeData(t,!0)))},t.onMsgItemAmountChanged=function(e){var t=e.itemId;t==f.default.ITEM_ID_WIPE_AD&&l.default.getItemAmount(t)>0&&c.default.closeAdv("banner")},t.getRandomRewardId=function(){var e=this,t=[];if(i.default.forDb("ad_reward_db",function(o,n){e.getRewardRemainCount(n.id)>0&&t.push(n)}),t.length<=0)return null;var o=r.default.calcWheelTarget(t,"weight");return o?o.id:null},t.getRewardRemainCount=function(e){var t=i.default.get("ad_reward_db",e);return this.getAdEventRemainCount(t.adEventId)},t.getAdEventRemainCount=function(e){var t=i.default.get("ad_event_db",e);if(!t)return 0;if(t.aluId&&!s.default.check(t.aluId))return 0;var o=t.ratio;return t.ratioFromCopKey&&t.ratioFromCopKey.length>0&&(o=c.default.getCopNumberValueByKey(t.ratioFromCopKey)),o<=0?0:t.remainCountItemId>0?l.default.getItemAmount(t.remainCountItemId):1},t.getAdEventRemainCd=function(e){var t=i.default.get("ad_event_db",e);if(!t)return 0;if(this.isIgnoreAd()){if(t.cdIgnoreAd>0){var o=this.getLastFinishedTime(e)+t.cdIgnoreAd;return Math.max(0,o-r.default.time())}return 0}if(t.cd>0){o=this.getLastFinishedTime(e)+t.cd;return Math.max(0,o-r.default.time())}return 0},t.getLastFinishedTime=function(e){var t=i.default.get("ad_event_db",e);if(!t)return 0;var o=t.id;return t.cdGroup&&(o=t.cdGroup),this.lastFinishedTimes[o]||1},t.markFinished=function(e){var t=i.default.get("ad_event_db",e);if(t){var o=t.id;t.cdGroup&&(o=t.cdGroup),this.lastFinishedTimes[o]=r.default.time(),this.saveRecord()}},t.closeAdv=function(e){var t=i.default.get_from_ad_event_db(e);t&&c.default.closeAdv(t.type)},t.isAdTypeValid=function(e){var t=i.default.get_from_ad_event_db(e);if(!t)return!0;switch(t.type){case"video":return f.default.AD_VIDEO_VALID_COUNT>0}return!0},t.isIgnoreAd=function(){return l.default.getItemAmount(f.default.ITEM_ID_WIPE_AD)>0},t.lastFinishedTimes={},t.lastTriggerAdEventId=null,t.lastTriggerAdEventParam=null,t.lastRequestNativeDataTimes={},t.cacheNativeDatas={},t.NATIVE_ID=0,t.NATIVE_INTERSITIAL_AD_EVENT_ID="native_intersitial",t.AD_EVENT_SERIAL_NUMBER=0,t.availableNativeTypes=[],t.downloadedImgFrame={},t.successedAdEventSerialNumbers={},t}(n.default);o.default=g,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Timer":"Timer","../../ulframework/utils/Tools":"Tools","../Const":"Const","./mgrAlu":"mgrAlu","./mgrCfg":"mgrCfg","./mgrDirector":"mgrDirector","./mgrPlayer":"mgrPlayer","./mgrRecord":"mgrRecord","./mgrSdk":"mgrSdk","./mgrSound":"mgrSound","./mgrTip":"mgrTip"}],mgrAlu:[function(e,t,o){"use strict";cc._RF.push(t,"c63f19cgZJPEYIwxif9JNGD","mgrAlu"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("../../ulframework/utils/Tools"),r=e("./mgrCop"),i=e("./mgrCfg"),s=e("./mgrStage"),c={"==":function(e,t){return e==t},"!=":function(e,t){return e!=t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t}},l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this)},t.loadRecord=function(){e.loadRecord.call(this)},t.saveRecord=function(){e.saveRecord.call(this)},t.calcCheckData=function(){var e={payChannel:this.getCheckPayChannel(),platform:this.getCheckPlatform(),stageProgress:s.default.getStageProgress()||0};return a.default.forEachMap(r.default.getCops(),function(t,o){var n=parseFloat(o);e[t]=isNaN(n)?o:n}),e},t.getCheckPayChannel=function(){return"unknown"},t.getCheckPlatform=function(){return"unknown"},t.check=function(e){if(!e)return!0;var t=i.default.get("alu_db",e);if(!t)return!1;for(var o=!0,n=this.calcCheckData(),a=0;a<t.conditions.length;a++){var r=t.conditions[a],s=c[r.operator];if(s){var l=s(n[r.key],r.value);o=r.bLogicOr?o||l:o&&l}else cc.warn("mgrAlu.check unknown operator",r.operator)}return o},t.checkIds=function(e){for(var t=0;t<e.length;t++){var o=e[t];if(!this.check(o))return!1}return!0},t.OPERATOR_HANDLERS=c,t}(n.default);o.default=l,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Tools":"Tools","./mgrCfg":"mgrCfg","./mgrCop":"mgrCop","./mgrStage":"mgrStage"}],mgrCake:[function(e,t,o){"use strict";cc._RF.push(t,"6e84bodNFFPK4MP38f8UXsW","mgrCake"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrRecord"),r=e("./mgrCfg"),i=e("../../ulframework/utils/TaskManager"),s=e("./../../ulframework/utils/Tools"),c=e("./mgrPlayer"),l=e("./mgrTip"),u=cc._decorator.ccclass,d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this.loadRecord();var t=new i.default;t.push([this._processCakePartDb.bind(this)]),t.push([this._processCakeMaterialDb.bind(this)]),t.start(function(){cc.log("mgrCake \u6240\u6709\u4efb\u52a1\u6267\u884c\u5b8c\u6bd5")})},t.loadRecord=function(){e.loadRecord.call(this);a.default.getData("cake")},t.saveRecord=function(){e.saveRecord.call(this);a.default.setData("cake",{})},t._processCakePartDb=function(e){var t=r.default.getDb("item_template_db");r.default.forDb_from_cake_part_db(function(e,o){t[o.id]?cc.warn("\u90e8\u4ef6id\u4e0e\u7269\u54c1id\u51b2\u7a81: ",o.id):t[o.id]={id:o.id,name:o.name,icon:o.icon,flag:0}}),r.default.forDb_from_cake_part_db(function(e,t){1==t.bDefault&&c.default._setItemAmount(t.id,1)}),cc.loader.loadRes("cfg/cake/cake_editor_data.json",function(t,o){t?(cc.log(t),e()):(cc.log(o),r.default.forDb_from_cake_part_db(function(e,t){var n=o.json[t.id]||{};t.editorData=n}),e())})},t._processCakeMaterialDb=function(e){var t=this;r.default.forDb_from_cake_materail_db(function(e,o){null==t.materials[o.type]&&(t.materials[o.type]={}),null==t.materials[o.type][o.kindId]&&(t.materials[o.type][o.kindId]={}),t.materials[o.type][o.kindId][o.colorId]=o}),e()},t.getShapesByType=function(e){var t=this.materials[e],o=[];for(var n in t)if(t[n]){var a=parseInt(n);o.push(a)}return o},t.getShapeName=function(e,t){var o=this.materials[e][t];for(var n in o)return o[n].kindName},t.getColorsByTypeShapeType=function(e,t){var o=this.materials[e][t],n=[];for(var a in o)o[a]&&n.push(o[a]);return n},t.getRestByType_ShapeType_Color=function(e,t,o){var n=this.materials[e][t][o];return{resType:n.resType,resId:n.resId}},t.getPartsByType=function(e){var t=[];return r.default.forDb_from_cake_part_db(function(o,n){n.type==e&&t.push(n)}),t},t.getResByPartId=function(e,t){void 0===t&&(t=0);var o=r.default.get_from_cake_part_db(e),n={},a=o.editorData[t]||[];for(var i in a.length<=0&&(a=o.editorData[0]||[]),a){var s=a[i];s&&(n[s.zIndex]={resType:s.resType,resId:s.resId,pos:s.pos,scale:s.scale})}return n},t.saveEditorData=function(){cc.log("@@  saveEditorData");var e={};if(r.default.forDb_from_cake_part_db(function(t,o){e[o.id]=o.editorData}),cc.log(e),!cc.sys.isBrowser){var t=JSON.stringify(e);for(var o in e){var n=e[o],a=function(e){var t=n[e],o=function(e){var o=t[e],n=s.default.calcResourcesRawUrl(o.resId);if(!jsb.fileUtils.isFileExist(n))return l.default.alertPrompt2("\u63d0\u793a",ul.format("%s\u4e0d\u5b58\u5728,\u662f\u5426\u5220\u9664?",n),"\u662f","\u5426",function(){t.splice(parseInt(e),1)}),{value:void 0}};for(var a in t){var r=o(a);if("object"==typeof r)return r}};for(var i in n){var c=a(i);if("object"==typeof c)return c.value}}var u=s.default.calcResourcesRawUrl("resources/cfg/cake/cake_editor_data.json");cc.log("@@@ url:",u),jsb.fileUtils.writeStringToFile(t,u)}},t.calcScoreByPartIds=function(e){for(var t=0,o=0;o<e.length;o++){var n=e[o];t+=r.default.get_from_cake_part_db(n).score}return t},t.materials={},t=__decorate([u],t)}(n.default);o.default=d,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/TaskManager":"TaskManager","./../../ulframework/utils/Tools":"Tools","./mgrCfg":"mgrCfg","./mgrPlayer":"mgrPlayer","./mgrRecord":"mgrRecord","./mgrTip":"mgrTip"}],mgrCfg:[function(e,t,o){"use strict";cc._RF.push(t,"4efa6oODZxF+Ji7gcSaoIFq","mgrCfg"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/utils/CfgParser"),a=e("../../ulframework/manager/Manager"),r=e("../../ulframework/utils/Tools"),i=e("./mgrAlu"),s=[["achievement_db","m"],["achievement_target_db","m"],["ad_event_db","m"],["alu_db","m"],["anim_node_db","m"],["cake_part_db","m"],["cake_materail_db","m"],["cake_type_db","m"],["cop_db","m"],["cop_process_db","m"],["customer_db","m"],["guide_db","ma"],["item_template_db","m"],["item_recover_db","m"],["jump_other_game_db","m"],["particle_db","m"],["sign_db","ma"],["sound_db","m"],["spine_db","m"],["stage_db","m"],["stage_chapter_db","m"],["shop_template_db","m"],["random_name_part1_db","a"],["random_name_part2_db","a"]],c=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return __extends(o,t),o.onLoad=function(){t.onLoad.call(this),cc.log("mgrCfg.onLoad")},o.getLoadUrls=function(){for(var e=[],t=0;t<s.length;t++){var o=s[t][0];e.push("cfg/"+o)}return e},o.processDb=function(){for(var e=0;e<s.length;e++){var t=s[e],o=t[0],a=t[1],r="cfg/"+o,i=cc.loader.getRes(r);if(i){var c=n.default.parseCfgByJsonObj(o,i.json,a);c?this.allDbs[o]=c:cc.warn("\u8b66\u544a] \u914d\u7f6e\u8868\u52a0\u8f7d\u5931\u8d25\uff01",o)}else cc.error("mgrCfg processDb error, data is null, url:"+r)}this._combineItemTemplatedb(),this._processTextDb(),this._processAchievementDb(),this._processAluDb(),this._processStageDb()},o.getDb=function(e){var t=this.allDbs[e||""];return t||cc.warn("[\u8b66\u544a] mgrCfg.getDb db not found! dbName=["+e+"]"),t},o.getDbAndSortByField=function(e,t){var o=this.getDb(e);if(!o)return[];var n=[];return r.default.forEachMap(o,function(e,t){n.push(t)}),t="string"==typeof t?[t]:t,r.default.sortArrayByField(n,t)},o.get=function(e,t,o,n,a){void 0===o&&(o=null),void 0===n&&(n=null),void 0===a&&(a=!1);var r=this.getDb(e);if(!r)return null;var i=r[t];return null==i?(a||cc.warn("[\u8b66\u544a] mgrCfg.get ["+e+".csv]\u4e2d\u6570\u636e\u672a\u627e\u5230, key1=["+t+"]"),i):null!=o&&null==(i=i[o])?(a||cc.warn("[\u8b66\u544a] mgrCfg.get ["+e+".csv]\u4e2d\u6570\u636e\u672a\u627e\u5230, key1=["+t+"], key2=["+o+"]"),i):null!=n&&null==(i=i[n])?(a||cc.warn("[\u8b66\u544a] mgrCfg.get ["+e+".csv]\u4e2d\u6570\u636e\u672a\u627e\u5230, key1=["+t+"], key2=["+o+"], key3=["+n+"]"),i):i},o.quietGet=function(e,t,o,n){return void 0===o&&(o=null),void 0===n&&(n=null),this.get(e,t,o,n,!0)},o.forDb=function(e,t){var o=this.getDb(e);o&&r.default.forEachMap(o,t)},o._processStageDb=function(){this.forDb_from_stage_db(function(t,o){var n=null;if(o.scriptName&&""!=o.scriptName&&(n=e(o.scriptName)),n){var a=new(0,n.default)({stageId:o.id});o.script=a}else cc.warn("\u52a0\u8f7d\u5173\u5361\u811a\u672c\u51fa\u9519: ",o.scriptName)})},o._combineItemTemplatedb=function(){},o._processTextDb=function(){this.allDbs.badword_db=[]},o._processAchievementDb=function(){r.default.forEachMap(this.getDb("achievement_target_db"),function(e,t){for(var o={},n=0;n<t.cmds.length;n++){o[t.cmds[n]]=!0}t.cmdHash=o})},o._processAluDb=function(){for(var e=[],t=[],o=[],n=[],a=1;a<=5;a++)e.push("logic_or_"+a),t.push("key_"+a),o.push("operator_"+a),n.push("value_"+a);i.default.calcCheckData();var r=i.default.OPERATOR_HANDLERS,s={};this.forDb("alu_db",function(a,i){var c=[],l={id:i.id,name:i.name,conditions:c};s[i.id]=l;for(var u=0;u<5;u++){var d=1==i[e[u]],p=i[t[u]],h=i[o[u]],f=i[n[u]];if(p)if(null==r[h])cc.warn(ul.format("\u903b\u8f91\u8fd0\u7b97\u7b26\u914d\u7f6e\u3010alu_db\u3011\u4e2d sysmbol\u672a\u627e\u5230\uff1a%s",h));else{var g=parseFloat(f),m={bLogicOr:d,key:p,operator:h,value:f=isNaN(g)?f:g};c.push(m)}}}),this.allDbs.alu_db=s},o.get_from_alu_db=function(e,t,o){return this.get("alu_db",e,t,o)},o.forDb_from_alu_db=function(e){this.forDb("alu_db",e)},o.get_from_cop_db=function(e,t,o){return this.get("cop_db",e,t,o)},o.forDb_from_cop_db=function(e){this.forDb("cop_db",e)},o.get_from_cop_process_db=function(e,t,o){return this.get("cop_process_db",e,t,o)},o.forDb_from_cop_process_db=function(e){this.forDb("cop_process_db",e)},o.get_from_achievement_db=function(e,t,o){return this.get("achievement_db",e,t,o)},o.forDb_from_achievement_db=function(e){this.forDb("achievement_db",e)},o.get_from_achievement_target_db=function(e,t,o){return this.get("achievement_target_db",e,t,o)},o.forDb_from_achievement_target_db=function(e){this.forDb("achievement_target_db",e)},o.get_from_spine_db=function(e,t,o){return this.get("spine_db",e,t,o)},o.forDb_from_spine_db=function(e){this.forDb("spine_db",e)},o.get_from_anim_node_db=function(e,t,o){return this.get("anim_node_db",e,t,o)},o.forDb_from_anim_node_db=function(e){this.forDb("anim_node_db",e)},o.get_from_particle_db=function(e,t,o){return this.get("particle_db",e,t,o)},o.forDb_from_particle_db=function(e){this.forDb("particle_db",e)},o.get_from_stage_db=function(e,t,o){return this.get("stage_db",e,t,o)},o.forDb_from_stage_db=function(e){this.forDb("stage_db",e)},o.get_from_ad_event_db=function(e,t,o){return this.get("ad_event_db",e,t,o)},o.forDb_from_ad_event_db=function(e){this.forDb("ad_event_db",e)},o.get_from_sign_db=function(e,t,o){return this.get("sign_db",e,t,o)},o.forDb_from_sign_db=function(e){this.forDb("sign_db",e)},o.get_from_item_template_db=function(e,t,o){return this.get("item_template_db",e,t,o)},o.forDb_from_item_template_db=function(e){this.forDb("item_template_db",e)},o.get_from_item_recover_db=function(e,t,o){return this.get("item_recover_db",e,t,o)},o.forDb_from_item_recover_db=function(e){this.forDb("item_recover_db",e)},o.get_from_guide_db=function(e,t,o){return this.get("guide_db",e,t,o)},o.forDb_from_guide_db=function(e){this.forDb("guide_db",e)},o.get_from_sound_db=function(e,t,o){return this.get("sound_db",e,t,o)},o.forDb_from_sound_db=function(e){this.forDb("sound_db",e)},o.get_from_armor_db=function(e,t,o){return this.get("armor_db",e,t,o)},o.forDb_from_armor_db=function(e){this.forDb("armor_db",e)},o.get_from_gun_db=function(e,t,o){return this.get("gun_db",e,t,o)},o.forDb_from_gun_db=function(e){this.forDb("gun_db",e)},o.get_from_gun_detail_db=function(e,t,o){return this.get("gun_detail_db",e,t,o)},o.forDb_from_gun_detail_db=function(e){this.forDb("gun_detail_db",e)},o.get_from_bullet_db=function(e,t,o){return this.get("bullet_db",e,t,o)},o.forDb_from_bullet_db=function(e){this.forDb("bullet_db",e)},o.get_from_enemy_db=function(e,t,o){return this.get("enemy_db",e,t,o)},o.forDb_from_enemy_db=function(e){this.forDb("enemy_db",e)},o.get_from_jump_other_game_db=function(e,t,o){return this.get("jump_other_game_db",e,t,o)},o.forDb_from_jump_other_game_db=function(e){this.forDb("jump_other_game_db",e)},o.get_from_stage_chapter_db=function(e,t,o){return this.get("stage_chapter_db",e,t,o)},o.forDb_from_stage_chapter_db=function(e){this.forDb("stage_chapter_db",e)},o.get_from_shop_template_db=function(e,t,o){return this.get("shop_template_db",e,t,o)},o.forDb_from_shop_template_db=function(e){this.forDb("shop_template_db",e)},o.get_from_cake_part_db=function(e,t,o){return this.get("cake_part_db",e,t,o)},o.forDb_from_cake_part_db=function(e){this.forDb("cake_part_db",e)},o.get_from_cake_materail_db=function(e,t,o){return this.get("cake_materail_db",e,t,o)},o.forDb_from_cake_materail_db=function(e){this.forDb("cake_materail_db",e)},o.get_from_cake_type_db=function(e,t,o){return this.get("cake_type_db",e,t,o)},o.forDb_from_cake_type_db=function(e){this.forDb("cake_type_db",e)},o.get_from_customer_db=function(e,t,o){return this.get("customer_db",e,t,o)},o.forDb_from_customer_db=function(e){this.forDb("customer_db",e)},o.allDbs={},o.dbRules={},o}(a.default);o.default=c,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/CfgParser":"CfgParser","../../ulframework/utils/Tools":"Tools","./mgrAlu":"mgrAlu"}],mgrCop:[function(e,t,o){"use strict";cc._RF.push(t,"b7f11LUJONC1ZkDAiQLLAgk","mgrCop"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrCfg"),r=e("../../ulframework/utils/Tools"),i=cc._decorator.ccclass,s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this.loadLocalCop(),cc.log("mgrCop.onLoad")},t.loadRecord=function(){e.loadRecord.call(this)},t.saveRecord=function(){e.saveRecord.call(this)},t.loadLocalCop=function(){var e={};a.default.forDb("cop_db",function(t,o){e[t]=o.defaultValue}),this.processCop(e),this.localCop=e,cc.log("localCop:",e)},t.processCop=function(e){cc.log("mgrCop.processCop"),a.default.forDb("cop_process_db",function(t,o){var n=e[t];if(null!=n){var a=n.split(o.splitChar)||[];cc.log("  process",t,a);for(var r=0;r<o.outputFieldNames.length;r++){var i=o.outputFieldNames[r],s=a[r];null==s?cc.warn(ul.format("mgrCop.processCop fieldValue not found! index = %d, fieldName = %s",r,i)):(cc.log("  set",i,s),e[i]=s)}}})},t.get=function(e){var t=this.remoteCop[e];return null!=t?t:this.localCop[e]},t.getNumberValue=function(e){var t=this.get(e);if(null==t)return 0;var o=parseFloat(t);return isNaN(o)?0:o},t.getBooleanValue=function(e){var t=this.get(e);return null!=t&&("1"==(t=t.toLowerCase())||"true"==t)},t.getCops=function(){var e={};return r.default.forEachMap(this.localCop,function(t,o){e[t]=o}),r.default.forEachMap(this.remoteCop,function(t,o){e[t]=o}),e},t.setRemoteValue=function(e,t){null!=e?(this.remoteCop[e]=t,this.processCop(this.remoteCop)):cc.warn("mgrCop.setRemoteValue key not found!")},t.onReceiveSdkCop=function(e){cc.log("mgrCop.onReceiveSdkCop"),this.remoteCop=JSON.parse(e||"")||{},this.processCop(this.remoteCop)},t.localCop={},t.remoteCop={},t.sdkCop={},t=__decorate([i],t)}(n.default);o.default=s,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Tools":"Tools","./mgrCfg":"mgrCfg"}],mgrDebug:[function(e,t,o){"use strict";cc._RF.push(t,"94b92qCPm9LRpz8RaZNPuEq","mgrDebug"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrCop"),r=e("./mgrDirector"),i=e("./mgrTip"),s=e("./mgrGuide"),c=e("./mgrPlayer"),l=e("../Const"),u=e("./mgrCake"),d=cc._decorator.ccclass,p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this.registerKeyboardListener(),this.registerListeners({MSG_NETWORK_RESPONSE:this.onMsgNetworkResponse})},t.loadRecord=function(){e.loadRecord.call(this)},t.saveRecord=function(){e.saveRecord.call(this)},t.onKeyDown=function(e){switch(e){case"a":c.default._items[l.default.ITEM_ID_GOLD]=0;break;case"b":c.default.addItemAmount(l.default.ITEM_ID_GOLD,500,"\u6d4b\u8bd5");break;case"ctrl_b":c.default.addItemAmount(l.default.ITEM_ID_GOLD,5e4,"\u6d4b\u8bd5");break;case"c":cc.log("cops",a.default.getCops());break;case"d":case"e":case"f":case"g":break;case"ctrl_g":s.default._debugCancelDebug();break;case"h":case"i":case"j":case"k":case"l":break;case"m":this.bUnlockAllStage=!0,i.default.showMsgTip("\u6240\u6709\u5173\u5361\u5df2\u89e3\u9501");break;case"n":case"o":case"p":case"q":case"r":case"s":break;case"ctrl_s":u.default.saveEditorData(),i.default.showMsgTip("\u5b58\u50a8\u90e8\u4ef6\u7f16\u8f91\u6570\u636e\u6210\u529f");break;case"t":r.default.enterScene("vDevTestScene")}this.sendMsg("MSG_DEBUG_KEY_DOWN",{keyDesc:e})},t.registerKeyboardListener=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onSystemKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onSystemKeyUp,this)},t.onSystemKeyDown=function(e){var t=e.keyCode;switch(t){case cc.macro.KEY.alt:this.bPressedAlt=!0;break;case cc.macro.KEY.ctrl:this.bPressedCtrl=!0;break;case cc.macro.KEY.shift:this.bPressedShift=!0;break;default:var o=this._genKeyDesc(t);this.onKeyDown(o)}},t.onSystemKeyUp=function(e){switch(e.keyCode){case cc.macro.KEY.alt:this.bPressedAlt=!1;break;case cc.macro.KEY.ctrl:this.bPressedCtrl=!1;break;case cc.macro.KEY.shift:this.bPressedShift=!1}},t._genKeyDesc=function(e){var t="";this.bPressedCtrl&&(t+="ctrl_"),this.bPressedAlt&&(t+="alt_"),this.bPressedShift&&(t+="shift_");for(var o in cc.macro.KEY){if(cc.macro.KEY[o]==e.toString()){t+=o;break}}return t},t.onMsgNetworkResponse=function(e){var t=e;cc.log("onMsgNetworkResponse",t)},t.bPressedCtrl=!1,t.bPressedAlt=!1,t.bPressedShift=!1,t.bUnlockAllStage=!1,t=__decorate([d],t)}(n.default);o.default=p,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../Const":"Const","./mgrCake":"mgrCake","./mgrCop":"mgrCop","./mgrDirector":"mgrDirector","./mgrGuide":"mgrGuide","./mgrPlayer":"mgrPlayer","./mgrTip":"mgrTip"}],mgrDirector:[function(e,t,o){"use strict";cc._RF.push(t,"0aa037Qgl5NHKS0i0g0xTPb","mgrDirector"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("../../ulframework/view/DialogBase"),r=e("../Const"),i=e("../../ulframework/utils/Tools"),s=e("../view/node/vWarpSceneNode"),c=cc._decorator.ccclass,l=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return __extends(o,t),o.onLoad=function(){t.onLoad.call(this),cc.view.setResizeCallback(this.onViewResize.bind(this)),cc.log("mgrDirector.onLoad")},o.loadNode=function(e,t){var o="view/"+e;this.loadRes(o,cc.Prefab,function(e,o){if(e)return cc.warn("\u8b66\u544a] mgrDirector.loadNode load prefab:",e),void t(null);var n=cc.instantiate(o);t(n)})},o.createView=function(t,o){var n=e(t);if(n){var a=n.default;(o=o||{}).__viewName=t;var r=new a(o);return r.name=t,r}cc.warn("mgrDirector.createView module not found!",t)},o.enterScene=function(e,t){var o=this.getSceneRoot();t&&t.resolutionRange&&(o._resolution_range=t.resolutionRange),this.refreshSceneSize();for(var n=0;n<o.children.length;n++){o.children[n].destroy()}var r=this.getUIRoot();for(n=0;n<r.children.length;n++){r.children[n].destroy()}a.default.clearViews(),this.createView(e,t).parent=o},o.warpSceneWithEffect=function(e,t,o){var n=this;this.getMask().active=!0;var a=this.getWarpSceneNode();a.context={fOnFadeInCompleted:function(){n.enterScene(e,t),a.playEffectOut()},fOnFadeOutCompleted:function(){n.getMask().active=!1,o instanceof Function&&o()}},a.playEffectIn()},o.refreshSceneSize=function(){var e=this.getSceneRoot()._resolution_range||r.default.RESOLUTION_RANGE,t=this.getCanvas(),o=cc.view.getFrameSize(),n=o.width/o.height,a=e.maxWidth,i=e.minWidth,s=e.maxHeight,c=e.minHeight,l=i,u=c,d=t.getComponent(cc.Canvas);n<=i/c?n<i/s?(l=i,u=s,t.setContentSize(l,u),d.designResolution=cc.size(l,u),d.fitHeight=!0,d.fitWidth=!0):(d.designResolution=cc.size(l,u),d.fitHeight=!1,d.fitWidth=!0):n>a/c?(l=a,u=c,t.setContentSize(l,u),d.designResolution=cc.size(l,u),d.fitHeight=!0,d.fitWidth=!0):(d.fitHeight=!0,d.fitWidth=!1,d.designResolution=cc.size(l,u))},o.onViewResize=function(){this.refreshSceneSize(),this.sendMsg("MSG_VIEW_RESIZE")},o.openDialog=function(e,t,o){if(cc.log("openDialog begin ",a.default.CUR_VIEWS),!a.default.CUR_VIEWS[e]){var n=this.createView(e,t);return n instanceof a.default?(n.openDialog(o),n):(cc.warn("mgrDirecotr.openDialog view not a dialog!",e),cc.isValid(n)&&n.destroy(),null)}cc.warn("dialog "+e+" have already create")},Object.defineProperty(o,"size",{get:function(){return cc.director.getScene().getChildByName("Canvas").getContentSize()},enumerable:!0,configurable:!0}),Object.defineProperty(o,"width",{get:function(){return this.size.width},enumerable:!0,configurable:!0}),Object.defineProperty(o,"height",{get:function(){return this.size.height},enumerable:!0,configurable:!0}),Object.defineProperty(o,"center",{get:function(){var e=this.size;return cc.v2(e.width/2,e.height/2)},enumerable:!0,configurable:!0}),o.getCanvas=function(){return cc.director.getScene().getChildByName("Canvas")},o.getRoot=function(){return this.getCanvas().getChildByName("root")},o.getSceneRoot=function(){return this.getRoot().getChildByName("sceneRoot")},o.getUIRoot=function(){return this.getRoot().getChildByName("UIRoot")},o.getAudioRoot=function(){return this.getRoot().getChildByName("AudioRoot")},o.getSharingMusicAudioResource=function(){return this.getAudioRoot().getChildByName("music").getComponent(cc.AudioSource)},o.getSharingEffectAudioResource=function(){return this.getAudioRoot().getChildByName("effect").getComponent(cc.AudioSource)},o.getWarpSceneNode=function(){var e=this.getRoot(),t=e.getChildByName("__warpSceneNode");return t||((t=new s.default).parent=e,t.name="__warpSceneNode",t.zIndex=r.default.GLOBAL_ORDER_WARP_SCENE_NODE),t},o.getMask=function(){var e=this.getRoot(),t=e.getChildByName("__mask");return t||((t=new cc.Node).parent=e,t.zIndex=r.default.GLOBAL_ORDER_MASK,t.name="__mask",t.setContentSize(this.size),i.default.registerTouchHandler(t,function(){cc.log("-- touch mask --")}),t.active=!1),t},o.isDeviceOverHeight=function(){var e=cc.view.getFrameSize();return e.width/e.height<.5},o.createSpriteNode=function(e){var t=new cc.Node;return t.addComponent(cc.Sprite).loadSpriteFrame(e),t},o.tryGetRes=function(e,t){return cc.loader.getRes(e,t)},o.loadRes=function(e,t,o){var n=cc.loader.getRes(e,t);if(null==n){var a=t;cc.loader.loadRes(e,a,o)}else o(null,n)},o.loadResourceNode=function(e,t){var o,n;e instanceof Array?(o=e[0],n=e[1]):(o=e,n=t);var a=new cc.Node;if(null==o||!n)return cc.warn("mgrDirector.loadResourceNode faild! resType=[%s], resId=[%s].",o,n),a;if(o==r.ResourceType.sprite){var i=this.createSpriteNode(n);i.parent=a,a.nodeSprite=i}return a.__resType=o,a},o.destoryResourceNode=function(){},o=__decorate([c],o)}(n.default);o.default=l,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Tools":"Tools","../../ulframework/view/DialogBase":"DialogBase","../Const":"Const","../view/node/vWarpSceneNode":"vWarpSceneNode"}],mgrGuide:[function(e,t,o){"use strict";cc._RF.push(t,"34ba4z71MpL9rGp2+Hmp1Rj","mgrGuide"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrRecord"),r=e("../../ulframework/utils/Tools"),i=e("./mgrCfg"),s=e("../view/node/vGuideView"),c=e("./mgrDirector"),l=e("./mgrTip"),u=e("../Const"),d=e("./mgrSound"),p=cc._decorator,h=p.ccclass,f=(p.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this.loadRecord(),this.registerListeners({MSG_GUIDE_POINT:this.onMsgGuidePoint.bind(this),MSG_PLAY_SOUND603:this.onMsgPlaySound603.bind(this),MSG_PLAY_SOUND604:this.onMsgPlaySound604.bind(this),MSG_PLAY_SOUND605:this.onMsgPlaySound605.bind(this)})},t.loadRecord=function(){e.loadRecord.call(this);for(var t=(a.default.getData("guide")||{}).completedGuideIds||[],o={},n=0;n<t.length;n++)o[t[n]]=!0;this.completedGuideIds=o,this.refreshAvailableGuideIds()},t.saveRecord=function(){e.saveRecord.call(this);var t=[];r.default.forEachMap(this.completedGuideIds,function(e,o){1==o&&t.push(parseInt(e))});var o={completedGuideIds:t};a.default.setData("guide",o)},t.refreshAvailableGuideIds=function(){var e=this,t=[];i.default.forDb("guide_db",function(o,n){var a=parseInt(o);e.completedGuideIds[a]||t.push(a)}),t.sort(),this.availableGuideIds=t,cc.log("refreshAvailableGuideIds",t)},t.registerGuideNode=function(e,t){if(!this.registeredNodes[e]||this.registeredNodes[e]!=t)if(cc.isValid(t)){if(this.registeredNodes[e]&&this.unregisterGuideNode(e),this.registeredNodes[e]=t,this.sendMsg("MSG_GUIDE_POINT",{id:ul.format("%s.register",e)}),null!=this.reactiveGuideId&&null!=this.reactiveGuideStep&&0==this.bStart){var o=i.default.get("guide_db",this.reactiveGuideId,this.reactiveGuideStep);if(this.getGuideNodes(o.nodeNames).length<=0&&o.nodeNames.length>0)return;this.startGuide(this.reactiveGuideId,this.reactiveGuideStep),this.reactiveGuideId=null,this.reactiveGuideStep=null}}else cc.warn(ul.format("mgrGuide.registerGuideNode node is invalid! name = %s.",e))},t.unregisterGuideNode=function(e){var t=this.registeredNodes[e];if(t){var o=t.__guide_trigger_node;cc.isValid(o)&&(o.removeComponent(cc.Component),o.destroy(),t.__guide_trigger_node=null),this.onGuideNodeUnregister(e),this.sendMsg("MSG_GUIDE_POINT",{id:ul.format("%s.unregister",e)}),this.registeredNodes[e]=null}},t.getGuideNode=function(e){var t=this.registeredNodes[e];return cc.isValid(t)?t:null},t.getGuideNodes=function(e){var t=[];if(!e)return t;for(var o=0;o<e.length;o++){var n=e[o],a=this.getGuideNode(n);a&&t.push(a)}return t},t.isGuiding=function(){return cc.isValid(this.guideView)||null!=this.activeGuideId},t.cancelGuide=function(){cc.log(" \u53d6\u6d88\u5f15\u5bfc",this.activeGuideId,this.activeGuideStep);var e=this.activeGuideId,t=this.activeGuideStep;this.activeGuideId=null,this.activeGuideStep=null,this.bStart=!1,cc.isValid(this.guideView)&&(this.guideView.hideAndRemove(),this.guideView=null);var o=i.default.quietGet("guide_db",e,t);if(o&&o.endMsg.length>=1){var n=o.endMsg,a=n[0],r=n[1];cc.log("-----sendmg",a,r),this.sendMsg(a,r)}},t.startGuide=function(e,t){cc.log("\u5f00\u59cb\u5f15\u5bfc",e,t),this.activeGuideId=e,this.activeGuideStep=t,this.bStart=!0;var o=i.default.get("guide_db",e,t);if(o){var n=this.getGuideNodes(o.nodeNames),a=null,r=u.default.GLOBAL_ORDER_DIALOG;if(!(a=this._searchParentFromCanvas(n[0])))a=cc.director.getScene().getChildByName("Canvas");a.convertToNodeSpace(cc.v2(c.default.width/2,c.default.height/2));0;var l=new s.default({guideId:e,step:t});if(l.parent=a,l.zIndex=r,l.show(),this.guideView=l,o.startMsg.length>=1){var d=o.startMsg,p=d[0],h=d[1];this.sendMsg(p,h)}}},t._searchParentFromCanvas=function(e){if(!cc.isValid(e))return null;for(var t=cc.director.getScene().getChildByName("Canvas"),o=e.parent;o;){if(o==t)return e;o=(e=o).parent}return null},t.completeGuide=function(e,t){var o=i.default.get("guide_db",e);if(o)if(t>=o.length-1)o[0].bRepeat||(this.completedGuideIds[e]=!0,this.saveRecord(),this.refreshAvailableGuideIds()),this.cancelGuide();else{this.cancelGuide(),this.activeGuideId=e,this.activeGuideStep=t+1,this.bStart=!1;var n=i.default.get("guide_db",this.activeGuideId,this.activeGuideStep);if(n.startTrigger.length<=0){if(this.getGuideNodes(n.nodeNames).length<=0&&n.nodeNames.length>0){0;var a=this.activeGuideId,r=this.activeGuideStep;return this.cancelGuide(),this.reactiveGuideId=a,void(this.reactiveGuideStep=r)}this.startGuide(this.activeGuideId,this.activeGuideStep)}}else this.cancelGuide()},t.onGuidePoint=function(e,t){this.bDebugCloseGuide||(null!=this.activeGuideId&&null!=this.activeGuideStep&&this._tryStopGuide(e,t),null!=this.activeGuideId&&null!=this.activeGuideStep||this._tryStartGuide(e,t))},t._tryStartGuide=function(e,t){for(var o=0;o<this.availableGuideIds.length;o++)for(var n=this.availableGuideIds[o],a=i.default.get("guide_db",n),r=0;r<a.length;r++){var s=a[r];if(s.bStartStep&&this._checkGuideCanStart(s,e,t))return void this.startGuide(s.id,s.step);s.startTrigger&&""!=s.startTrigger&&e==s.startTrigger[0][0]&&(this.reactiveGuideId=s.id,this.reactiveGuideStep=s.step)}},t._tryStopGuide=function(e,t){var o=i.default.get("guide_db",this.activeGuideId,this.activeGuideStep);if(this.bStart){if(this._checkTrigger(o.cancelTrigger,e,t))return void this.cancelGuide();if(this._checkTrigger(o.completeTrigger,e,t)){if(this.completeGuide(this.activeGuideId,this.activeGuideStep),this.activeGuideId&&this.activeGuideStep&&!this.bStart){0;var n=i.default.get("guide_db",this.activeGuideId,this.activeGuideStep);if(this._checkGuideCanStart(n,e,t))return void this.startGuide(n.id,n.step)}return}}else if(this._checkGuideCanStart(o,e,t))return void this.startGuide(o.id,o.step)},t._checkTrigger=function(e,t,o){for(var n=function(n){var a=e[n],i=a[0],s=a[1];if(i==t){var c=!0;if(s&&Object.keys(s).length>0&&r.default.forEachMap(s,function(e,t){if(o[e]!=t)return c=!1,!0}),c)return{value:!0}}},a=0;a<e.length;a++){var i=n(a);if("object"==typeof i)return i.value}return!1},t._checkGuideCanStart=function(e,t,o){if(!this._checkTrigger(e.startTrigger,t,o))return!1;if(e.nodeNames.length>0&&this.getGuideNodes(e.nodeNames).length<=0)return!1;return!0},t._debugCancelDebug=function(){this.bDebugCloseGuide=!0,this.cancelGuide(),l.default.showMsgTip("\u53d6\u6d88\u65b0\u624b\u5f15\u5bfc")},t.onGuideNodeUnregister=function(e){var t=this.activeGuideId,o=this.activeGuideStep;if(null!=t&&null!=o)for(var n=i.default.get("guide_db",t,o),a=0;a<n.nodeNames.length;a++){if(n.nodeNames[a]==e)return cc.warn("mgrGuide.onGuideNodeUnregister active guild's node unregister! cancel it!",t,o,e),void this.cancelGuide()}},t.onMsgGuidePoint=function(e){var t=e,o=t.id;this.onGuidePoint(o,t)},t.getbDebugCloseGuide=function(){return this.bDebugCloseGuide},t.onMsgPlaySound603=function(){d.default.play(603)},t.onMsgPlaySound604=function(){d.default.play(604)},t.onMsgPlaySound605=function(){d.default.play(605)},t.registeredNodes={},t.bStart=!1,t.bDebugCloseGuide=!1,t.completedGuideIds={},t.availableGuideIds=[],t=__decorate([h],t)}(n.default));o.default=f,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Tools":"Tools","../Const":"Const","../view/node/vGuideView":"vGuideView","./mgrCfg":"mgrCfg","./mgrDirector":"mgrDirector","./mgrRecord":"mgrRecord","./mgrSound":"mgrSound","./mgrTip":"mgrTip"}],mgrNative:[function(e,t,o){"use strict";cc._RF.push(t,"7b44bW+OKBEzaO/DYUMTOrS","mgrNative"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("../../ulframework/utils/Timer"),r=e("../../ulframework/utils/Base64"),i=e("../../Lib/ULNativeController");function s(e){console.info("on JAVACALLBACK",e);try{var t=r.default.decode(e);u._onNativeCallbackJava(t)}catch(t){cc.warn("JAVACALLBACK decode base64 faild! direct use base64JsonStr"),u._onNativeCallbackJava(e)}}function c(e){console.info("on OCCALLBACK",e);try{var t=r.default.decode(e);u._onNativeCallbackObjc(t)}catch(t){cc.warn("OCCALLBACK decode base64 faild! direct use base64JsonStr"),u._onNativeCallbackObjc(e)}}var l=cc._decorator.ccclass,u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),console.info("mgrNative.onLoad"),window.JAVACALLBACK=s,window.OCCALLBACK=c,this.nativeCallbackPending=[],this.bRegisterNativeCallback||(this.bRegisterNativeCallback=!0,this.registerNativeCallback()),a.default.callLoop(1/60,this.onTimer.bind(this),!0)},t.onTimer=function(){var e=this.nativeCallbackPending;for(e.length>0&&console.info("mgrNative.onTimer",e.length);e.length>0;){var t=e.shift();console.info("ready send MSG_NATIVE_CALLBACK"),this.sendMsg("MSG_NATIVE_CALLBACK",{responseData:t})}},t.registerNativeCallback=function(){this._registerNativeCallbackJs()},t.onNativeCallback=function(e){console.info("onNativeCallback",e),ul.dump(e,"data"),e&&this.nativeCallbackPending.push(e)},t._registerNativeCallbackJs=function(){try{i.default.initSdk();i.default&&"function"==typeof i.default.setGameCallback&&i.default.setGameCallback(this._onNativeCallbackJs.bind(this))}catch(e){cc.error("\u6ce8\u518c\u5931\u8d25",e)}},t._onNativeCallbackJs=function(e){console.log("---callback from ulsdk=",e);var t=null;try{t=JSON.parse(e)}catch(e){console.log("\u56de\u8c03\u540eJSON\u89e3\u6790\u5931\u8d25",e)}console.log("--\u89e3\u6790\u540e\u7684\u5bf9\u8c61=",t),this.onNativeCallback(t)},t._registerNativeCallbackJava=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ULNativeController","setCallFuncName","(Ljava/lang/String;)Ljava/lang/String;","JAVACALLBACK")},t._registerNativeCallbackObjc=function(){},t._onNativeCallbackJava=function(e){var t={};try{t=JSON.parse(e||"")}catch(o){cc.warn("mgrNative._onNativeCallbackJava jsonStr error!"),t.text=e}this.onNativeCallback(t)},t._onNativeCallbackObjc=function(e){var t={};try{t=JSON.parse(e||"")}catch(o){cc.warn("mgrNative._onNativeCallbackObjc jsonStr error!"),t.text=e}this.onNativeCallback(t)},t.callNative=function(e,t){t=t||{},this._callNativeJs(e,t)},t._callNativeJs=function(e,t){try{var o=JSON.stringify(t),n=e;if(i.default&&"function"==typeof i.default[n])return i.default[n](o);console.log("-----\u6ca1\u6709\u627e\u5230ULNativeController")}catch(e){console.log("\u6ce8\u518c\u5931\u8d25",e)}return null},t._callNativeJava=function(e,t){try{var o=JSON.stringify(t),n=jsb.reflection.callStaticMethod("org/cocos2dx/javascript/ULNativeController",e,"(Ljava/lang/String;)Ljava/lang/String;",o);return JSON.parse(n)}catch(e){return cc.warn("mgrNative._onNativeCallbackJava jsonStr error!"),{error:e}}},t._callNativeObjc=function(e,t){try{var o=JSON.stringify(t),n=jsb.reflection.callStaticMethod("ULNativeController",e+":",o);return JSON.parse(n)}catch(e){return cc.warn("mgrNative._callNativeObjc jsonStr error!"),{error:e}}},t.nativeCallbackPending=null,t.bRegisterNativeCallback=!1,t=__decorate([l],t)}(n.default);o.default=u,cc._RF.pop()},{"../../Lib/ULNativeController":"ULNativeController","../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Base64":"Base64","../../ulframework/utils/Timer":"Timer"}],mgrNetwork:[function(e,t,o){"use strict";cc._RF.push(t,"9b767SvZMFC+4wHhZmfMvXC","mgrNetwork"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("../../ulframework/network/NetworkManager"),r=e("../../ulframework/network/NetworkAdapterHttpUlServer"),i=e("../../ulframework/network/NetworkAdapterHttp"),s=e("../../ulframework/utils/Timer"),c=e("../Const"),l=e("../../ulframework/utils/Tools"),u=cc._decorator.ccclass,d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this);var t=new r.NetworkAdapterHttpUlServer;t.setHost(c.default.SERVER_HOST),t.setUrlFormat(c.default.SERVER_URL_FORMAT),t.setUlServerArg("ultralisk","pc",c.default.SERVER_APP_ID.toString(),"ultralisk"),t.setTimeout(5),this.networkManager=new a.NetworkManager(t),s.default.callLoop(1/60,this.onTimerSpan.bind(this),!0)},t.loadRecord=function(){e.loadRecord.call(this)},t.saveRecord=function(){e.saveRecord.call(this)},t.onTimerSpan=function(e){var t=e.span;this.networkManager.update(t)},t.send=function(e,t,o){null==t&&(t={});var n={};n.cmd=e,null!=t&&l.default.forEachMap(t,function(e,t){n[e]=t}),this.networkManager.addTask(n,this.onResponse.bind(this),this.onFaild.bind(this),this.onRequest.bind(this),o)},t.onRequest=function(e){e.isBackgroundEnabled()||this.showWaiting()},t.onResponse=function(e){this.networkManager.getTasks().length<=1&&this.hideWaiting(),this.sendMsg("MSG_NETWORK_RESPONSE",{requestData:e.getRequestData(),responseData:e.getResponseData()})},t.onFaild=function(e){e.isBackgroundEnabled()?this.stopAllTasks():this.showFaild(),this.sendMsg("MSG_NETWORK_FAILD",{requestData:e.getRequestData(),faildMsg:e.getFaildMsg()})},t.stopAllTasks=function(){for(var e=[],t=this.networkManager.getTasks(),o=0;o<t.length;o++){var n=t[o];e.push({requestData:n.getRequestData()})}this.networkManager.stopAllTasks(),this.hideWaiting(),this.hideFaild();for(o=0;o<e.length;o++){var a=e[o];this.sendMsg("MSG_NETWORK_STOP_TASK",a)}},t.retryCurrentTask=function(){this.networkManager.retryCurrentTask(),this.networkManager.getTasks().length>0&&this.showWaiting()},t.showWaiting=function(){this.hideWaiting(),this.hideFaild()},t.hideWaiting=function(){this.sendMsg("MSG_NETWORK_CLOSE_WAITING")},t.showFaild=function(){this.hideWaiting(),this.hideFaild()},t.hideFaild=function(){this.sendMsg("MSG_NETWORK_CLOSE_FAILD")},t.tryCheckNetwork=function(e,t){if(cc.sys.isBrowser)e();else{var o,n=ul.format("http://%s/cc_patch/fake_version.txt","h005up.ultralisk.cn"),a=new i.NetworkAdapterHttp;a.setReceiveCallback(function(t){cc.log("ReceiveCallback"),o&&o.stop(),e&&e()}),a.setFaildCallback(function(e){cc.log("FaildCallback"),o&&o.stop(),t&&t()}),a.send({url:n}),(o=new s.default(.1,50,function(e){cc.log("mgrNetwork.tryCheckNetwork onTimerLoop",e.count),e.count>=50&&t&&t()})).start()}},t=__decorate([u],t)}(n.default);o.default=d,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/network/NetworkAdapterHttp":"NetworkAdapterHttp","../../ulframework/network/NetworkAdapterHttpUlServer":"NetworkAdapterHttpUlServer","../../ulframework/network/NetworkManager":"NetworkManager","../../ulframework/utils/Timer":"Timer","../../ulframework/utils/Tools":"Tools","../Const":"Const"}],mgrPlayer:[function(e,t,o){"use strict";cc._RF.push(t,"2d698uw/VFAtrVpD4XImhCp","mgrPlayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrRecord"),r=e("./mgrCfg"),i=e("../../ulframework/utils/Timer"),s=e("../../ulframework/utils/Tools"),c=e("../Const"),l=e("./mgrTip"),u=e("./mgrShop"),d=e("./mgrWordFilter"),p=e("./mgrSdk"),h=e("./mgrGuide"),f=cc._decorator.ccclass,g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,t.onLoad=function(){e.onLoad.call(this),cc.log("mgrPlayer.onLoad",this._playerName),this.loadRecord(),i.default.callLoop(1,this.onTimerLoop.bind(this),!0),this.registerListeners({MSG_ITEM_AMOUNT_CHANGED:this.onMsgItemAmountChanged,MSG_SHARE_RESULT:this.onMsgShareResult,MSG_WX_GZH_ENTER_INIT:this.onMsgWxgzhEnterInit,MSG_WX_GZH_ENTER_GAME:this.onMsgWxgzhEnterGame,MSG_SDK_SHARE_VIDEO_RESULT:this.onMsgSdkShareVideoResult})},t.loadRecord=function(){var t=this;e.loadRecord.call(this);var o=a.default.getData("player")||{};this._playerName=o.playerName||"",this._items=o.items||{},this._historyGotItems=o.historyGotItems||{},this._historyUsedItems=o.historyUsedItems||{},this._dailyGotItems=o.dailyGotItems||{},this._dailyUsedItems=o.dailyUsedItems||{},this._historyDailyMaxGotItems=o.historyDailyMaxGotItems||{},this._historyDailyMaxUsedItems=o.historyDailyMaxUsedItems||{},this._recoverCostTimes=o.recoverCostTimes||{},this._lastDailyRefreshTime=o.lastDailyRefreshTime||0,this.lastReceiveVipRewardTime=o.lastReceiveVipRewardTime||0,this.isGetWxgzhReward=o.isGetWxgzhReward||!1,this.deviceCode?this.uid=this.deviceCode:this.uid=o.uid;var n=this._items;r.default.forDb("item_template_db",function(e,t){var o=t.id;null==n[o]&&(n[o]=t.defaultAmount)}),s.default.forEachMap(n,function(e,o){t._historyDisplayedGotItems[e]=o>0}),this.refreshDailyData(),this.refreshRecoverItem(),this._curSkinWall=o.curSkinWall||0,0==this._curSkinWall&&r.default.forDb_from_item_template_db(function(e,o){if(7==o.flag&&t.getItemAmount(parseInt(e))>0)return t._curSkinWall=parseInt(e),!0})},t.saveRecord=function(){e.saveRecord.call(this);var t={playerName:this._playerName,items:this._items,historyGotItems:this._historyGotItems,historyUsedItems:this._historyUsedItems,dailyGotItems:this._dailyGotItems,dailyUsedItems:this._dailyUsedItems,historyDailyMaxGotItems:this._historyDailyMaxGotItems,historyDailyMaxUsedItems:this._historyDailyMaxUsedItems,lastDailyRefreshTime:this._lastDailyRefreshTime,recoverCostTimes:this._recoverCostTimes,uid:this.uid,lastReceiveVipRewardTime:this.lastReceiveVipRewardTime,curSkinWall:this._curSkinWall,isGetWxgzhReward:this.isGetWxgzhReward};a.default.setData("player",t)},t.onTimerLoop=function(e){this.refreshDailyData(),this.refreshRecoverItem()},t.getName=function(){return this._playerName},t.setName=function(e){this._playerName=e,this.saveRecord(),this.sendMsg("MSG_PLAYER_NAME_CHANGED")},t.getItemChangedAge=function(){return this._itemChangedAge},t.getUid=function(){return this.uid||(this.uid=ul.format("%s%03d",ul.formatDate(new Date,"yyyyMMddhhmmssS"),s.default.random(999)),this.saveRecord()),this.uid},t._setDeviceCode=function(e){this.deviceCode=e,this.uid&&this.uid!=e&&(this.uid=e,this.saveRecord())},t.getItemAmount=function(e){return this._items[e]||0},t._setItemAmount=function(e,t){if(null!=e&&null!=t){var o=this.getItemAmount(e);if(o!=t){this._items[e]=Math.max(t,0);var n={itemId:e,amountDelta:t-o};this.sendMsg("MSG_ITEM_AMOUNT_CHANGED",n),this.saveRecord(),this._itemChangedAge++}}else cc.warn("\u8b66\u544a] mgrPlayer.setItemAmount arg is wrong!",e,t)},t.addItemAmount=function(e,t,o){if(null!=e&&null!=t){if(t>0){var n=r.default.get("item_template_db",e);if(!n)return void cc.warn("\u8b66\u544a] mgrPlayer.addItemAmount itemId \u4e0d\u5b58\u5728! itemId: ",e);0!=n.sellItemId&&this.getItemAmount(e)>=1&&(e=n.sellItemId,t=n.sellItemAmount*t)}var a=this.getItemAmount(e);this._setItemAmount(e,a+t),p.default.statisOnAddItemAmount(e,t,o)}else cc.warn("\u8b66\u544a] mgrPlayer.addItemAmount arg is wrong!",e,t)},t.getItemDailyGotAmount=function(e){return this._historyGotItems[e]||0},t.getItemHistoryGotAmount=function(e){return this._dailyGotItems[e]||0},t.getItemHistoryDailyMaxGotAmount=function(e){return this._historyDailyMaxGotItems[e]||0},t.getItemDailyUsedAmount=function(e){return this._dailyUsedItems[e]||0},t.getItemHistoryUsedAmount=function(e){return this._historyUsedItems[e]||0},t.getItemHistoryDailyMaxUsedAmount=function(e){return this._historyDailyMaxUsedItems[e]||0},t.isDisplayedGotItem=function(e){return 1==this._historyDisplayedGotItems[e]},t.markDisplayedGotItem=function(e){this._historyDisplayedGotItems[e]=!0},t.onMsgItemAmountChanged=function(e){var t=e,o=t.itemId,n=t.amountDelta;n>0?(this._historyGotItems[o]=(this._historyGotItems[o]||0)+n,this._dailyGotItems[o]=(this._dailyGotItems[o]||0)+n,this._historyDailyMaxGotItems[o]=Math.max(this._historyDailyMaxGotItems[o]||0,this._dailyGotItems[o])):(this._historyUsedItems[o]=(this._historyUsedItems[o]||0)+-n,this._dailyUsedItems[o]=(this._dailyUsedItems[o]||0)+-n,this._historyDailyMaxUsedItems[o]=Math.max(this._historyDailyMaxUsedItems[o]||0,this._dailyUsedItems[o])),o==c.default.ITEM_ID_VIP&&this.getItemAmount(o)>0&&(this.lastReceiveVipRewardTime=s.default.time(),this.saveRecord())},t.refreshDailyData=function(){s.default.isOneDay(s.default.time(),this._lastDailyRefreshTime)||(this._dailyGotItems={},this._dailyUsedItems={},this._lastDailyRefreshTime=s.default.time(),this.saveRecord())},t.refreshRecoverItem=function(){var e=this,t=s.default.time();r.default.forDb("item_recover_db",function(o,n){var a=n.id,r=e.getItemAmount(a),i=e.getRecoverMaxAmount(a),c=e._getRecoverCostTime(a),l=0;if(1==n.mode){if(i<=r)return void(0!=c&&e._setRecoverCostTime(a,0));if(t<c&&(c=t,e._setRecoverCostTime(a,c)),c<=0){if(i<=r)return;c=t,e._setRecoverCostTime(a,c)}var u=t-c,d=e._getRecoverTime(a);if((l=Math.floor(u/d))<=0)return;c+=d*l}else{if(2!=n.mode)return void cc.warn("\u8b66\u544a] mgrPlayer.refreshRecoverItem \u672a\u77e5mode",n.mode);if(c<=0)return void e._setRecoverCostTime(a,t);if(s.default.isOneDay(t,c))return;l=1,c=t}i<=(r+=e._getRecoverAmount(a)*l)&&(r=Math.min(r,i),c=0),e._setItemAmount(a,r),e._setRecoverCostTime(a,c)})},t.getRecoverMaxAmount=function(e){var t=r.default.get("item_recover_db",e);return 0!=t.maxAmountRefItemId?this.getItemAmount(t.maxAmountRefItemId):t.maxAmount},t._getRecoverTime=function(e){return r.default.get("item_recover_db",e,"recoverTime")},t._getRecoverAmount=function(e){var t=r.default.get_from_item_recover_db(e);return t.recoverCopValue?p.default.getCopNumberValueByKey(t.recoverCopValue):this.isVip()?t.vipRecoverAmount:t.recoverAmount},t._getRecoverCostTime=function(e){return this._recoverCostTimes[e]||0},t._setRecoverCostTime=function(e,t){this._recoverCostTimes[e]=t,this.saveRecord()},t.getRecoverRemainTime=function(e){var t=r.default.get("item_recover_db",e);if(1==t.mode){var o=this._getRecoverCostTime(e);if(o<=0)return null;var n=s.default.time()-o,a=this._getRecoverTime(e);return a<n?0:a-n}if(2==t.mode){if(this.getItemAmount(e)>=this.getRecoverMaxAmount(e))return null;var i=new Date;return i.setDate(i.getDate()+1),i.setHours(0),i.setMinutes(0),i.setSeconds(0),i.getTime()/1e3-s.default.time()}return cc.warn("\u8b66\u544a] mgrPlayer.refreshRecoverItem \u672a\u77e5mode",t.mode),null},t.openItemBox=function(e){var t=r.default.get("item_box_db",e);return this.openItemBoxByBoxData(t)},t.openItemBoxByBoxData=function(e){var t=[];if(e.triggerRatio<1e4&&s.default.random(1e4)>e.triggerRatio)return t;var o=e.ratioType;if(1==o)for(var n=0;n<e.items.length;n++){if((r=e.items[n]).ratio>=1e4||s.default.random(1e4)<=r.ratio){var a=s.default.random(r.minAmount,r.maxAmount);t.push([r.itemId,a])}}else if(2==o){if(r=s.default.calcWheelTarget(e.items,"ratio")){a=s.default.random(r.minAmount,r.maxAmount);t.push([r.itemId,a])}}else if(3==o)for(n=0;n<e.items.length;n++){var r=e.items[n];a=s.default.random(r.minAmount,r.maxAmount);t.push([r.itemId,a])}return t},t.isVip=function(){return this.getItemAmount(c.default.ITEM_ID_VIP)>=1},t.canReceiveVipReward=function(){if(!this.isVip())return!1;var e=this.lastReceiveVipRewardTime||0;return!s.default.isOneDay(e,s.default.time())},t.buyVip=function(e){this.isVip()||u.default.requestBuy(c.default.ITEM_ID_VIP,1,e||"\u672a\u77e5\u6765\u6e90")},t.tryReceiveVipReward=function(){if(!this.canReceiveVipReward())return l.default.showMsgTip("\u73b0\u5728\u4e0d\u80fd\u9886\u53d6\u54e6"),{errorCode:!1,rewards:null};for(var e=r.default.get("item_template_db",c.default.ITEM_ID_VIP).data||[],t=0;t<e.length;t++){var o=e[t];this.addItemAmount(o[0],o[1],"\u9b54\u4ed9\u7279\u6743\u6bcf\u65e5\u9886\u53d6"),l.default.addGotItemTip(o[0],o[1])}return this.lastReceiveVipRewardTime=s.default.time(),this.saveRecord(),{errorCode:!0,rewards:e}},t.autoIntitle=function(){o.getName()||o.setName(o.calcRandomName())},t.calcRandomName=function(){for(var e=r.default.getDb("random_name_part1_db"),t=r.default.getDb("random_name_part2_db"),o="",n=0;n<1e3;n++){var a=e[s.default.random(e.length)-1].word+t[s.default.random(t.length)-1].word;if(!d.default.hasSymbol(a)&&d.default.checkStr(a)){o=a;break}}return o},t.calcRandomHeadIcon=function(){var e=s.default.random(1,6);return ul.format("2d/npc/npc_q_0%d",e)},t.setCurSkinWallId=function(e){this._curSkinWall!=e&&(this._curSkinWall=e,this.saveRecord())},t.getCurSkinWallId=function(){return this._curSkinWall},t.getCurSkinWallColor=function(){return this.getSkinWallColorByItemId(this._curSkinWall)},t.getSkinWallColorByItemId=function(e){var t=r.default.get_from_item_template_db(e);if(!t)return cc.color(0,0,0);var o=t.data;return cc.color(o.r,o.g,o.b)},t.canShare=function(){var e=o.getItemAmount(c.default.ITEM_ID_SHARE_COUNT)>0,t=1==p.default.getCopNumberValueByKey("b_share");return e&&!h.default.isGuiding()&&t},t.tryShowShare=function(e,t){if(void 0===t&&(t=null),!(o.getItemAmount(c.default.ITEM_ID_SHARE_COUNT)<=0)){var n="";n=e?e+"\u5206\u4eab\u53ef\u83b7\u5f97 100 \u91d1\u5e01":"\u5206\u4eab\u53ef\u83b7\u5f97 100 \u91d1\u5e01",l.default.alertPrompt2("\u6bcf\u65e5\u5206\u4eab",n,"\u53d6\u6d88","\u5206\u4eab",null,function(){p.default.shareImage("","","",""),t&&t()})}},t.onMsgShareResult=function(e){if(e.bSuccess){if(l.default.showMsgTip("\u5206\u4eab\u6210\u529f"),this.getItemAmount(c.default.ITEM_ID_SHARE_COUNT)<=0)return;o.addItemAmount(c.default.ITEM_ID_GOLD,100,"\u5206\u4eab\u6210\u529f"),l.default.addGotItemTip(c.default.ITEM_ID_GOLD,100,null),o.addItemAmount(c.default.ITEM_ID_SHARE_COUNT,-1,"\u5206\u4eab")}else l.default.showMsgTip("\u5206\u4eab\u5931\u8d25")},t.takeWxgzhReward=function(){this.isNeedAlertWxgzhReward=!1,this.isGetWxgzhReward=!0;return o.addItemAmount(c.default.ITEM_ID_GOLD,300,"\u5fae\u4fe1\u516c\u4f17\u53f7\u5956\u52b1"),this.saveRecord(),300},t.onMsgWxgzhEnterInit=function(e){this.isGetWxgzhReward||(this.isNeedAlertWxgzhReward=!0)},t.onMsgWxgzhEnterGame=function(e){if(!this.isGetWxgzhReward){var t=this.takeWxgzhReward();i.default.callLater(.5,function(){l.default.showMsgTip("\u5fae\u4fe1\u516c\u4f17\u53f7\u5956\u52b1 \u91d1\u5e01x"+t)})}},t.onMsgSdkShareVideoResult=function(e){e.isSuccess?(l.default.showMsgTip("\u5206\u4eab\u6210\u529f"),o.getItemAmount(c.default.ITEM_ID_VIDEO_SHARE_COUNT)>0&&(o.addItemAmount(c.default.ITEM_ID_VIDEO_SHARE_COUNT,-1,"\u5206\u4eab\u6210\u529f"),o.addItemAmount(c.default.ITEM_ID_GOLD,150,"\u5206\u4eab\u6210\u529f"),l.default.addGotItemTip(c.default.ITEM_ID_GOLD,150,null))):l.default.showMsgTip("\u5206\u4eab\u5931\u8d25")},t._items={},t._playerName="",t._itemChangedAge=0,t._historyDisplayedGotItems={},t._historyGotItems={},t._historyUsedItems={},t._dailyGotItems={},t._dailyUsedItems={},t._historyDailyMaxGotItems={},t._historyDailyMaxUsedItems={},t._lastDailyRefreshTime=null,t._recoverCostTimes={},t.lastReceiveVipRewardTime=null,t.uid="",t.deviceCode="",t._curSkinWall=0,t.isGetWxgzhReward=!1,t.isNeedAlertWxgzhReward=!1,t=o=__decorate([f],t)}(n.default);o.default=g,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Timer":"Timer","../../ulframework/utils/Tools":"Tools","../Const":"Const","./mgrCfg":"mgrCfg","./mgrGuide":"mgrGuide","./mgrRecord":"mgrRecord","./mgrSdk":"mgrSdk","./mgrShop":"mgrShop","./mgrTip":"mgrTip","./mgrWordFilter":"mgrWordFilter"}],mgrPool:[function(e,t,o){"use strict";cc._RF.push(t,"97f69CulKBN3pqAzZZQdVGA","mgrPool"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("../../ulframework/utils/PoolManager"),r=e("./mgrCfg"),i=e("../../ulframework/view/Spine"),s=e("../../ulframework/view/Particle"),c=e("./mgrDirector"),l=e("../../ulframework/view/AnimNode"),u=cc._decorator,d=u.ccclass,p=(u.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this.poolManager=new a.default,this._regsiterPoolConfig()},t.loadRecord=function(){e.loadRecord.call(this)},t.saveRecord=function(){e.saveRecord.call(this)},t._regsiterPoolConfig=function(){this.poolManager.register("spine",function(e){return r.default.get("spine_db",e)?new i.default(e):null},function(e){e instanceof i.default&&e.reset()},function(e){e instanceof i.default&&(e.stopAllActions(),e.unregisterEventCallback())},function(e){var t=e.getComponent(sp.Skeleton).skeletonData,o=cc.loader.getDependsRecursively(t);cc.loader.release(o),cc.loader.release(t)},1e3),this.poolManager.register("animNode",function(e){return r.default.get("anim_node_db",e)?new l.default(e):null},function(e){e instanceof l.default&&e.reset()},function(e){e instanceof l.default&&(e.stopAllActions(),e.unregisterEventCallback())},function(e){},1e3),this.poolManager.register("particle",function(e){return r.default.get("particle_db",e)?new s.default(e):null},function(e){e instanceof s.default&&e.reset()},function(e){},function(e){},1e3),this.poolManager.register("view",function(e){return c.default.createView(e)},function(e){},function(e){},function(e){},1e3),this.poolManager.register("sprite",function(e){return c.default.createSpriteNode(e)},function(e){},function(e){},function(e){var t=e.getComponent(cc.Sprite).spriteFrame,o=cc.loader.getDependsRecursively(t);cc.loader.release(o),cc.loader.release(t)},1e3)},t.get=function(e,t){return this.poolManager.get(e,t)},t.put=function(e){this.poolManager.put(e)},t.clean=function(e,t){cc.log(" public static clean(poolId?: string, poolKey?: string) "),this.poolManager&&this.poolManager.clean(e,t)},t=__decorate([d],t)}(n.default));o.default=p,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/PoolManager":"PoolManager","../../ulframework/view/AnimNode":"AnimNode","../../ulframework/view/Particle":"Particle","../../ulframework/view/Spine":"Spine","./mgrCfg":"mgrCfg","./mgrDirector":"mgrDirector"}],mgrRank:[function(e,t,o){"use strict";cc._RF.push(t,"573d2DiHzxL2qAAW90RrPuj","mgrRank"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("../struct/sRankPlayer"),r=e("./mgrNetwork"),i=e("./mgrPlayer"),s=e("../../ulframework/utils/Tools"),c=e("../../ulframework/utils/Base64"),l=e("./mgrRecord"),u=e("./mgrTip"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this.loadRecord(),this.registerListeners({MSG_NETWORK_RESPONSE:this.onMsgNetworkResponse,MSG_PVP_UPLOAD_SUCCESS:this.onMsgPvpUploadSuccess})},t.loadRecord=function(){e.loadRecord.call(this);var t=l.default.getData("rank")||{};this.maxScore=t.maxScore||{}},t.saveRecord=function(){e.saveRecord.call(this);var t={maxScore:this.maxScore};l.default.setData("rank",t)},t.getPlayers=function(e){for(var t=[],o=this.rankPlayers[e]||{},n=1;o[n];)t.push(o[n]),n++;return t},t.getMaxScore=function(e){return this.maxScore[e]||0},t.setMaxScore=function(e,t){t>this.getMaxScore(e)&&(this.maxScore[e]=Math.floor(t)),this.saveRecord()},t.getServerPlayerCount=function(e){return this.serverPlayerCounts[e]},t.getSelfPlayer=function(e){return this.selfPlayer[e]},t.requestNextBatchPlayers=function(e){var t=1,o=this.getPlayers(e);o.length>0&&(t=o[o.length-1].rank),this.requestRankList(e,t,t+20-1)},t.requestSelfData=function(e,t,o){if(null==this.getSelfPlayer(e)||o){var n={info:{uidarry:[i.default.getUid()],rankid:e.toString(),sorttype:"REVRANGE"}};r.default.send("/get/getPlayerInfoByUid",n,t)}},t.requestPlayerDataByRankId=function(e){var t={info:{rankarry:[e.toString()],rankid:e.toString(),sorttype:"REVRANGE"}};r.default.send("/get/getPlayerInoByRankid",t)},t.requestRankList=function(e,t,o){for(var n=[],a=t;a<=o;a++)n.push(a.toString());var i={info:{rankarry:n,rankid:e.toString(),sorttype:"REVRANGE"}};r.default.send("/get/getPlayerInoByRankid",i)},t.requestUploadToRank=function(e,t){var o=i.default.getName(),n={info:{uidarray:[i.default.getUid()],dataarray:[this._packPlayerData(o,t.toString())],scorearray:[t.toString()],rankid:e.toString()}};r.default.send("/set/setPlayerInfoWithScoreArray",n)},t.preRequestRankList=function(e){this.requestRankList(e,1,20)},t._packPlayerData=function(e,t){return c.default.encodeForUrl(e)+"|"+t},t._unpackPlayerData=function(e){var t=e.indexOf("|");if(null==t)return["unknown",""];var o=e.substring(0,t);return[c.default.decodeForUrl(o),e.substring(t+1,e.length)]},t.onMsgNetworkResponse=function(e){var t=this,o=e,n=o.requestData,r=o.responseData;if(-1!=r.code){var c=n.cmd;if("/get/getUserNumInRank"==c)s.default.forEachMap(r.msg,function(e,o){var n=parseInt(e),a=parseInt(o);isNaN(a)&&(a=0),cc.log("count",n,a),null!=n&&null!=a?(t.serverPlayerCounts[n]=a,cc.log("############MSG_PVP_PLAYER_COUNT_CHANGED###########"),t.sendMsg("MSG_PVP_PLAYER_COUNT_CHANGED",{rankId:n})):cc.warn(ul.format("mgrRank.onMsgNetworkResponse /get/getUserNumInRank data is error! rankId=[%s], count=[%s]",n,a))});else if("/get/getRankName"==c)s.default.forEachMap(r.msg,function(e,o){var n=parseInt(e);t.sendMsg("MSG_PVP_SUBJECT_CHANGED",{rankId:n})});else if("/get/getPlayerInfoByUid"==c){var l=parseInt(n.info.rankid),u=i.default.getUid(),d=r.msg[u];if(d){var p=JSON.parse(d);if(p){if(p.data){var h=p.data,f=parseInt(p.rank),g=parseInt(p.score),m=this._unpackPlayerData(h),v=m[0],_=m[1],y=new a.default(u,f,g,v,_);this.selfPlayer[l]=y,this.sendMsg("MSG_PVP_SELF_DATA_CHANGED",{rankId:l})}}else cc.warn("[warn] mgrPvp.onMsgNetworkResponse /get/getPlayerInoByRankid player data not a validate json",d)}else cc.warn("[warn] mgrPvp.onMsgNetworkResponse /get/getPlayerInfoByUid player data not found! uid = ",u)}else if("/get/getPlayerInoByRankid"==c){var C=parseInt(n.info.rankid),S=[];s.default.forEachMap(r.msg,function(e,o){var n=parseInt(e),r=JSON.parse(o);if(r){if(r.data){var i=r.data,s=r.uid,c=parseInt(r.score),l=t._unpackPlayerData(i),u=l[0],d=l[1],p=new a.default(s,n,c,u,d);S.push(p),null==t.rankPlayers[C]&&(t.rankPlayers[C]={}),t.rankPlayers[C][p.rank]=p}}else cc.warn("[warn] mgrPvp.onMsgNetworkResponse /get/getPlayerInoByRankid player data not a validate json",o)}),S=s.default.sortArrayByField(S,"rank"),this.sendMsg("MSG_PVP_RESPONSE_PLAYER_FROM_RANK",{players:S,rankId:C,requestData:n})}else if("/set/setPlayerInfoWithScoreArray"==c){l=parseInt(n.info.rankid);this.selfPlayer[l]=null,cc.log("MSG_PVP_UPLOAD_SUCCESS"),this.sendMsg("MSG_PVP_UPLOAD_SUCCESS",{rankId:l,requestData:n})}}},t.onMsgPvpUploadSuccess=function(e){var t=e,o=t.rankId;t.requestData;u.default.showMsgTip("\u4e0a\u4f20\u6210\u529f"),this.requestSelfData(o),this.rankPlayers[o]={},this.preRequestRankList(o)},t.serverPlayerCounts={},t.selfPlayer={},t.rankPlayers={},t.maxScore={},t=__decorate([p],t)}(n.default));o.default=h,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Base64":"Base64","../../ulframework/utils/Tools":"Tools","../struct/sRankPlayer":"sRankPlayer","./mgrNetwork":"mgrNetwork","./mgrPlayer":"mgrPlayer","./mgrRecord":"mgrRecord","./mgrTip":"mgrTip"}],mgrRecord:[function(e,t,o){"use strict";cc._RF.push(t,"b01ccp08MRNpa9et5mKMFwU","mgrRecord"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("../../ulframework/utils/Timer"),r=e("./mgrSdk"),i=cc._decorator.ccclass,s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this.__generate_key_map(),this._readRecord(),a.default.callLoop(.1,this.onTimerSpan.bind(this),!0)},t.onTimerSpan=function(e){this.bNeedFlush&&(this.bNeedFlush=!1,this._writeRecord())},t.setUserId=function(e){e?(this.record.userId=e,r.default.getServerRecord()):console.log("---\x3e> userId is invaild!",e)},t.onReceivedServerStorage=function(e){if(e)try{var t=JSON.parse(e);if(!t)return void console.log("---\x3e> cloud storage is damaged!");t.userId=this.record.userId,this.record=t,this.sendMsg("MSG_RECORD_RESET")}catch(e){console.log(e)}else console.log("---\x3e> cloud storage is invaild!")},t._readRecord=function(e){if(e||(e=cc.sys.localStorage.getItem("record_game62")),!e)return cc.warn("\u8b66\u544a] mgrRecord._readRecord \u5b58\u6863\u672a\u627e\u5230\uff01\u91cd\u7f6e\u5b58\u6863\uff01"),void this.resetRecord();var t=JSON.parse(e);return t?1!=t.__version__?(cc.warn("\u8b66\u544a] mgrRecord._readRecord \u5b58\u6863\u7248\u672c\u6539\u53d8\uff01\u91cd\u7f6e\u5b58\u6863\uff01"),void this.resetRecord()):void(this.record=t):(cc.warn("\u8b66\u544a] mgrRecord._readRecord \u5b58\u6863\u6570\u636e\u635f\u574f\uff01\u91cd\u7f6e\u5b58\u6863\uff01"),void this.resetRecord())},t._writeRecord=function(){var e=JSON.stringify(this.record);if(cc.sys.localStorage.setItem("record_game62",e),this.record.userId){var t=ul.clone(this.record);t.player.historyGotItems=null,t.player.historyDailyMaxGotItems=null,t.player.historyDailyMaxUsedItems=null;var o=JSON.stringify(t);r.default.saveServerRecord(o)}},t._requestFlush=function(){this._bDebugBanWrite||(this.bNeedFlush=!0)},t._setDebugBanWrite=function(e){this._bDebugBanWrite=e},t.getData=function(e){return this.record[e]},t.setData=function(e,t){this.record[e]=t,this._requestFlush()},t.resetRecord=function(){this.record={},this.record.__version__=1,this._requestFlush(),this.sendMsg("MSG_RECORD_RESET")},t.__generate_key_map=function(){var e=this;cc.loader.loadRes("cfg/_record.json",function(t,o){if(t)console.log(t);else{var n=o.json;e.__generate_key_map_real(n)}})},t.__generate_key_map_real=function(e){if("object"==ul.getType(e)||"array"==ul.getType(e))for(var t in e)this._record_compress_key_map[t]=this._gobal_key_index.toString(),this._record_uncompress_key_map[this._gobal_key_index.toString()]=t,this._gobal_key_index++,this.__generate_key_map_real(e[t])},t.__compress=function(e){if("object"!=ul.getType(e)&&"array"!=ul.getType(e))return e;var t={};for(var o in e)t[this._record_compress_key_map[o]||o]=this.__compress(e[o]);return t},t.__uncompress=function(e){if("object"!=ul.getType(e)&&"array"!=ul.getType(e))return e;var t={};for(var o in e)t[this._record_uncompress_key_map[o]||o]=this.__uncompress(e[o]);return t},t.record={},t.bNeedFlush=!1,t._bDebugBanWrite=!1,t._record_compress_key_map={},t._record_uncompress_key_map={},t._gobal_key_index=0,t=__decorate([i],t)}(n.default);o.default=s,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Timer":"Timer","./mgrSdk":"mgrSdk"}],mgrRole:[function(e,t,o){"use strict";cc._RF.push(t,"fa88ejAH/pIT6o1AuvuLL/+","mgrRole"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrRecord"),r=e("../../ulframework/utils/Tools"),i=e("../../ulframework/utils/Timer"),s=cc._decorator.ccclass,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){var t=this;e.onLoad.call(this),this.loadRecord(),this.trySettlementLastOfflineTime(),i.default.callLoop(60,function(){t.goOfflineTime=r.default.time(),t.saveRecord()})},t.loadRecord=function(){e.loadRecord.call(this);var t=a.default.getData("role")||{};this.goOfflineTime=t.goOfflineTime||r.default.time(),this.willSettlementOfflineTimeQueue=t.willSettlementOfflineTimeQueue||[],this.saveRecord()},t.saveRecord=function(){e.saveRecord.call(this);var t={goOfflineTime:this.goOfflineTime,willSettlementOfflineTimeQueue:this.willSettlementOfflineTimeQueue};a.default.setData("role",t)},t.trySettlementLastOfflineTime=function(){var e=r.default.time(),t=Math.floor(e-this.goOfflineTime);t>=3600&&this.willSettlementOfflineTimeQueue.push(t)},t.getOfflineReward=function(){for(var e=0,t=0;t<this.willSettlementOfflineTimeQueue.length;t++){e+=this.willSettlementOfflineTimeQueue[t]}return[e=e>28800?28800:e,Math.ceil(e/60*.5)]},t.markOfflineRewardGeted=function(){this.willSettlementOfflineTimeQueue=[],this.goOfflineTime=r.default.time(),this.saveRecord()},t.goOfflineTime=0,t.willSettlementOfflineTimeQueue=[],t=__decorate([s],t)}(n.default);o.default=c,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Timer":"Timer","../../ulframework/utils/Tools":"Tools","./mgrRecord":"mgrRecord"}],mgrSdk:[function(e,t,o){"use strict";cc._RF.push(t,"467e7ztU4NEF4z8bAbZNEzP","mgrSdk"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("../Const"),r=e("./mgrNative"),i=e("./mgrTip"),s=e("./mgrCop"),c=e("./mgrRecord"),l=e("./mgrPlayer"),u=cc._decorator.ccclass,d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,t.onLoad=function(){e.onLoad.call(this),this.registerListeners({MSG_NATIVE_CALLBACK:this.onMsgNativeCallback}),this.startProcMsg()},t.onLoadingComplete=function(){this.setVersion(2)},t.getCopNumberValueByKey=function(e){return s.default.getNumberValue(e)},t.getCopByKey=function(e){return s.default.get(e)},t.isOpenVideoRecord=function(){return this.isCopOpenVideoRecord()&&a.default.IS_OPEN_VIDEO_RECORD},t.isCopOpenVideoRecord=function(){return"1"==o.getCopByKey("b_record_video")&&"1"==o.getCopByKey("sdk_is_open_videorecord")},t.getCopAdMode=function(){return o.getCopNumberValueByKey("ad_mode")},t.isOpenPay=function(){return a.default.IS_COP_OPEN_PAY},t.sendMsgToSdk=function(e){r.default.callNative("sendMsgToSdk",e)},t.onMsgNativeCallback=function(e){var t=e.responseData,o=t.cmd;switch(console.log("mgrSdk.onMsgNativeCallback",o),o){case"/c/channelInfoResult":console.info("channelInfoResult");var n=t.data||{};console.info("  copInfo",n.copInfo),s.default.onReceiveSdkCop(n.copInfo),this.sendMsg("MSG_CHANNEL_INFO_RESULT");break;case"/c/getLoginUserMessage":console.log("/c/getLoginUserMessage");var r=t.data||{};a.default.IS_SHOW_URL_AD_ICON=r.isShowUrlAdIcon,a.default.IS_COP_OPEN_PAY=0==r.isClosePay,c.default.setUserId(r.userId);break;case"/c/userLoginResult":console.log("/c/userLoginResult");var u=t.data||{};1==parseInt(u.code)?(console.info("\u767b\u5f55 \u6210\u529f"),i.default.showMsgTip("\u767b\u5f55\u6210\u529f"),this.sendMsg("MSG_SDK_USER_LOGIN_SUCCESS")):(console.info("\u767b\u5f55 \u5931\u8d25 "),i.default.showMsgTip("\u767b\u5f55\u5931\u8d25"));break;case"/c/advValidCount":console.log("/c/advValidCount");var d=t.data;a.default.AD_VIDEO_VALID_COUNT=d.video,this.sendMsg("MSG_ADV_VALID_COUNT",t.data);break;case"/c/advShowResult":console.log("/c/advShowResult"),this.sendMsg("MSG_ADV_SHOW_RESULT",t.data);break;case"/c/closeAdvResult":console.log("/c/closeAdvResult"),this.sendMsg("MSG_ADV_CLOSE_RESULT",t.data);break;case"/c/shareResult":console.log("/c/shareResult");var p=t.data||{},h=p.userData||"",f=!1;1==parseInt(p.code)?(console.info("---/c/shareResult successed"),f=!0):console.info("---/c/shareResult faild"),this.sendMsg("MSG_SHARE_RESULT",{bSuccess:f,userData:h});break;case"/c/saveRankResult":console.log("/c/saveRankResult");var g=t.data||{};1==parseInt(g.code)?console.info("\u4e0a\u4f20\u6392\u884c\u699c\u6210\u529f"):console.info("\u4e0a\u4f20\u6392\u884c\u699c\u5931\u8d25");break;case"/c/getRankResult":console.log("/c/getRankResult");var m=t.data||{};1==parseInt(m.code)?(console.info("\u83b7\u53d6\u6392\u884c\u699c\u6210\u529f"),this.sendMsg("MSG_GET_RANK_RESULT",{msg:m.msg})):console.info("\u83b7\u53d6\u6392\u884c\u699c\u5931\u8d25");break;case"/c/recorderVideoResult":console.log("/c/recorderVideoResult");var v=t.data||{};1==parseInt(v.code)?(console.info("\u5f55\u5c4f\u884c\u4e3a \u6210\u529f action: ",v.action),this.sendMsg("MSG_SDK_RECORD_VIDEO_RESULT",{action:v.action,msg:v.msg})):(console.info("\u5f55\u5c4f\u884c\u4e3a \u5931\u8d25 action: ",v.action),console.info("\u5f55\u5c4f\u884c\u4e3a \u5931\u8d25 msg: ",v.msg));break;case"/c/shareVideoResult":console.log("/c/shareVideoResult");var _=t.data||{};1==parseInt(_.code)?(console.info("\u5f55\u5c4f\u5206\u4eab \u6210\u529f msg: ",_.msg),this.sendMsg("MSG_SDK_SHARE_VIDEO_RESULT",{isSuccess:!0})):(console.info("\u5f55\u5c4f\u5206\u4eab \u5931\u8d25 msg: ",_.msg),this.sendMsg("MSG_SDK_SHARE_VIDEO_RESULT",{isSuccess:!1}));break;case"/c/megadataServer":console.log("/c/megadataServer");break;case"/c/jumpGameResult":console.log("/c/jumpGameResult");break;case"/c/extraBonus":console.log("/c/extraBonus");var y=t.data||{};1==parseInt(y.isInitGame)?(console.info("\u5fae\u4fe1\u516c\u4f17\u53f7\u8fdb\u5165 \u521d\u59cb\u5316"),this.sendMsg("MSG_WX_GZH_ENTER_INIT")):(console.info("\u5fae\u4fe1\u516c\u4f17\u53f7\u8fdb\u5165 \u6e38\u620f\u4e2d"),this.sendMsg("MSG_WX_GZH_ENTER_GAME"));break;case"/c/openRecommendationResult":console.log("/c/openRecommendationResult");break;case"/c/closeRecommendationResult":console.log("/c/closeRecommendationResult");break;case"/c/payResult":console.log("/c/payResult"),i.default.closeWaitingDialog();var C=t.data||{},S=(C.payData||{}).payInfo||{};1==parseInt(C.code)?(console.info("\u652f\u4ed8 \u6210\u529f msg: ",C.msg),this.sendMsg("MSG_SDK_PAY_SUC",{payId:S.payId})):(console.info("\u652f\u4ed8 \u5931\u8d25 msg: ",C.msg),i.default.showMsgTip(C.msg));break;case"/c/getUserDataResult":console.log("/c/getUserDataResult");var b=t.data||{};c.default.onReceivedServerStorage(b.userData);break;case"/c/saveUserDataResult":console.log("/c/saveUserDataResult");break;case"/c/useCdkey":console.log("/c/useCdkey"),i.default.closeWaitingDialog();var T=t.data||{};if(1==parseInt(T.code)){console.info("\u9886\u53d6 \u6210\u529f ");var R=T.data||{};for(var k in R){var I=R[k];l.default.addItemAmount(I.goodsid,I.count,"CDK\u9886\u53d6"),i.default.addGotItemTip(I.goodsid,I.count)}}else console.info("\u9886\u53d6 \u5931\u8d25 msg: ",T.data),i.default.showMsgTip(T.data||"\u5151\u6362\u7801\u9886\u53d6\u5931\u8d25")}},t.staticSdk=function(e){this.sendMsgToSdk({cmd:"/c/megadataServer",data:e})},t.statisOnStageStart=function(e){this.DEBUG&&console.info("mgrSdk:statisOnStageStart(stageId)",e);var t=["level",e.toString()];this.staticSdk(t)},t.statisOnSign=function(e,t){this.DEBUG&&console.info("mgrSdk:statisOnSign(day)",e," times: ",t);var o=["sign",e.toString(),t.toString()];this.staticSdk(o)},t.statisOnAddItemAmount=function(e,t,o){},t.statisOnItemBought=function(e,t,o){},t.statisCommonEvent=function(e){},t.setVersion=function(e){this.sendMsgToSdk({cmd:"/c/setVersion",data:e})},t.shareImage=function(e,t,o,n){this.DEBUG&&console.info("mgrSdk:shareImage",e,t,o,n),this.sendMsgToSdk({cmd:"/c/openShare",data:{title:e,content:t,url:o,imagePath:n,userData:"clientSend"}})},t.closeAdv=function(e,t){this.sendMsgToSdk({cmd:"/c/closeAdv",data:{type:e,userData:t}})},t.uploadRankSdk=function(e){console.log("uploadRankSdk");var t=(new Date).getTime();o.sendMsgToSdk({cmd:"/c/saveRankData",data:{startTime:(t-1e4).toString(),endTime:t.toString(),rankName:"\u6392\u884c\u699c",score:e,order:1}})},t.getRankListSdk=function(e,t){void 0===e&&(e=0),void 0===t&&(t=100),console.log("getRankListSdk"),o.sendMsgToSdk({cmd:"/c/getRankData",data:{dataNum:t,rankName:"\u6392\u884c\u699c",order:1,rankType:e}})},t.openAdH5=function(){console.log("mgrSdk openAdH5"),this.sendMsgToSdk({cmd:"/c/openAdv",data:{type:"url",gravity:null,userData:null}})},t.recordGameVideo=function(e,t){void 0===e&&(e="start"),void 0===t&&(t=120),console.log("mgrsdk recordGameVideo"),o.sendMsgToSdk({cmd:"/c/recorderGameVideo",data:{action:e,durationTime:t}})},t.shareGameVideo=function(){console.log("mgrsdk shareGameVideo"),o.sendMsgToSdk({cmd:"/c/shareGameVideo"})},t.userLogin=function(){console.log("mgrsdk userLogin"),o.sendMsgToSdk({cmd:"/c/userLogin"})},t.jumpOtherGame=function(e){console.log("mgrSdk jumpOtherGame"),this.sendMsgToSdk({cmd:"/c/jumpOtherGame",data:{gameIndex:e,userData:null}})},t.openCrossRecommend=function(e,t,o){void 0===o&&(o="carousel"),console.log("mgrSdk openCrossRecommend"),this.sendMsgToSdk({cmd:"/c/openRecommendation",data:{type:o,style:{left:e,top:t}}})},t.closeCrossRecommend=function(){console.log("mgrSdk closeCrossRecommend"),this.sendMsgToSdk({cmd:"/c/closeRecommendation",data:null})},t.openPay=function(e){console.log("mgrSdk openPay"),i.default.isWaitingDialogOpened()?i.default.showMsgTip("\u6709\u5546\u54c1\u6b63\u5728\u652f\u4ed8\u4e2d\uff0c\u8bf7\u7a0d\u540e\u518d\u8d2d\u4e70"):(i.default.openWaitingDialog("\u63d0\u793a","\u652f\u4ed8\u4e2d..."),this.sendMsgToSdk({cmd:"/c/openPay",data:{payInfo:{payId:e}}}))},t.getServerRecord=function(){console.log("mgrSdk getServerRecord"),this.sendMsgToSdk({cmd:"/c/getUserData",data:null})},t.saveServerRecord=function(e){console.log("mgrSdk saveServerRecord"),this.sendMsgToSdk({cmd:"/c/saveUserData",data:{userData:e}})},t.useCdk=function(e){console.log("mgrSdk useCdk cdk: ",e),i.default.isWaitingDialogOpened()?i.default.showMsgTip("\u9886\u53d6\u4e2d\uff0c\u8bf7\u7a0d\u540e\u518d\u9886\u53d6"):(i.default.openWaitingDialog("\u63d0\u793a","\u9886\u53d6\u4e2d..."),this.sendMsgToSdk({cmd:"/c/useCdkey",data:{userId:l.default.getUid(),cdkStr:e,channelId:0}}))},t.DEBUG=!0,t=o=__decorate([u],t)}(n.default);o.default=d,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../Const":"Const","./mgrCop":"mgrCop","./mgrNative":"mgrNative","./mgrPlayer":"mgrPlayer","./mgrRecord":"mgrRecord","./mgrTip":"mgrTip"}],mgrShop:[function(e,t,o){"use strict";cc._RF.push(t,"5912dgiR6xC2LqgHfLrNM7b","mgrShop"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrCfg"),r=e("./mgrPlayer"),i=e("./mgrTip"),s=e("./mgrDirector"),c=e("./mgrSdk"),l=e("../Const"),u=e("./mgrAd"),d=e("./mgrAlu"),p=e("../../ulframework/utils/Tools"),h=cc._decorator.ccclass,f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this.registerListeners({MSG_SDK_PAY_SUC:this.onMsgSdkPaySuc})},t.loadRecord=function(){e.loadRecord.call(this)},t.saveRecord=function(){e.saveRecord.call(this)},t.getAllShopItemListByCategory=function(e){if(!e)return[];for(var t={},o=0;o<e.length;o++){var n=e[o];t[n]=!0}var r=[];return a.default.forDb_from_shop_template_db(function(e,o){t[o.category]&&d.default.check(o.aluId)&&r.push(o)}),r=p.default.sortArrayByField(r,["-order","id"])},t.requestBuy=function(e){var t=a.default.get_from_shop_template_db(e);if(t){var o=t.price,n=t.priceUnit;if(0!=n){if(!a.default.get_from_item_template_db(n))return!1;r.default.getItemAmount(n)<o?(this.tipItemNotEnough(n),this.tryOpenShop(n)):(r.default.addItemAmount(n,-o,"\u8d2d\u4e70\u6d88\u8017"),this.responseBuy(e))}else c.default.openPay(t.payId)}},t.responseBuy=function(e){var t=a.default.get_from_shop_template_db(e);if(t){for(var o=0;o<t.items.length;o++){var n=t.items[o],s=n[0],l=n[1],u=n[2];r.default.addItemAmount(s,l,"\u8d2d\u4e70"),u||i.default.addGotItemTip(s,l,null)}this.sendMsg("MSG_SHOP_BUY_SUCCESSED",{shopId:e}),c.default.statisOnItemBought(e,1,"\u8d2d\u4e70")}},t.getShopIdByPayId=function(e){var t;return a.default.forDb_from_shop_template_db(function(o,n){if(n.payId==e)return t=n.id,!0}),t},t.tipItemNotEnough=function(e){void 0===e&&(e=l.default.ITEM_ID_GOLD);var t=a.default.get_from_item_template_db(e);t&&i.default.showMsgTip(ul.format("[%s]\u4e0d\u8db3",t.name))},t.tryOpenShop=function(e){void 0===e&&(e=l.default.ITEM_ID_GOLD);var t="";switch(e){case l.default.ITEM_ID_GOLD:t="free_gold";break;case l.default.ITEM_ID_ENERGY:t="free_energy"}var o=u.default.preCheckCanTriggerAdEventWithoutCd(t),n=c.default.isOpenPay();(o||n)&&s.default.openDialog("vShopDialog")},t.canSupplyItem=function(e){return void 0===e&&(e=l.default.ITEM_ID_GOLD),!(e!=l.default.ITEM_ID_GOLD&&e!=l.default.ITEM_ID_ENERGY||!c.default.isOpenPay())||(!(e!=l.default.ITEM_ID_GOLD||!u.default.preCheckCanTriggerAdEventWithoutCd("free_gold"))||!(e!=l.default.ITEM_ID_ENERGY||!u.default.preCheckCanTriggerAdEventWithoutCd("free_energy")))},t.onMsgSdkPaySuc=function(e){var t=e,o=this.getShopIdByPayId(t.payId);this.responseBuy(o)},t=__decorate([h],t)}(n.default);o.default=f,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Tools":"Tools","../Const":"Const","./mgrAd":"mgrAd","./mgrAlu":"mgrAlu","./mgrCfg":"mgrCfg","./mgrDirector":"mgrDirector","./mgrPlayer":"mgrPlayer","./mgrSdk":"mgrSdk","./mgrTip":"mgrTip"}],mgrSign:[function(e,t,o){"use strict";cc._RF.push(t,"039108UaRpFWr4CM1+LI6AB","mgrSign"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrRecord"),r=e("../Const"),i=e("../../ulframework/utils/Tools"),s=e("./mgrCfg"),c=e("./mgrPlayer"),l=cc._decorator,u=l.ccclass,d=(l.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,t.onLoad=function(){e.onLoad.call(this),this.loadRecord()},t.loadRecord=function(){e.loadRecord.call(this);var t=a.default.getData("sign")||{};this.signedDay=t.signedDay||0,this.signedIndex=t.signedIndex||0,this.lastSignTime=t.lastSignTime||0},t.saveRecord=function(){e.saveRecord.call(this);var t={signedDay:this.signedDay,signedIndex:this.signedIndex,lastSignTime:this.lastSignTime};a.default.setData("sign",t)},t.getState=function(){if(i.default.isOneDay(i.default.time(),this.lastSignTime)){var e=this.getSignDay(),t=this.getSignIndex();return(o=(s.default.get("sign_db",e)||[])[t])?this.lastSignTime+o.rewardGap<=i.default.time()?r.SignState.canSign:r.SignState.waitGap:r.SignState.signed}var o;e=this.getSignDay();return(o=s.default.quietGet("sign_db",e,0))?r.SignState.canSign:r.SignState.signOver},t.getSignDay=function(){return i.default.isOneDay(i.default.time(),this.lastSignTime)?this.signedDay:this.signedDay+1},t.getSignIndex=function(){return i.default.isOneDay(i.default.time(),this.lastSignTime)?this.signedIndex:0},t.getSignedDayCount=function(){return this.signedDay},t.sign=function(){var e={bSuccessd:!1};if(this.getState()!=r.SignState.canSign)return e;var t=this.getSignDay(),o=this.getSignIndex(),n=s.default.get_from_sign_db(t,o);this.lastSignTime=i.default.time(),this.signedDay=t,this.signedIndex=o+1,this.saveRecord();var a=n.rewardItemId,l=n.rewardAmount;return c.default.addItemAmount(a,l,"\u7b7e\u5230"),e.bSuccessd=!0,e.rewardItemId=a,e.rewardAmount=l,e},t.getRemainTime=function(){if(this.getState()!=r.SignState.waitGap)return 0;var e=this.getSignDay(),t=this.getSignIndex(),o=(s.default.get("sign_db",e)||[])[t];if(!o)return 0;var n=this.lastSignTime+o.rewardGap;return Math.max(0,n-i.default.time())},t.getBadgeCout=function(){return o.getState()==r.SignState.canSign?1:0},t.getAllRewardParts=function(){var e=[];return s.default.forDb("sign_db",function(t,o){for(var n=0;n<o.length;n++){var a=o[n].rewardItemId,i=s.default.get_from_item_template_db(a);i&&i.flag==r.default.ITEM_FLAG_PART&&e.push(a)}}),e},t.isSignOver=function(){return 7==this.signedDay&&this.getState()==r.SignState.signOver},t.signedDay=null,t.signedIndex=null,t.lastSignTime=null,t=o=__decorate([u],t)}(n.default));o.default=d,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Tools":"Tools","../Const":"Const","./mgrCfg":"mgrCfg","./mgrPlayer":"mgrPlayer","./mgrRecord":"mgrRecord"}],mgrSound:[function(e,t,o){"use strict";cc._RF.push(t,"d62efGiv1FBWZE+W4nbmQMF","mgrSound"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrRecord"),r=e("./mgrCfg"),i=e("./mgrDirector"),s=cc._decorator.ccclass,c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,t.onLoad=function(){e.onLoad.call(this),this.loadRecord(),cc.game.on(cc.game.EVENT_HIDE,function(){cc.log("cc.game.EVENT_HIDE"),o.pauseSound()}),cc.game.on(cc.game.EVENT_SHOW,function(){cc.log("cc.game.EVENT_SHOW"),o.resumeSound()})},t.loadRecord=function(){e.loadRecord.call(this);var t=a.default.getData("sound")||{};this.musicVolume=null!=t.musicVolume?t.musicVolume:1,this.effectVolume=null!=t.effectVolume?t.effectVolume:1,this.setMusicVomue(this.musicVolume,!0),this.setEffectVolume(this.effectVolume,!0)},t.saveRecord=function(){e.saveRecord.call(this);var t={musicVolume:this.musicVolume,effectVolume:this.effectVolume};a.default.setData("sound",t)},t.play=function(e){var t=this,o=this.allAudioClips[e],n=r.default.get("sound_db",e);if(n)if(1==n.type){if(e==this.playingMusicSoundId)return;if(this.playingMusicSoundId=e,o){(a=i.default.getSharingMusicAudioResource()).clip=o,a.volume=this.musicVolume,a.play()}else{if(!(s=this.getUrl(e)))return;i.default.loadRes(s,cc.AudioClip,function(o,n){if(t.allAudioClips[e]=n,e==t.playingMusicSoundId){var a=i.default.getSharingMusicAudioResource();a.clip=n,a.volume=t.musicVolume,a.play()}})}}else if(o){var a;(a=i.default.getSharingEffectAudioResource()).clip=o,a.volume=this.effectVolume,a.play()}else{var s;if(!(s=this.getUrl(e)))return;i.default.loadRes(s,cc.AudioClip,function(o,n){t.allAudioClips[e]=n;var a=i.default.getSharingEffectAudioResource();a.clip=n,a.volume=t.effectVolume,a.play()})}},t.getUrl=function(e){var t=r.default.get_from_sound_db(e);if(!t)return"";var o=t.fileName.split(".");return 2!=o.length?t.fileName:o[0]},t.stopAll=function(){cc.audioEngine.stopAll(),this.playingMusicSoundId=null,i.default.getSharingMusicAudioResource().stop(),i.default.getSharingEffectAudioResource().stop()},t.stopBgm=function(){i.default.getSharingMusicAudioResource().stop()},t.pauseSound=function(){i.default.getSharingMusicAudioResource().pause(),i.default.getSharingEffectAudioResource().pause(),console.info("\u6682\u505c\u58f0\u97f3")},t.resumeSound=function(){console.info("\u6062\u590d\u58f0\u97f3"),i.default.getSharingMusicAudioResource().resume(),i.default.getSharingEffectAudioResource().resume()},t.getMusicVolmue=function(){return this.musicVolume},t.setMusicVomue=function(e,t){this.musicVolume=e,i.default.getSharingMusicAudioResource().volume=this.musicVolume>=0?this.musicVolume:0,t||this.saveRecord()},t.getEffectVolume=function(){return this.effectVolume},t.setEffectVolume=function(e,t){this.effectVolume=e,i.default.getSharingEffectAudioResource().volume=this.effectVolume>=0?this.effectVolume:0,t||this.saveRecord()},t.playingMusicSoundId=null,t.musicVolume=1,t.effectVolume=1,t.allAudioClips={},t=o=__decorate([s],t)}(n.default);o.default=c,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","./mgrCfg":"mgrCfg","./mgrDirector":"mgrDirector","./mgrRecord":"mgrRecord"}],mgrStage:[function(e,t,o){"use strict";cc._RF.push(t,"62d25C1vvlEvY/VQxvAbWbd","mgrStage"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrCfg"),r=e("./mgrRecord"),i=e("./mgrTip"),s=e("./mgrPlayer"),c=e("../Const"),l=e("./mgrDebug"),u=e("./mgrAchievement"),d=e("./mgrShop"),p=e("./mgrSdk"),h=cc._decorator.ccclass,f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,t.onLoad=function(){e.onLoad.call(this),this.loadRecord()},t.loadRecord=function(){var t=this;e.loadRecord.call(this);var o=r.default.getData("stage")||{};this.stageDatas=o.stageDatas||{},this.stageProgress=o.stageProgress||0,this.chapterOpened=o.chapterOpened||null,this.powerCount=o.powerCount||0,this.chapterOpened||(this.chapterOpened={},a.default.forDb_from_stage_chapter_db(function(e,o){t.chapterOpened[o.id]=o.bOpen})),a.default.forDb_from_stage_db(function(e,o){var n=t.stageDatas[o.id]||{rating:0};t.stageDatas[o.id]=n})},t.saveRecord=function(){e.saveRecord.call(this);var t={stageDatas:this.stageDatas,stageProgress:this.stageProgress,chapterOpened:this.chapterOpened,powerCount:this.powerCount};r.default.setData("stage",t)},t.tryBeginStage=function(e){var t=a.default.get_from_stage_db(e);if(!t)return cc.warn("mgrStage.tryBeginStage stage not found!",e),i.default.showMsgTip("stage not found!"+e),!1;if(!this.isStageUnlocked(e))return i.default.showMsgTip("\u5c1a\u672a\u89e3\u9501"),!1;var o=t.costs,n=c.default.ITEM_ID_ENERGY;return!(s.default.getItemAmount(n)<o)||(d.default.tipItemNotEnough(n),d.default.tryOpenShop(n),!1)},t.checkStageCost=function(e){var t=a.default.get_from_stage_db(e);if(!t)return!1;var o=t.costs,n=c.default.ITEM_ID_ENERGY;return!(s.default.getItemAmount(n)<o)},t.beginStage=function(e){a.default.get_from_stage_db(e)?p.default.statisOnStageStart(e):cc.warn("mgrStage.beginStage stage not found!",e)},t.getRatingByRemainTime=function(e,t){var o=a.default.get_from_stage_db(e),n=o.starCalcTime,r=n[0],i=n[1],s=t/o.time;return s>=i?3:s>=r?2:s>0?1:0},t.finishStage=function(e,t){var n=a.default.get_from_stage_db(e);if(n){var r=this.getStageRating(e),i=!1;n.stageProgress&&n.stageProgress>0&&this.stageProgress<n.stageProgress&&(this.stageProgress=n.stageProgress);var l=this.getRatingByRemainTime(e,t);l>r&&(this.stageDatas[e].rating=l,i=!0);var u=n.passReward;i&&r<=0?(u=n.firstReward,s.default.addItemAmount(c.default.ITEM_ID_GOLD,u,"\u5173\u5361")):u>0&&s.default.addItemAmount(c.default.ITEM_ID_GOLD,u,"\u5173\u5361"),i&&(this.sendMsg("MSG_STAGE_RATING_CHAGNED",{stageId:e,rating:l}),this.saveRecord());var d=n.costs;return d>0&&s.default.addItemAmount(c.default.ITEM_ID_ENERGY,-d,"\u5173\u5361\u6d88\u8017"),l>=1&&o.tryAddPowerCount(),{stageId:e,rating:l,rewardNum:u}}cc.warn("mgrStage.finishStage stage not found!",e)},t.openChapter=function(e){this.chapterOpened[e]=!0,this.saveRecord()},t.getStageProgress=function(){return this.stageProgress},t.getStageRating=function(e){var t=this.stageDatas[e];return t&&t.rating||0},t.isStageUnlocked=function(e){if(l.default.bUnlockAllStage)return!0;var t=a.default.get_from_stage_db(e);if(!t)return!1;for(var o=t.unlockAids,n=0;n<o.length;n++){var r=o[n];if(!u.default.isAchievementCompleted(r))return!1}return!0},t.calcChapterIdByStageId=function(e){var t;return a.default.forDb("stage_chapter_db",function(o,n){0;for(var a=0;a<n.stageIds.length;a++)if(e==n.stageIds[a])return t=n.id,!0}),t},t.getLastChapterId=function(){var e=this,t=0;return a.default.forDb_from_stage_db(function(o,n){if(t=n.id,n.stageProgress==e.getStageProgress()+1)return!0}),this.calcChapterIdByStageId(t)},t.isChapterOpen=function(e){return!e||(this.chapterOpened[e]||!1)},t.isEndDoubleReward=function(){return this.bEndDoubleReward},t.setEndDoubleReward=function(e){this.bEndDoubleReward=e},t.tryAddPowerCount=function(){this.powerCount++,this.powerCount>5&&(this.powerCount=5)},t.cleanPowerCount=function(){this.powerCount=0},t.getPowerCountAndMax=function(){return[this.powerCount,5]},t.isPowerFull=function(){return 5==this.powerCount},t.stageDatas={},t.chapterOpened=null,t.bEndDoubleReward=!0,t.powerCount=0,t=o=__decorate([h],t)}(n.default);o.default=f,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../Const":"Const","./mgrAchievement":"mgrAchievement","./mgrCfg":"mgrCfg","./mgrDebug":"mgrDebug","./mgrPlayer":"mgrPlayer","./mgrRecord":"mgrRecord","./mgrSdk":"mgrSdk","./mgrShop":"mgrShop","./mgrTip":"mgrTip"}],mgrText:[function(e,t,o){"use strict";cc._RF.push(t,"ef6686BEbZOV7JvEBZVSsF+","mgrText"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrCfg"),r=cc._decorator.ccclass,i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this.textMapping={},this.processTextDb()},t.loadRecord=function(){e.loadRecord.call(this)},t.saveRecord=function(){e.saveRecord.call(this)},t.processTextDb=function(){var e=this;a.default.forDb("text_db",function(t,o){e.textMapping[t]=o.text})},t.get=function(e){var t=this.textMapping[e];return t||(t=e),t},t.format=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];var n=this.textMapping[e];return n?ul.format.apply(ul,[n].concat(t)):ul.format("%%s%",e)},t=__decorate([r],t)}(n.default);o.default=i,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","./mgrCfg":"mgrCfg"}],mgrTip:[function(e,t,o){"use strict";cc._RF.push(t,"5653cyPaHRLGYVjQSV6Sg4n","mgrTip"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrDirector"),r=e("../../ulframework/utils/Timer"),i=e("../view/dialog/vPromptDialog"),s=e("../view/node/vMsgTip"),c=e("../Const"),l=e("./mgrCfg"),u=e("../../ulframework/utils/Tools"),d=e("./mgrPool"),p=e("./mgrShop"),h=e("./mgrAd"),f=e("./mgrPlayer"),g=e("../view/node/vMark"),m=e("../view/dialog/vDebugPickerDialog"),v=cc._decorator.ccclass,_=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}var o;return __extends(t,e),o=t,t.onLoad=function(){e.onLoad.call(this),this.msgTipQueue=[],this.iconTipQueue={}},t.loadRecord=function(){e.loadRecord.call(this)},t.saveRecord=function(){e.saveRecord.call(this)},t.showPicker=function(e,t,o){new m.default({title:e,conf:t,callback:o}).openDialog(!0)},t.alertPrompt0=function(e,t){return this._alertPrompt(e,t,[],[])},t.alertPrompt=function(e,t,o,n){return this._alertPrompt(e,t,[o],[n])},t.alertPrompt2=function(e,t,o,n,a,r){return this._alertPrompt(e,t,[o,n],[a,r])},t.alertPrompt3=function(e,t,o,n,a,r,i,s){return this._alertPrompt(e,t,[o,n,a],[r,i,s])},t._alertPrompt=function(e,t,o,n){var a=new i.default({title:e,content:t,btnTexts:o,callbacks:n});return a.openDialog(),a},t.showMsgTip=function(e,t,o,n,i){if(t=t||cc.v2(.5*a.default.width,.75*a.default.height),this.msgTipQueue.push({text:e,startPosition:t,color:o,outlineColor:n,deltaY:i}),!this.msgTipTimer){var s=new r.default(1,-1,this._onMsgTipTimerLoop.bind(this));s.start(!0),this.msgTipTimer=s,this._onMsgTipTimerLoop(s)}},t._onMsgTipTimerLoop=function(e){if(this.msgTipQueue.length<=0)return e.stop(),void(this.msgTipTimer=null);var t=this.msgTipQueue.shift(),o=new s.default;o.setText(t.text),t.color&&o.setColorEx(t.color,t.outlineColor),o.play(t.startPosition,t.deltaY)},t.getTipRootNode=function(){var e=a.default.getUIRoot(),t=e.getChildByName("__tip_root__");return cc.isValid(t)||((t=new cc.Node).parent=e,t.name="__tip_root__",t.zIndex=c.default.GLOBAL_ORDER_TIP),t},t.getTipIconRootNode=function(){var e=a.default.getUIRoot(),t=e.getChildByName("__tip_icon_root__");return cc.isValid(t)||((t=new cc.Node).parent=e,t.name="__tip_icon_root__",t.zIndex=c.default.GLOBAL_ORDER_TIP_ICON),t},t.getTipIceNode=function(){var e=a.default.getUIRoot(),t=e.getChildByName("__tip_ice__");return cc.isValid(t)||((t=new cc.Node).parent=e,t.name="__tip_ice__",t.position=cc.v2(-a.default.width/2,-a.default.height/2),t.zIndex=c.default.GLOBAL_ORDER_TIP),t},t.addGotItemTip=function(e,t,o,n){this.defaultGotItemQueue.push({itemId:e,amount:t,amountSteps:o,customerContext:n}),this._tryShowGotItemDialog()},t.insertGotItemTip=function(e,t,o,n){this.defaultGotItemQueue.unshift({itemId:e,amount:t,amountSteps:o,customerContext:n}),this._tryShowGotItemDialog()},t.addGotItemTipGroup=function(e){var t=this,o=null;u.default.forEachMap(this.gotItemQueues,function(e,n){if(n!=t.defaultGotItemQueue&&n.length<=0)return o=n,!0}),o||(o=[],this.gotItemQueues.push(o));for(var n=0;n<e.length;n++){var a=e[n];o.push(a)}this._tryShowGotItemDialog()},t._tryShowGotItemDialog=function(){for(var e=this,t=function(t){var n=o.gotItemQueues[t];if(!o.gotItemDialogShowingFlags[t]&&n.length>0){o.gotItemDialogShowingFlags[t]=!0;var r=n.shift(),i={};r.customerContext&&u.default.forEachMap(r.customerContext,function(e,t){i[e]=t}),i.itemId=r.itemId,i.amount=r.amount,i.amountSteps=r.amountSteps,i.fOnDialogClose=function(){e.gotItemDialogShowingFlags[t]=!1,r.customerContext&&r.customerContext.fOnDialogClose instanceof Function&&r.customerContext.fOnDialogClose(),e._tryShowGotItemDialog()},a.default.openDialog("vGotItemDialog",i)}},o=this,n=0;n<this.gotItemQueues.length;n++)t(n)},t.isAllGotItemTipDisplayed=function(){var e=!1;if(u.default.forEachMap(this.gotItemDialogShowingFlags,function(t,o){if(o)return e=!0,!0}),e)return!1;for(var t=0;t<this.gotItemQueues.length;t++){if(this.gotItemQueues[t].length>0)return!1}return!0},t.showItemDetailDialog=function(e,t,o){o=o||{},null==t&&(t=1),o.itemId=e,o.amount=t;a.default.openDialog("vItemDetailDialog",o)},t.isWaitingDialogOpened=function(){return null!=this.waitingDialog},t.openWaitingDialog=function(e,t,o){var n=this;if(!this.isWaitingDialogOpened()){var a=new i.default({title:e||"\u63d0\u793a",content:t||"\u8bf7\u7a0d\u5019...",btnTexts:[o||"\u53d6\u6d88"],fOnDialogClose:function(){n.waitingDialog=null}});a.openDialog(),this.waitingDialog=a}},t.closeWaitingDialog=function(){this.waitingDialog&&(this.waitingDialog.closeDialog(),this.waitingDialog=null)},t.playParticleOnce=function(e,t,o,n,a){var r=d.default.get("particle",e);r&&(r.parent=a||this.getTipRootNode(),r.position=r.parent.convertToNodeSpace(cc.v2(t,o)),null!=n&&(r.scale=n),r.setAutoRemoveOnFinish(!0))},t.playSpineOnce=function(e,t,o,n,a){var r=d.default.get("spine",e);r&&(r.parent=a||this.getTipRootNode(),r.position=r.parent.convertToNodeSpace(cc.v2(t,o)),null!=n&&(r.scale=n),r.play("mov_1",!1),r.registerEventCallback(function(e){"cpmplete"==e.name&&(r.removeFromParent(),d.default.put(r),r=null)}))},t.playAnimNodeOnce=function(e,t,o,n,a,r,i){var s=new cc.Node,c=d.default.get("animNode",e);c&&(s.parent=r||this.getTipRootNode(),c.parent=s,s.position=r?cc.v2(t,o):s.parent.convertToNodeSpace(cc.v2(t,o)),n&&(s.scaleX=n),a&&(s.scaleY=a),i&&(s.rotation=i),c.play(),c.registerEventCallback(function(e){"finished"==e.name&&(c.removeFromParent(),d.default.put(c),c=null,s.destroy())}))},t.showIconTips=function(e,t,o,n,i){var s=l.default.get("item_template_db",e,"icon"),c=ul.format("*%d",t);if(o=o||new cc.Vec2(0,0),n=n||new cc.Vec2(60,60),o=cc.v2(o.x-a.default.width/2,o.y-a.default.height/2),n=cc.v2(n.x-a.default.width/2,n.y-a.default.height/2),i){var u=.5;this.iconTipQueue[i]||(this.iconTipQueue[i]=[]),0==this.iconTipQueue[i].length&&(u=0),this.iconTipQueue[i].push({icon:s,startPos:o,endPos:n,text:c,interval:u}),this.iconTipTimer||(this.iconTipTimer=new r.default(.1,-1,this._onShowIconTimerCallback.bind(this)),this.iconTipTimer.start(!0))}else this._playShowIcon({icon:s,startPos:o,endPos:n,text:c})},t.showIconTipsWithAdRewardCheck=function(e,t,o,n,a){var r="got_item_addition_reward";if(h.default.preCheckCanTriggerAdEvent(r)){cc.log("vGotItemDialog.initAdRewad trigger a ad reward.",r);var i=l.default.get("ad_event_db",r),s=f.default.openItemBox(i.param.rewardBoxId);this.addGotItemTip(e,t,null,{adEventId:r,adRewards:s})}else this.showIconTips(e,t,o,n,a)},t._onShowIconTimerCallback=function(){var e=this,t=!0;if(u.default.forEachMap(this.iconTipQueue,function(e,o){o&&o.length>0&&(t=!1)}),t)return this.iconTipTimer.stop(),void(this.iconTipTimer=null);u.default.forEachMap(this.iconTipQueue,function(t,o){if(o&&o.length>0){var n=o[0];n.interval-=.1,n.interval<=0&&(n=o.shift(),e._playShowIcon(n))}else e.iconTipQueue[t]=[]})},t._playShowIcon=function(e){},t.showCommonRouter=function(e,t){var n=this,a=l.default.get("item_template_db",e),r=a.buySource||1,i=l.default.get("common_router_db",r),s=this["__checkCommonRouter"+i.router.toString()];if(s instanceof Function){var c=s({itemId:e});if(1!=c){if(0==c){var u=this["__commonRouter"+i.router.toString()],d={};return d.param=i.param||{},d.itemId=e,d.reason=t,u(d)}return o.showMsgTip(ul.format("%s\u4e0d\u8db3",a.name)),void cc.warn("error: this router is checked, and not pass"+e)}}else cc.warn("error: this router is not exist!!!"+e);o.showItemDetailDialog(e,null,{callback:function(){var o=n["__commonRouter"+i.router.toString()],a={};return a.param=i.param||{},a.itemId=e,a.reason=t,o(a)},bCanBuy:1==i.router,bCanGet:1!=i.router,routerDes:i.name})},t.__commonRouter1=function(e){var t=e.itemId;return l.default.quietGet("shop_template_db",t)?(p.default.requestBuy(t,1,e.reason),!0):(l.default.get("shop_router_db",e.itemId)&&p.default.showRouterTargetWithDialog(e.itemId,e.reason),!0)},t.__commonRouter2=function(e){return!0},t.__commonRouter3=function(e){return!0},t.__checkCommonRouter1=function(e){return l.default.get("shop_template_db",e.itemId)?1:l.default.get("shop_router_db",e.itemId)?0:-1},t.__checkCommonRouter2=function(e){return 1},t.__checkCommonRouter3=function(e){return 1},t.__checkCommonRouter4=function(e){return 1},t.__checkCommonRouter5=function(e){return 1},t.setCountBadgeValue=function(e,t,o,n,a){var r=e.__mark;if(t>0){r||(r=new g.default,e.addChild(r,99),e.__mark=r),o=o||0,n=n||0,a=a||1;var i=e.getContentSize();r.setPosition(i.width/2*.8+o,i.height/2*.8+n),r.scale=a,r.setCount(t)}else r&&(e.removeChild(r),e.__mark=null)},t.addChildToCanvas=function(e,t){e.parent=this.getTipRootNode(),e.setPosition(e.parent.convertToNodeSpace(t))},t.playIconTip=function(e,t,o,n){void 0===n&&(n=!1)},t.playBlood=function(e,t){var o=this;a.default.loadRes("2d/anim_node/blood_boom/blood_boom",cc.Prefab,function(n,a){if(!n){var r=cc.instantiate(a);r.parent=o.getTipRootNode(),r.position=r.parent.convertToNodeSpace(cc.v2(e,t))}})},t.defaultGotItemQueue=[],t.gotItemQueues=[o.defaultGotItemQueue],t.gotItemDialogShowingFlags={},t.waitingDialog=null,t=o=__decorate([v],t)}(n.default);o.default=_,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","../../ulframework/utils/Timer":"Timer","../../ulframework/utils/Tools":"Tools","../Const":"Const","../view/dialog/vDebugPickerDialog":"vDebugPickerDialog","../view/dialog/vPromptDialog":"vPromptDialog","../view/node/vMark":"vMark","../view/node/vMsgTip":"vMsgTip","./mgrAd":"mgrAd","./mgrCfg":"mgrCfg","./mgrDirector":"mgrDirector","./mgrPlayer":"mgrPlayer","./mgrPool":"mgrPool","./mgrShop":"mgrShop"}],mgrUnitTest:[function(e,t,o){"use strict";cc._RF.push(t,"d38b3oLvxpNuaKnX1HT6A6J","mgrUnitTest"),cc._RF.pop()},{}],mgrWordFilter:[function(e,t,o){"use strict";cc._RF.push(t,"a1118JdzxdJhYgV0aWBnGCX","mgrWordFilter"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../ulframework/manager/Manager"),a=e("./mgrCfg"),r=cc._decorator.ccclass,i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.onLoad=function(){e.onLoad.call(this),this._loadWords()},t.loadRecord=function(){e.loadRecord.call(this)},t.saveRecord=function(){e.saveRecord.call(this)},t._loadWords=function(){if(!this.badwords){var e=a.default.getDb("badword_db");this._processBadwords(e)}},t._processBadwords=function(e){this.badwords=e},t.checkStr=function(e){if(!e)return!0;for(var t=this.badwords,o=0;o<t.length;o++)if(e.match(t[o]))return!1;return!0},t.filterStr=function(e,t){t=t||this.REP_STR;for(var o=this.badwords,n=0;n<o.length;n++)e=e.replace(o[n],t);return e},t.hasSymbol=function(e){return!!e.match(this.REP_NO_SYMBOL)},t.filterSymbol=function(e){return e?e=e.replace(this.REP_NO_SYMBOL,""):""},t.REP_STR="**",t.REP_NO_SYMBOL=/[\!\@\#\$\%\^\&\*\(\)\`\~\<\>\,\.\/\?\;\:\'\"\[\]\{\}\\\|\-\=\_\+\n\r\t\b ]/g,t=__decorate([r],t)}(n.default);o.default=i,cc._RF.pop()},{"../../ulframework/manager/Manager":"Manager","./mgrCfg":"mgrCfg"}],sAchievement:[function(e,t,o){"use strict";cc._RF.push(t,"2e26eNZ+xdEfJTn72iLqHxo","sAchievement"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../Const"),a=e("../manager/mgrCfg"),r=e("../manager/mgrAchievement"),i=e("../manager/mgrPlayer"),s=e("../manager/mgrStage"),c=["data1","data2","data3","data4"],l=function(){function e(e){this.id=e,this.template=a.default.get("achievement_db",e),this.count=0,this.maxCount=0,this.state=n.AchievementState.unlocked}return e.prototype.setState=function(e){this.state=e},e.prototype.refreshCount=function(e){var t=this.template.targetType,o=a.default.get("achievement_target_db",t);if(o){if(!e||o.cmdHash[e]){var n=this[o.calcCountHandlerName];if(n instanceof Function){var i=n.bind(this)(),s=i[0],c=i[1],l=null!=this.count&&this.count!=s;this.count=s,this.maxCount=c,l&&r.default.sendMsg("MSG_ACHIEVEMENT_COUNT_CHANGED",{achievementId:this.id})}else cc.warn(ul.format("sAchievement.refreshCount handler not found! handler = %s",o.calcCountHandlerName))}}else cc.warn(ul.format("sAchievement.refreshCount target not found! targetType = %s",t))},e.prototype.refreshState=function(e){return(this.state==n.AchievementState.unlocked||0==this.maxCount)&&(this.refreshCount(e),this.state==n.AchievementState.unlocked&&this.maxCount<=this.count&&(this.state=n.AchievementState.finished,!0))},e.prototype._calcCount1=function(){var e=this.template,t=e.data1;return 1,[e.data2<=s.default.getStageRating(t)?1:0,1]},e.prototype._calcCount2=function(){var e=this.template,t=0,o=e.data1,n=e.data2,r=e.data3,i=a.default.quietGet("stage_chapter_db",o);if(t=0,i)for(var c=0;c<i.stageIds.length;c++){var l=i.stageIds[c];r<=s.default.getStageRating(l)&&t++}else cc.warn("sAchievement._calcCount2 chapter not found!",o);return[t,n]},e.prototype._calcCount4=function(){var e=this.template,t=e.data1,o=e.data2;return[i.default.getItemAmount(t),o]},e.prototype._calcCount5=function(){var e=this.template,t=e.data1,o=e.data2;return[this.__getItemAmountByFlag(t),o]},e.prototype._calcCount7=function(){var e=this.template,t=e.data1,o=e.data2;return[i.default.getItemHistoryGotAmount(t),o]},e.prototype._calcCount10=function(){var e=0,t=1,o=this.template.data1,n=a.default.quietGet("suit_db",o);if(n){for(var r=0;r<n.partIds.length;r++){var s=n.partIds[r];i.default.getItemAmount(s)>0&&e++}t=n.partIds.length}else cc.warn("sAchievement._calcCount10 suit not found!",o);return[e,t]},e.prototype._calcCount20=function(){for(var e=this.template,t=0,o=0,n=0;n<c.length;n++){var a=e[c[n]];a&&(o++,r.default.isAchievementCompleted(a)&&t++)}return[t,o]},e.prototype._calcCount21=function(){var e=0,t=0,o=this.template.customData.itemIds;if(o){t=o.length;for(var n=0;n<o.length;n++){var a=o[n];i.default.getItemAmount(a)>0&&e++}}return[e,t]},e.prototype.__getItemAmountByFlag=function(e){var t=0;return a.default.forDb("item_template_db",function(o,n){n.flag==e&&i.default.getItemAmount(n.id)>0&&(t+=1)}),t},e}();o.default=l,cc._RF.pop()},{"../Const":"Const","../manager/mgrAchievement":"mgrAchievement","../manager/mgrCfg":"mgrCfg","../manager/mgrPlayer":"mgrPlayer","../manager/mgrStage":"mgrStage"}],sAvatar:[function(e,t,o){"use strict";cc._RF.push(t,"4d15asI5pJCY5zDpnp/Sjh2","sAvatar"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../manager/mgrCake"),a=e("./../manager/mgrCfg"),r=function(){function e(){this.zIndex2Res={},this.partIds=[]}return e.prototype.replace=function(e){if(this.partIds.indexOf(e)>=0)return!1;var t=a.default.get_from_cake_part_db(e),o=a.default.get_from_cake_type_db(t.type),r=0;if(o.prePartType>0)for(var i=0;i<this.partIds.length;i++){var s=this.partIds[i];a.default.get_from_cake_part_db(s).type==o.prePartType&&(r=s)}var c=n.default.getResByPartId(e,r),l={};for(var u in c){var d=c[u];if(d){var p=parseInt(u),h=this.zIndex2Res[p];h&&(l[h.fromTo]=h.fromTo),this.zIndex2Res[p]={resType:d.resType,resId:d.resId,pos:d.pos,scale:d.scale,fromTo:e}}}for(var u in this.partIds.push(e),l){var f=parseInt(u);if(l[f]){var g=n.default.getResByPartId(f);for(var m in g)if(g[m]){p=parseInt(m);this.zIndex2Res[p].fromTo==f&&(this.zIndex2Res[p]=null)}this.partIds.splice(this.partIds.indexOf(f),1)}}return!0},e.prototype.takeOff=function(e){if(!(this.partIds.indexOf(e)<0)){var t=n.default.getResByPartId(e);for(var o in t)if(t[o]){var a=parseInt(o);this.zIndex2Res[a]=null}}},e.prototype.takeOffAll=function(){this.partIds=[],this.zIndex2Res={}},e.prototype.getAllPartIds=function(){return this.partIds},e.prototype.getKernelData=function(){return this.zIndex2Res},e}();o.default=r,cc._RF.pop()},{"./../manager/mgrCake":"mgrCake","./../manager/mgrCfg":"mgrCfg"}],sRankPlayer:[function(e,t,o){"use strict";cc._RF.push(t,"0f9ce2j4p9GqZMl94py/JSV","sRankPlayer"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(){function e(e,t,o,n,a){this.uid=e,this.rank=t,this.score=o,this.data=a,this.name=n}return e=__decorate([a],e)}());o.default=r,cc._RF.pop()},{}],sdkDemoModule:[function(e,t,o){"use strict";cc._RF.push(t,"2a787huAmRE6Kdg/RlBzXD7","sdkDemoModule");var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}(),a=i(e("../../ulsdkmanager/ulsdkdemomanager.js")),r=i(e("../../net/sdkdemoULCop.js"));function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}var s="",c=function(){function e(){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,e)}return n(e,[{key:"initModule",value:function(e){var t=a.getConfigByKey("gameId"),o=a.getConfigByKey("copUrl"),n=a.getConfigByKey("gameVersion"),i=this.getChannelConfigByKey("cop_channelId");s=t+"_"+e+"_000",r.initCopInfo(o,i,t,n)}},{key:"setVersion",value:function(){var e=a.getConfigByKey("setVersionDelay");if(r.IsGetCopData)console.log("ULSDK_TEST.........setVersion...\u6570\u636e\u521d\u59cb\u5316\u5b8c\u6210==========console===========",r.IsGetCopData),this.doSetVerSion();else{console.log("ULSDK_TEST........setVersion...\u6570\u636e\u672a\u521d\u59cb\u5316\u5b8c\u6210--------console-----\u5ef6\u65f6------------",e,r.IsGetCopData);this.doSetVerSion()}}},{key:"doSetVerSion",value:function(){console.log("ULSDK_TEST.........doSetVerSion...doSetVerSion--------console-----\u5ef6\u65f6-----",r.IsGetCopData);var e={},t={userId:s,isClosePay:0,isUseSdkRank:!0};e.cmd="/c/getLoginUserMessage",e.data=t;var o=JSON.stringify(e);a.manageSdkResponse(o);var n={cmd:"/c/channelInfoResult"},i={},c=a.getConfigByKey("commonCopConfig"),l=this.getChannelConfigByKey("copDefaultConfig");i.copInfo=r.getCopData(c,l),n.data=i;var u=JSON.stringify(n);a.manageSdkResponse(u)}},{key:"getUserId",value:function(){return s}},{key:"openShare",value:function(e){e.content,e.imagePath;var t=new Object;t.cmd="/c/shareResult";var o=new Object;confirm("\u5206\u4eab\u6a21\u62df \u786e\u5b9a(\u6210\u529f) \u53d6\u6d88(\u5931\u8d25)")?(o.code=1,o.msg="\u5206\u4eab\u6210\u529f\uff01",t.data=o,a.manageSdkResponse(JSON.stringify(t)),console.log("ULSDK_TEST.........\u5206\u4eab\u6210\u529f........console.....errCode..")):(o.code=0,o.msg="\u5206\u4eab\u5931\u8d25\uff01",t.data=o,a.manageSdkResponse(JSON.stringify(t)),console.log("ULSDK_TEST.........\u5206\u4eab\u5931\u8d25........console.....errCode.."))}},{key:"openPay",value:function(e){a.getConfigByKey("gameOrientation");var t=e.payInfo.payId,o=a.getConfigByKey("pay_code");try{o[t].price}catch(t){var n={cmd:"/c/payResult"},r={code:"0",msg:"payId \u4e0d\u5b58\u5728"};r.payData=e,n.data=r;var i=JSON.stringify(n);return void a.manageSdkResponse(i)}if(confirm("\u652f\u4ed8\u6a21\u62df \u786e\u5b9a(\u6210\u529f) \u53d6\u6d88(\u5931\u8d25)")){var s={cmd:"/c/payResult"},c={code:"1",msg:"\u652f\u4ed8\u56de\u8c03\u6210\u529f"};c.payData=e,s.data=c;var l=JSON.stringify(s);a.manageSdkResponse(l)}else{var u={cmd:"/c/payResult"},d={code:"0",msg:"\u8d2d\u4e70\u5931\u8d25\uff01"};d.payData=e,u.data=d;var p=JSON.stringify(u);a.manageSdkResponse(p)}}},{key:"openAdv",value:function(e){var t=new Object;t.code=1,t.msg="\u8fbe\u5230\u770b\u5e7f\u544a\u65f6\u957f\u8981\u6c42\uff0c\u53ef\u4ee5\u4e0b\u53d1\u5956\u52b1",t.advData=e;var o=new Object;o.cmd="/c/advShowResult",o.data=t;var n=JSON.stringify(o);a.manageSdkResponse(n),console.log("ULSDK_TEST.....................\u8fbe\u5230\u770b\u5e7f\u544a\u65f6\u957f\u8981\u6c42\uff0c\u53ef\u4ee5\u4e0b\u53d1\u5956\u52b1.....++++++++++++++++++++...")}},{key:"getChannelConfigByKey",value:function(e){return a.getConfigByKey("limi")[e]}},{key:"saveRankData",value:function(e){var t=new Object;t.cmd="/c/saveRankResult";new Array;var o=new Object;if(confirm("\u6392\u884c\u699c\u6570\u636e\u4e0a\u4f20\u6a21\u62df \u786e\u5b9a(\u6210\u529f) \u53d6\u6d88(\u5931\u8d25)")){o.code="0",o.msg="\u4e0a\u4f20\u6392\u884c\u699c\u6570\u636e\u5931\u8d25!",t.data=o;var n=JSON.stringify(t);a.manageSdkResponse(n),console.log("ULSDK_TEST.....................\u4e0a\u4f20\u6392\u884c\u699c\u6570\u636e\u5931\u8d25.....++++++++++++++++++++...")}else{o.code="1",o.msg="\u4e0a\u4f20\u6392\u884c\u699c\u6570\u636e\u6210\u529f!",t.data=o;var r=JSON.stringify(t);a.manageSdkResponse(r),console.log("ULSDK_TEST.....................\u4e0a\u4f20\u6392\u884c\u699c\u6570\u636e\u6210\u529f.....++++++++++++++++++++...")}}},{key:"getRankData",value:function(e){var t=new Object;t.cmd="/c/getRankResult";new Array;var o=new Object;if(confirm("\u6392\u884c\u699c\u6570\u636e\u83b7\u53d6\u6a21\u62df \u786e\u5b9a(\u6210\u529f) \u53d6\u6d88(\u5931\u8d25)")){o.code="-1",o.msg="\u83b7\u53d6\u6392\u884c\u699c\u6570\u636e\u5931\u8d25!",o.rankList=[],t.data=o;var n=JSON.stringify(t);console.log("ULSDK_TEST.....................\u83b7\u53d6\u6392\u884c\u699c\u6570\u636e\u5931\u8d25.....++++++++++++++++++++..."),a.manageSdkResponse(n)}else{o.code="1",o.msg="\u83b7\u53d6\u6392\u884c\u699c\u6570\u636e\u6210\u529f",o.rankList=[{headUrl:"\u7528\u6237\u5934\u50cf\u5730\u57401",nickName:"\u7528\u6237\u6635\u79f01",score:991,selfFlag:!0},{headUrl:"\u7528\u6237\u5934\u50cf\u5730\u57402",nickName:"\u7528\u6237\u6635\u79f02",score:993,selfFlag:!1}],t.data=o;var r=JSON.stringify(t);console.log("ULSDK_TEST.....................\u83b7\u53d6\u6392\u884c\u699c\u6570\u636e\u6210\u529f.....++++++++++++++++++++..."),a.manageSdkResponse(r)}}}]),e}();t.exports=new c,cc._RF.pop()},{"../../net/sdkdemoULCop.js":"sdkdemoULCop","../../ulsdkmanager/ulsdkdemomanager.js":"ulsdkdemomanager"}],sdkdemoULCop:[function(e,t,o){"use strict";cc._RF.push(t,"b08f6fX4ttO47FYuUvIKSil","sdkdemoULCop"),Object.defineProperty(o,"__esModule",{value:!0}),o.getRequestUrl=a,o.initCopInfo=function(e,t,r,i){var s=a(e,t,r,i);console.log("initCopInfo.......channelId....",t);var c="";c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");c.open("get",s),c.send(),c.onreadystatechange=function(){4==c.readyState&&200==c.status&&(n=c.responseText,console.log("initCopInfo.......copJsonData....",n)),o.IsGetCopData=!0}},o.getCopData=function(e,t){for(var o in t)e[o]=t[o];return JSON.stringify(function(e){if(null==n)return console.log("copObj.....copDataReplace........1111111.",n),e;var t=JSON.parse(n);if(console.log("copObj.....copDataReplace........222222.",n),t.hasOwnProperty("code")&&-1==t.code)return e;for(var o in t)e[o]=t[o];return e}(e))};var n=null;o.IsGetCopData=!1;function a(e,t,o,n){return e=e+"?gameid="+o+"&qudao="+t+"&version="+n}cc._RF.pop()},{}],sdkdemocConfig:[function(e,t,o){"use strict";cc._RF.push(t,"a6fedEOqUlANKU8xsF445Mv","sdkdemocConfig"),Object.defineProperty(o,"__esModule",{value:!0});o.cConfig='{\n\t"gameId": "4",\n\t"gameName":"\u5df4\u5566\u5566\u9b54\u6cd5\u53d8\u8eab2",\n\t"gameVersion": "1.0",\n\t"cdk_app_id": "37",\n\t"megadataServerTypeId": "3",\n\t"openPaySwitch": true,\n\t"setVersionDelay":3000,\n\t"popUpWindowSwitch": false,\n\t"gameOrientation":1,\n\t"popUpWindowMess": "",\n\t"payTimeout": 70000,\n\t"netTimeout":5000,\n\t"timerLoopTime": 5000,\n\t"timerStopTime": 240000,\n\t"copUrl": "http://copv6.ultralisk.cn/getdata/",\n\t"megadataUrl": "http://megadata.ultralisk.cn/appstatusrequest",\n\t"loginUrl": "https://sdkservertest.ultralisk.cn/userlogin",\n\t"useCDKEYUrl": "https://cdkey.ultralisk.cn/commoncdk/usecdk",\n\t"commonCopConfig": {\n\t},\n\t"m4399": {\n\t\t"cop_channelId": "10",\n\t\t"copDefaultConfig": {}\n\t},\n\t"m7724": {\n\t\t"cop_channelId": "11",\n\t\t"m7724_signKey": "1905a4358456744d1905a4358456748b",\n\t\t"m7724_cpPlatFormId": "190",\n\t\t"m7724_cpguid": "1905a43584567406",\n\t\t"m7724_cpgameid": "117",\n\t\t"copDefaultConfig": {}\n\t},\n\t"m7k7k": {\n\t\t"cop_channelId": "12",\n\t\t"m7k7k_gameAppKey": "5bffe621851fe14b9f4f808255909161",\n\t\t"m7k7k_gameAppSecret": "bdaefdb73e0ae5e710298c9254b3e0f3",\n\t\t"copDefaultConfig": {}\n\t},\n\t"m248": {\n\t\t"cop_channelId": "13",\n\t\t"m248_gameId": "245",\n\t\t"m248_channel": "248game",\n\t\t"m248_gameKey": "e8f975016bba81ffa986b87fc06685da",\n\t\t"copDefaultConfig": {}\n\t},\n\t"lehaihai": {\n\t\t"cop_channelId": "14",\n\t\t"lehaihai_key": "WdWKhN4JpcircYC6rc6E4jXXA27JGjhYRdpA8S4x6FJZeMMTRhZy8ceYQdTJPc3AkcGWjSwji5cXbyxQTxdKWtcS3SyTbBTAfdw3mSAYn5fxceC7fa6XYeYwfZ2SEFfN3w528xpxd8b8HsPm2ksrKSfmp22k36fYtsedGPwMtxsnbSFRhE5DFJmXN5Z6KcGdyKt8WpbmQ3zGPpmKKFsSB3dyYwZw7PrWWc6bsiEQHB7Ch4Gr762ZazMcBzAcBzE",\n\t\t"lehaihai_aeskey": "peGzkTTAJDk8SSxM",\n\t\t"lehaihai_aesiv": "ZQrPGtcwQskMJsTr",\n\t\t"copDefaultConfig": {}\n\t},\n\t"lbwan": {\n\t\t"cop_channelId": "15",\n\t\t"lbwan_gameSecret": "gLznWoUHY4",\n\t\t"lbwan_gameId": "10019",\n\t\t"copDefaultConfig": {}\n\t},\n\t"qunhei": {\n\t\t"cop_channelId": "16",\n\t\t"qunhei_key": "0138fbc55c4956e40309e2d84b9abe63",\n\t\t"qunhei_gameId": "3960",\n\t\t"copDefaultConfig": {}\n\t},\n\n\t"suyi": {\n\t\t"suyi_seceret_key": "47d5e9ce0b419a0eae08b6ee7a30e656",\n\t\t"cop_channelId": "17",\n\t\t"copDefaultConfig": {}\n\t},\n\n\t"meitu": {\n\t\t"appid": "",\n\t\t"meitu_seceret_key": "",\n\t\t"game_callback_uri": "https://sdkservertest.ultralisk.cn/paymeitucallback",\n\t\t"init_title": "xxx",\n\t\t"init_pic": "xxx",\n\t\t"init_summary": "xxx",\n\t\t"cop_channelId": "18",\n\t\t"copDefaultConfig": {}\n\t},\n\t"weixin": {\n\t\t"appid": "wx9b51c6c5b567696e",\n\t\t"loginUrl": "https://sdkservertest.ultralisk.cn/wxuserlogin",\n\t\t"appsecret": "7fc4e7bde7d8e52f33ffafd824387595",\n\t\t"offerId":"1450016792",\n\t\t"banner_adunit":"adunit-3cbe241e24786cfa",\n\t\t"video_adunit":"adunit-b0d82ec8ae469446",\n\t\t"env":1,\n\t\t"cop_channelId": "19",\n\t\t"mch_id":"1511216771",\n\t\t"copDefaultConfig": {}\n\t},\n\t"limi":{\n\t\t"gameId": "3047",\n\t\t"appId": "101496230",\n\t\t"cop_channelId": "0",\n\t\t"bannerViewId":1001,\n\t\t"rankNameList":{\n\t\t\t"score":"\u5e78\u8fd0\u5927\u5956\u8d5b",\n\t\t\t"scoreOrder":1,\n\t\t\t"\u5e78\u8fd0\u5927\u5956\u8d5b":"score",\n\t\t\t"\u8d85\u7ea7\u6392\u4f4d\u8d5b":"a1",\n\t\t\t"\u8fb9\u5883\u8d5b":"a3"\n\t\t},\n\t\t"copDefaultConfig": {}\n\t},\n\t"pay_code": {\n        "1": {\n\t\t\t"payCode": "11001",\n\t\t\t"price": "6",\n\t\t\t"limi_payId":1,\n\t\t\t"proName": "\u4f11\u95f2\u793c\u5305"\n\t\t},\n\t\t"2": {\n\t\t\t"payCode": "11002",\n\t\t\t"price": "18",\n\t\t\t"limi_payId":1,\n\t\t\t"proName": "\u7545\u73a9\u793c\u5305"\n\t\t},\n\t\t"3": {\n\t\t\t"payCode": "11003",\n\t\t\t"price": "30",\n\t\t\t"limi_payId":2,\n\t\t\t"proName": "\u8d85\u503c\u91d1\u5e01\u5305"\n\t\t},\n\t\t"4": {\n\t\t\t"payCode": "11004",\n\t\t\t"price": "6",\n\t\t\t"limi_payId":3,\n\t\t\t"proName": "\u523b\u82e6\u4f53\u529b\u5305"\n\t\t},\n\t\t"5": {\n\t\t\t"payCode": "11005",\n\t\t\t"price": "6",\n\t\t\t"limi_payId":4,\n\t\t\t"proName": "\u5c11\u91cf\u94bb\u77f3"\n\t\t},\n\t\t"6": {\n\t\t\t"payCode": "11006",\n\t\t\t"price": "12",\n\t\t\t"limi_payId":5,\n\t\t\t"proName": "\u4e2d\u91cf\u94bb\u77f3"\n\t\t},\n\t\t"9": {\n\t\t\t"payCode": "11009",\n\t\t\t"price": "6",\n\t\t\t"limi_payId":6,\n\t\t\t"proName": "\u5c11\u91cf\u91d1\u5e01"\n\t\t},\n\t\t"10": {\n\t\t\t"payCode": "11010",\n\t\t\t"price": "12",\n\t\t\t"limi_payId":7,\n\t\t\t"proName": "\u5927\u91cf\u91d1\u5e01"\n\t\t},\n\t\t"11": {\n\t\t\t"payCode": "11011",\n\t\t\t"price": "25",\n\t\t\t"limi_payId":8,\n\t\t\t"proName": "\u5ba0\u7269\u5168\u5bb6\u6b22"\n\t\t},\n\t\t"12": {\n\t\t\t"payCode": "11012",\n\t\t\t"price": "1",\n\t\t\t"limi_payId":9,\n\t\t\t"proName": "\u9996\u51b2\u793c\u5305"\n\t\t},\n\t\t"13": {\n\t\t\t"payCode": "11013",\n\t\t\t"price": "12",\n\t\t\t"limi_payId":10,\n\t\t\t"proName": "\u534e\u4e3d\u65f6\u88c5\u5305"\n\t\t},\n\t\t"14": {\n\t\t\t"payCode": "11014",\n\t\t\t"price": "18",\n\t\t\t"limi_payId":11,\n\t\t\t"proName": "\u68a6\u5e7b\u65f6\u88c5\u5305"\n\t\t},\n\t\t"15": {\n\t\t\t"payCode": "11015",\n\t\t\t"price": "25",\n\t\t\t"limi_payId":12,\n\t\t\t"proName": "\u5962\u534e\u65f6\u88c5\u5305"\n\t\t},\n\t\t"16": {\n\t\t\t"payCode": "11016",\n\t\t\t"price": "68",\n\t\t\t"limi_payId":13,\n\t\t\t"proName": "\u53cc\u500d\u94bb\u77f3\u5305"\n\t\t},\n\t\t"23": {\n\t\t\t"payCode": "11023",\n\t\t\t"price": "68",\n\t\t\t"limi_payId":15,\n\t\t\t"proName": "\u53cc\u500d\u91d1\u5e01\u5305"\n\t\t}\n\t}\n}';cc._RF.pop()},{}],sdkdemohttprequest:[function(e,t,o){"use strict";cc._RF.push(t,"4482d71zTNK+L8cYTyEZ65F","sdkdemohttprequest"),Object.defineProperty(o,"__esModule",{value:!0}),o.useCdkey=function(e){var t=e.userId,o=e.cdkStr,a=e.channelId,r=n.getConfigByKey("cdk_app_id"),i=n.getConfigByKey("netTimeout"),s=n.getConfigByKey("useCDKEYUrl")+"?userId="+t+"&cdkStr="+o+"&appId="+r+"&channelId="+a;console.log(s);var c="";c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");c.open("get",s),c.send();var l=!1,u=setTimeout(function(){l=!0,c.abort()},i);c.onreadystatechange=function(){if(l){var e={cmd:"/c/useCdkey"},t={code:"-1",message:"\u8bf7\u6c42\u8d85\u65f6"};e.data=t;var o=JSON.stringify(e);n.manageSdkResponse(o)}if(clearTimeout(u),4==c.readyState&&200==c.status){var a=c.responseText;a=(a=(a=(a=a.replace('"[',"[")).replace(']"',"]")).replace('"0"','"1"')).replace("message","data");var r=JSON.parse(a);console.log("success.....loginRequest.....",r);var i={cmd:"/c/useCdkey"};i.data=r;var o=JSON.stringify(i);n.manageSdkResponse(o)}}},o.postMegaData=function(e,t){var o=n.getCurrentChannel(),a=n.getConfigByKey("gameId"),r=n.getConfigByKey("megadataServerTypeId"),i=n.getConfigByKey("netTimeout"),s=n.getConfigByKey("megadataUrl");console.log("postMegaData....",a,n),e.unshift(a,t,o);var c={};c.typeid=r,c.updata=e;var l="updata="+JSON.stringify(c),u="";u=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");u.open("post",s,!0),u.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),u.send(l);var d=!1,p=setTimeout(function(){d=!0,u.abort()},i);u.onreadystatechange=function(){if(d){console.log("\u5927\u6570\u636e\u8bf7\u6c42--------------\u8d85\u65f6\uff01");var e={cmd:"/c/megadataServer"},t={code:"-1",message:"\u8bf7\u6c42\u8d85\u65f6"};e.data=t;var o=JSON.stringify(e);return n.manageSdkResponse(o),void clearTimeout(p)}if(clearTimeout(p),4==u.readyState&&200==u.status){var a=u.responseText,r={};console.log("success.....postMegaData..resultData...",a);var i={cmd:"/c/megadataServer"};"Successful"==a?(r.code="1",r.message="Successful",console.log("\u5927\u6570\u636e\u8bf7\u6c42--------------Successful\uff01")):(r.code="0",r.message=a),i.data=r;var s=JSON.stringify(i);n.manageSdkResponse(s)}}},o.channelLogin=function(e,t){var o=n.getConfigByKey("netTimeout"),r="userId="+e,i=n.getConfigByKey("loginUrl"),s=n.getCurrentModule();console.log("channelLogin---loginData:",e);try{var c="";(c=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")).open("post",i,!0),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),c.send(r);var l=!1,u=setTimeout(function(){l=!0,c.abort()},o);c.onreadystatechange=function(){if(l)return console.log("\u767b\u5f55\u8bf7\u6c42-\u652f\u4ed8\u6570\u636e---------------\u8d85\u65f6\uff01"),void clearTimeout(u);if(clearTimeout(u),4==c.readyState&&200==c.status){var e=c.responseText;""==e||null==e||void 0==e?console.log("channelLogin--\u670d\u52a1\u7aef\u6570\u636e\u83b7\u53d6\u5f02\u5e38"):"empty"==e?console.log("channelLogin---\u65e0\u652f\u4ed8\u672a\u53d1\u8d27\u8ba2\u5355"):(s.LoginCallback(JSON.parse(e)),"1"==t&&(console.log("ChannelLogin---:\u5b9a\u65f6\u5668\u83b7\u53d6\u5230\u6570\u636e,\u5173\u95ed\u5b9a\u65f6\u5668\u907f\u514d\u591a\u4f59\u8bf7\u6c42\u6d6a\u8d39\u8d44\u6e90-----"),clearTimeout(a.timer))),console.log("initCopInfo.......copJsonData....",e)}}}catch(e){console.log("channelLogin---\u5f02\u5e38\u4fe1\u606f:",e)}};var n=r(e("../ulsdkmanager/ulsdkdemomanager.js")),a=r(e("../sdktools/sdkdemotools.js"));function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}console.log("httpRequest......",n),cc._RF.pop()},{"../sdktools/sdkdemotools.js":"sdkdemotools","../ulsdkmanager/ulsdkdemomanager.js":"ulsdkdemomanager"}],sdkdemotools:[function(e,t,o){"use strict";cc._RF.push(t,"23cb9IIcvFFeJezHJLk2gcH","sdkdemotools"),Object.defineProperty(o,"__esModule",{value:!0}),o.timer=void 0,o.getQueryString=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=window.location.search.substr(1).match(t);if(null!=o)return decodeURI(o[2]);return null},o.setTimer=function(e,t,o){e,0,!0,a=t,r=o,clearTimeout(n),console.log("setTimer:---userId--:",e),console.log("setTimer:---TimerLoopTime--:",a),console.log("setTimer:---TimerStopTime--:",r),NewTimer()};(function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);t.default=e})(e("../net/sdkdemohttprequest.js"));var n=o.timer=null,a=5e3,r=24e4;cc._RF.pop()},{"../net/sdkdemohttprequest.js":"sdkdemohttprequest"}],singlePageReuseList:[function(e,t,o){"use strict";cc._RF.push(t,"1336eaYdjJLlb1bHngS59ci","singlePageReuseList"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../Const"),a=e("../../../ulframework/utils/Tools"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){var t=e.call(this)||this;return t.layoutType=null,t.creator=null,t.settor=null,t.destoryer=null,t.root=null,t.child1=null,t.child2=null,t.defaultActionInterval=.2,t.bIsLoop=!0,t.space=null,t.datas=[],t.moveCallFn=null,t.buildUi(),t}return __extends(t,e),t.prototype.destroy=function(){if(e.prototype.destroy.call(this),this.destoryer)for(var t=1;t<=2;t++)this.destoryer(this["child"+t.toString()],this.datas[t-1]);return!0},t.prototype.setDatas=function(e,t){this.datas=e,t||this.skipToPage(this.curIndex)},t.prototype.getDatas=function(){return this.datas},t.prototype.setMoveCallFn=function(e){this.moveCallFn=e},t.prototype.setSettor=function(e){return this.settor=e,this},t.prototype.setCreator=function(e){return this.creator=e,this},t.prototype.setDestroyer=function(e){return this.destoryer=e,this},t.prototype.setLayoutType=function(e){return this.layoutType=e,this},t.prototype.setSpace=function(e){return this.space=e,this},t.prototype.getCurIndex=function(){return this.curIndex},t.prototype.getMaxIndex=function(){return this.datas.length-1},t.prototype.buildUi=function(){var e,t=this;this.root=new cc.Node,this.root.setContentSize(576,1024),this.root.parent=this,a.default.registerTouchHandler(this.root,function(o){if("began"==o.name)e=o.getLocation();else if("ended"==o.name){var n=o.getLocation().x-e.x;n>60?t.moveToLastPage():n<-60&&t.moveToNextPage()}}),this.curIndex=0,this.lastIndex=0,this.focusChildIndex=1,this.unfocusChildIndex=2},t.prototype.moveToNextPage=function(){this.lastIndex=this.curIndex,this.curIndex++,this.curIndex>this.datas.length-1&&0==this.bIsLoop&&(this.curIndex=this.datas.length-1),this.moveToCurPage()},t.prototype.setCurPage=function(e){this.curIndex=e},t.prototype.moveToLastPage=function(){this.lastIndex=this.curIndex,this.curIndex--,this.curIndex<0&&0==this.bIsLoop&&(this.curIndex=0),this.moveToCurPage()},t.prototype.moveToPage=function(e){this.lastIndex=this.curIndex,this.setCurPage(e),this.moveToCurPage()},t.prototype.skipToPage=function(e){this.setCurPage(e),this.lastIndex=this.curIndex,this.moveToCurPage()},t.prototype.setLoop=function(e){this.bIsLoop=e},t.prototype.moveToCurPage=function(){this.space||(this.layoutType==cc.Layout.Type.HORIZONTAL?this.space=n.default.RESOLUTION_RANGE.maxWidth:this.space=n.default.RESOLUTION_RANGE.maxHeight),null==this.child1&&(this.child1=new cc.Node,this.child1.parent=this.root,this.creator(this.child1)),null==this.child2&&(this.child2=new cc.Node,this.child2.parent=this.root,this.creator(this.child2));var e=new cc.Vec2,t=new cc.Vec2,o=new cc.Vec2,a=new cc.Vec2,r=this["child"+this.focusChildIndex.toString()],i=this["child"+this.unfocusChildIndex.toString()];if(this.lastIndex==this.curIndex)e.y=0,t.y=0,o.y=0,a.y=0,e.x=0,t.x=this.space,o.x=0,a.x=this.space;else{var s=this.focusChildIndex;this.focusChildIndex=this.unfocusChildIndex,this.unfocusChildIndex=s,this.lastIndex<this.curIndex?this.layoutType==cc.Layout.Type.HORIZONTAL?(e.y=0,t.y=0,o.y=0,a.y=0,e.x=this.space,t.x=0,o.x=0,a.x=-1*this.space):(e.x=0,t.x=0,o.x=0,a.x=0,e.y=this.space,t.y=0,o.y=0,a.y=-1*this.space):this.layoutType==cc.Layout.Type.HORIZONTAL?(e.y=0,t.y=0,o.y=0,a.y=0,e.x=-1*this.space,t.x=0,o.x=0,a.x=this.space):(e.x=0,t.x=0,o.x=0,a.x=0,e.y=-1*this.space,t.y=0,o.y=0,a.y=this.space)}r.setPosition(e),i.setPosition(t);var c=this.curIndex%this.datas.length;c<0&&(c+=this.datas.length);var l=this.lastIndex%this.datas.length;l<0&&(l+=this.datas.length),this.settor(r,this.datas[c]),c!=l&&this.settor(i,this.datas[l]),r.stopAllActions(),r.runAction(cc.moveTo(this.defaultActionInterval,o)),i.stopAllActions(),i.runAction(cc.moveTo(this.defaultActionInterval,a)),this.moveCallFn&&"function"==typeof this.moveCallFn&&this.moveCallFn(this)},t=__decorate([i],t)}(cc.Node));o.default=s,cc._RF.pop()},{"../../../ulframework/utils/Tools":"Tools","../../Const":"Const"}],ulsdkdemomanager:[function(e,t,o){"use strict";cc._RF.push(t,"9de53Wv17pOWomVGxUEGcJ7","ulsdkdemomanager"),Object.defineProperty(o,"__esModule",{value:!0}),o.initManager=function(t){try{c=JSON.parse(a.cConfig)}catch(e){return void console.log("initManager.....json\u89e3\u6790\u5931\u8d25\uff01")}l=t,(s=e("../ulsdkmodules/sdkDemoModule/sdkDemoModule.js")).initModule(t),console.log("ULSDK_TEST...............InitManager......",s)},o.getCurrentChannel=function(){return l},o.getCurrentModule=function(){return s},o.getConfigByKey=function(e){return c[e]},o.manageSdkRequest=function(e,t){if(null==s)return void console.log("ULSDK_TEST......\u6e38\u620f\u4e0d\u5728\u4efb\u4f55\u4e00\u4e2a\u6e20\u9053\uff01");switch(e){case"/c/setVersion":console.log("setVersion...ManageSdkRequest.",t),s.setVersion();break;case"/c/openPay":s.openPay(t);break;case"/c/openShare":s.openShare(t);break;case"/c/loginRole":s.loginRoleInfo(t);break;case"/c/loginOut":s.loginOut(t);break;case"/c/openAdv":s.openAdv(t);break;case"/c/closeAdv":s.closeAdv(t);break;case"/c/saveRankData":console.log("ULSDK_TEST.....saveRankData>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>==========manageSdkRequest===="),s.saveRankData(t);break;case"/c/getRankData":s.getRankData(t);break;case"/c/useCdkey":r.useCdkey(t);break;case"/c/megadataServer":r.postMegaData(t,s.getUserId());break;case"/c/createRole":r.postMegaData(new Array("/d/createNewRole",t.roleName),s.getUserId());break;default:console.log("ULSDK_TEST.........\u6ca1\u6709\u8be5\u6307\u4ee4",e)}},o.manageSdkResponse=function(e){console.log("setVersion...manageSdkResponse.",e),n.response(e)};var n=i(e("../ulsdkmiddleware/ulsdkdemomiddleware.js")),a=e("../assets/sdkdemocConfig.js"),r=i(e("../net/sdkdemohttprequest.js"));function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}var s=null,c=null,l=null;cc._RF.pop()},{"../assets/sdkdemocConfig.js":"sdkdemocConfig","../net/sdkdemohttprequest.js":"sdkdemohttprequest","../ulsdkmiddleware/ulsdkdemomiddleware.js":"ulsdkdemomiddleware","../ulsdkmodules/sdkDemoModule/sdkDemoModule.js":"sdkDemoModule"}],ulsdkdemomiddleware:[function(e,t,o){"use strict";cc._RF.push(t,"54875J3LlNJQr9p708ntLTh","ulsdkdemomiddleware"),Object.defineProperty(o,"__esModule",{value:!0}),o.initSdk=function(){n.initManager("ulsdkdemo"),console.log("ULSDK_TEST.........\u521d\u59cb\u5316sdk......currentChannel..","ulsdkdemo")},o.setGameCallback=function(e){r=e,console.log("ULSDK_TEST........setGameCallback....success.....")},o.request=function(e){try{var t=JSON.parse(e),o=t.cmd,a=t.data;n.manageSdkRequest(o,a),console.log("ULSDK_TEST........request func is .... !",e),console.log(e)}catch(e){return console.log("ULSDK_TEST....request.....json\u89e3\u6790\u5931\u8d25\uff01"),void console.log(e)}},o.response=function(e){null!=r?r(e):console.log("ULSDK_TEST.........callbackHalder func is null !")};var n=a(e("../ulsdkmanager/ulsdkdemomanager.js"));a(e("../sdktools/sdkdemotools.js"));function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t.default=e,t}var r=null;cc._RF.pop()},{"../sdktools/sdkdemotools.js":"sdkdemotools","../ulsdkmanager/ulsdkdemomanager.js":"ulsdkdemomanager"}],ul:[function(e,t,o){"use strict";function n(e,t){e.sign=t?"":e.negative?"-":e.sign;var o=e.min-e.argument.length+1-e.sign.length,n=new Array(o<0?0:o).join(e.pad);return e.left?"0"==e.pad||t?e.sign+e.argument+n.replace(/0/g," "):e.sign+e.argument+n:"0"==e.pad||t?e.sign+n+e.argument:n+e.sign+e.argument}function a(e){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(e)]}cc._RF.push(t,"2f20f/O6ERNBZxpEn6hffbG","ul"),ul.format=function(){if(void 0===arguments)return null;if(arguments.length<1)return null;if("string"!=typeof arguments[0])return null;if("undefined"==typeof RegExp)return null;for(var e=arguments[0],t=new RegExp(/(%([%]|(\-)?(\+|\x20)?(0)?(\d+)?(\.(\d)?)?([bcdfosxX])))/g),o=new Array,a=new Array,r=0,i=0,s=0,c=0,l="",u=null;u=t.exec(e);)u[9]&&(r+=1),i=c,s=t.lastIndex-u[0].length,a[a.length]=e.substring(i,s),c=t.lastIndex,o[o.length]={match:u[0],left:!!u[3],sign:u[4]||"",pad:u[5]||" ",min:u[6]||0,precision:u[8],code:u[9]||"%",negative:parseInt(arguments[r])<0,argument:String(arguments[r])};if(a[a.length]=e.substring(c),0==o.length)return e;if(arguments.length-1<r)return null;u=null;var d=null,p=null;for(p=0;p<o.length;p++)"%"==o[p].code?d="%":"b"==o[p].code?(o[p].argument=String(Math.abs(parseInt(o[p].argument)).toString(2)),d=n(o[p],!0)):"c"==o[p].code?(o[p].argument=String(String.fromCharCode(Math.abs(parseInt(o[p].argument)))),d=n(o[p],!0)):"d"==o[p].code?(o[p].argument=String(Math.abs(parseInt(o[p].argument))),d=n(o[p])):"f"==o[p].code?(o[p].argument=String(Math.abs(parseFloat(o[p].argument)).toFixed(o[p].precision?o[p].precision:6)),d=n(o[p])):"o"==o[p].code?(o[p].argument=String(Math.abs(parseInt(o[p].argument)).toString(8)),d=n(o[p])):"s"==o[p].code?(o[p].argument=o[p].argument.substring(0,o[p].precision?o[p].precision:o[p].argument.length),d=n(o[p],!0)):"x"==o[p].code?(o[p].argument=String(Math.abs(parseInt(o[p].argument)).toString(16)),d=n(o[p])):"X"==o[p].code?(o[p].argument=String(Math.abs(parseInt(o[p].argument)).toString(16)),d=n(o[p]).toUpperCase()):d=o[p].match,l+=a[p],l+=d;return l+=a[p]},ul.formatDate=function(e,t){var o={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),o)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?o[n]:("00"+o[n]).substr((""+o[n]).length)));return t},ul.dump=function(e,t,o){var n=function e(t,o){var n="";o||(o=0);for(var a="",r=0;r<o+1;r++)a+="    ";if("object"==typeof t)for(var i in t){var s=t[i];"object"==typeof s?(n+=a+"'"+i+"' ...\n",n+=e(s,o+1)):n+=a+"'"+i+"' => \""+s+'"\n'}else n="===>"+t+"<===("+typeof t+")";return n}(e);console.log("dump-begin",t),console.log(n),console.log("dump-end")},ul.actionFloat=function(e,t,o,n){var a=cc.delayTime(e);return a.update=function(e){n(t*(1-e)+o*e)},a},ul.clone=function e(t){var o,n=a(t);if(t instanceof cc.Node)return t;if("object"===n)o={};else{if("array"!==n)return t;o=[]}if("array"===n)for(var r=0,i=t.length;r<i;r++)o.push(e(t[r]));else if("object"===n)for(var s in t)o[s]=e(t[s]);return o},ul.length=function(e){var t=a(e);if("array"===t)return e.length;if("object"===t){var o=0;for(var n in e)e[n]&&o++;return o}return 0},ul.clamp=function(e,t,o){return e<t&&(e=t),e>o&&(e=o),e},ul.getType=a,cc._RF.pop()},{}],vAdLuckyMatchDialog:[function(e,t,o){"use strict";cc._RF.push(t,"c68dezd/1xJSrbgyGNWXL2Z","vAdLuckyMatchDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("./../../manager/mgrSdk"),i=e("../../Const"),s=e("../../manager/mgrDirector"),c=e("../../manager/mgrAd"),l="more_20persent_pvp_score",u=cc._decorator,d=u.ccclass,p=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonCarefulDouble=null,t.buttonCarefulSingle=null,t.buttonClose=null,t.buttonGetReleax=null,t.labelButtonSignReleax=null,t.labelTipCareful=null,t.labelTipReleax=null,t.nodeAdIconReleax=null,t.nodeCareful=null,t.nodeGetReleax=null,t.nodeReleax=null,t.nodeToogleParent=null,t.toggleDoubleReward=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vAdLuckyMatchDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonCarefulDouble:{varname:"buttonCarefulDouble",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonCarefulDouble"}]},CC_buttonCarefulSingle:{varname:"buttonCarefulSingle",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonCarefulSingle"}]},CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_buttonGetReleax:{varname:"buttonGetReleax",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonGetReleax"}]},CC_labelButtonSignReleax:{varname:"labelButtonSignReleax",vartype:cc.Label},CC_labelTipCareful:{varname:"labelTipCareful",vartype:cc.Label},CC_labelTipReleax:{varname:"labelTipReleax",vartype:cc.Label},CC_nodeAdIconReleax:{varname:"nodeAdIconReleax",vartype:cc.Node},CC_nodeCareful:{varname:"nodeCareful",vartype:cc.Node},CC_nodeGetReleax:{varname:"nodeGetReleax",vartype:cc.Node},CC_nodeReleax:{varname:"nodeReleax",vartype:cc.Node},CC_nodeToogleParent:{varname:"nodeToogleParent",vartype:cc.Node},CC_toggleDoubleReward:{varname:"toggleDoubleReward",vartype:cc.Toggle}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.fillAd(),this.registerListeners({MSG_AD_EVENT_SUCCESSD:this.onMsgAdEventSuccessd})},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fillAd=function(){this.nodeReleax.active=r.default.getCopAdMode()==i.AdMode.releax,this.nodeCareful.active=r.default.getCopAdMode()==i.AdMode.careful,this.toggleDoubleReward.node.on("toggle",this.refreshAdIcon.bind(this)),this.refreshAdIcon()},t.prototype.refreshAdIcon=function(){var e=this.toggleDoubleReward.isChecked;cc.log("refreshAdIcon isChecked : ",e),this.nodeAdIconReleax.active=e},t.prototype.enterGame=function(e){void 0===e&&(e=!1),s.default.enterScene("vGameScene",{stageId:1e4,bAddition:e})},t.prototype.onTouchButtonCarefulDouble=function(e){e.isClick()&&c.default.triggerAdEvent(l,null,!0)},t.prototype.onTouchButtonCarefulSingle=function(e){e.isClick()&&this.enterGame()},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.closeDialog()},t.prototype.onTouchButtonGetReleax=function(e){e.isClick()&&(this.toggleDoubleReward.isChecked?c.default.triggerAdEvent(l,null,!0):this.enterGame())},t.prototype.onMsgAdEventSuccessd=function(e){e.adEventId==l&&this.enterGame(!0)},t=__decorate([d],t)}(a.default));o.default=p,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../Const":"Const","../../manager/mgrAd":"mgrAd","../../manager/mgrDirector":"mgrDirector","./../../manager/mgrSdk":"mgrSdk"}],vAdTryDialog:[function(e,t,o){"use strict";cc._RF.push(t,"32476m2a2ZPXZVg/mzYdNEJ","vAdTryDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("./../../manager/mgrCfg"),i=e("../../manager/mgrAd"),s=e("../node/vAvatar"),c=e("../../Const"),l=cc._decorator,u=l.ccclass,d=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonClose=null,t.buttonWatch=null,t.nodeAdIcon=null,t.spriteIcon=null,t.adEventId="free_try_part",t.viewAvatar=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vAdTryDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_buttonWatch:{varname:"buttonWatch",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonWatch"}]},CC_nodeAdIcon:{varname:"nodeAdIcon",vartype:cc.Node},CC_spriteIcon:{varname:"spriteIcon",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.viewAvatar=new s.default,this.viewAvatar.parent=this.spriteIcon.node,this.viewAvatar.scale=.35,this.fillData(),this.registerListeners({MSG_AD_EVENT_SUCCESSD:this.onMsgAdEventSuccessd})},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fillData=function(){var e=r.default.get_from_cake_part_db(this.context.partId);this.spriteIcon.spriteFrame=null,this.viewAvatar.takeOffAll(),e&&e.type==c.CakePartType.body?this.viewAvatar.replace(this.context.partId):this.spriteIcon.loadSpriteFrame(e.icon),this.nodeAdIcon.active=i.default.preCheckCanTriggerAdEvent(this.adEventId)},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.closeDialog()},t.prototype.onTouchButtonWatch=function(e){e.isClick()&&(i.default.preCheckCanTriggerAdEvent(this.adEventId)?i.default.triggerAdEvent(this.adEventId,{partId:this.context.partId},!0):(this.sendMsg("MSG_TRY_SUCCESSFUL",{partId:this.context.partId}),this.closeDialog()))},t.prototype.onMsgAdEventSuccessd=function(e){e.adEventId==this.adEventId&&(this.sendMsg("MSG_TRY_SUCCESSFUL",{partId:e.userData.partId}),this.closeDialog())},t=__decorate([u],t)}(a.default));o.default=d,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../Const":"Const","../../manager/mgrAd":"mgrAd","../node/vAvatar":"vAvatar","./../../manager/mgrCfg":"mgrCfg"}],vAirDropDialog:[function(e,t,o){"use strict";cc._RF.push(t,"aa02bjcv/1C4qliWX9kurBf","vAirDropDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("../../manager/mgrAd"),i=cc._decorator,s=i.ccclass,c=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonAd=null,t.buttonClose=null,t.labelContent=null,t.nodeType1=null,t.nodeType2=null,t.nodeType3=null,t.nodeType4=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vAirDropDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonAd:{varname:"buttonAd",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonAd"}]},CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_labelContent:{varname:"labelContent",vartype:cc.Label},CC_nodeType1:{varname:"nodeType1",vartype:cc.Node},CC_nodeType2:{varname:"nodeType2",vartype:cc.Node},CC_nodeType3:{varname:"nodeType3",vartype:cc.Node},CC_nodeType4:{varname:"nodeType4",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.fillData(),this.registerListeners({MSG_AD_EVENT_SUCCESSD:this.onMsgAdEventSuccessd})},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fillData=function(){var e=this.context.type;switch(this.nodeType1.active=!1,this.nodeType2.active=!1,this.nodeType3.active=!1,this.nodeType4.active=!1,e){case 1:this.labelContent.string="\u770b\u5e7f\u544a\u83b7\u5f97\u6b64\u5173 \u65e0\u9650\u5b50\u5f39 \u6548\u679c",this.nodeType1.active=!0;break;case 2:this.labelContent.string="\u770b\u5e7f\u544a\u83b7\u5f97 \u62b5\u63215\u6b21\u5c04\u51fb \u4fdd\u62a4\u7f69",this.nodeType2.active=!0;break;case 3:this.labelContent.string="\u770b\u5e7f\u544a \u968f\u673a\u8bd5\u7528\u4e00\u628a \u5168\u6ee1\u7ea7\u67aa",this.nodeType3.active=!0;break;case 4:this.labelContent.string="\u770b\u5e7f\u544a \u56de\u6ee1\u8840\u91cf\uff0c\u9632\u5177\u8010\u4e45",this.nodeType4.active=!0}},t.prototype.onTouchButtonAd=function(e){e.isClick()&&r.default.triggerAdEvent("air_drop",{type:this.context.type},!0)},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.closeDialog()},t.prototype.onMsgAdEventSuccessd=function(e){"air_drop"==e.adEventId&&this.closeDialog()},t=__decorate([s],t)}(a.default));o.default=c,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../manager/mgrAd":"mgrAd"}],vAirDrop:[function(e,t,o){"use strict";cc._RF.push(t,"7ae0ffncd5GVbweoNzFZj4x","vAirDrop"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/ViewBase"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonItem=null,t.nodeUmbrella=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vAirDrop"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonItem:{varname:"buttonItem",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonItem"}]},CC_nodeUmbrella:{varname:"nodeUmbrella",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.actionIn()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.actionIn=function(){var e=this;this.runAction(cc.sequence(cc.spawn(cc.moveTo(6,0,0),cc.repeat(cc.sequence(cc.rotateTo(.5,10).easing(cc.easeOut(1.5)),cc.rotateTo(1,-10).easing(cc.easeInOut(1.5)),cc.rotateTo(.5,0).easing(cc.easeIn(1.5))),3)),cc.callFunc(function(){e.actionUmbrella()})))},t.prototype.actionUmbrella=function(){this.nodeUmbrella.runAction(cc.fadeOut(1))},t.prototype.onTouchButtonItem=function(e){e.isClick()&&this.context.fOnclick&&this.context.fOnclick(this.context.type)},t=__decorate([i],t)}(a.default));o.default=s,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/ViewBase":"ViewBase"}],vAvatar:[function(e,t,o){"use strict";cc._RF.push(t,"2ba08ef3LBG1qFzZAng12VB","vAvatar"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./../../struct/sAvatar"),a=e("./../../../ulframework/view/ResourceNode"),r=e("./../../../ulframework/utils/Tools"),i=e("./../../manager/mgrCfg"),s=function(e){function t(){var t=e.call(this,"vAvatar")||this;return t.kernel=null,t.root=null,t.resNodes=[],t.defaultPartIds=[],t.kernel=new n.default,t.root=new cc.Node("root"),t.root.parent=t,t}return __extends(t,e),t.prototype._refresh=function(){var e=this.resNodes;this.resNodes=[];var t=function(t,o){for(var n=0;n<e.length;n++){var a=e[n];if(a.resType==t&&a.resId==o)return e.splice(n,1),a}},o=this.kernel.getKernelData();for(var n in o)if(o[n]){var i=parseInt(n),s=o[n];if(null==(l=t(s.resType,s.resId))&&((l=new a.default(s.resType,s.resId,"mov_1")).setContentSize(100,100),l.parent=this.root,this.debugCallback&&r.default.registerTouchHandler(l,this.debugCallback)),l.nodeSprite)l.nodeSprite.getComponent(cc.Sprite).type=cc.Sprite.Type.SIMPLE;l.setPosition(s.pos),l.zIndex=i,l.scale=s.scale,l.__partId=s.fromTo,this.resNodes.push(l)}for(var c=0;c<e.length;c++){var l=e[c];this.root.removeChild(l),l.destroy()}e=[]},t.prototype.replace=function(e){var t=i.default.get_from_cake_part_db(e);if(t){var o=i.default.get_from_cake_type_db(t.type);if(0!=o.prePartType)this.kernel.replace(e);else{this.kernel.replace(e);for(var n=this.kernel.getAllPartIds(),a=[],r=[],s=0;s<n.length;s++){var c=n[s],l=i.default.get_from_cake_part_db(c);0==i.default.get_from_cake_type_db(l.type).prePartType?a.push(c):r.push(c)}this.kernel.takeOffAll();for(s=0;s<a.length;s++){var u=a[s];this.kernel.replace(u)}for(s=0;s<r.length;s++){u=r[s];this.kernel.replace(u)}}if(this._refresh(),o.bWithFillEffect){var d=this.getResNodesByPartId(e),p=function(e){var t=d[e];if(t&&t.nodeSprite){var o=t.nodeSprite.getComponent(cc.Sprite);o.type=cc.Sprite.Type.FILLED,o.fillType=cc.Sprite.FillType.HORIZONTAL,o.fillStart=0,o.fillRange=0,t.runAction(ul.actionFloat(.5,0,100,function(e){o.type=cc.Sprite.Type.FILLED,o.fillType=cc.Sprite.FillType.HORIZONTAL,o.fillStart=0,o.fillRange=e/100}))}};for(var h in d)p(h)}}},t.prototype.replacePartIdArray=function(e){var t=ul.clone(e);t=ul.clone(t.sort(function(e,t){return e<t?-1:(e=t)?0:e>t?1:void 0}));for(var o=0;o<t.length;o++){var n=t[o];this.kernel.replace(n)}this._refresh()},t.prototype.takeOff=function(e){this.kernel.takeOff(e),this._refresh()},t.prototype.takeOffAll=function(){this.kernel.takeOffAll();for(var e=0;e<this.defaultPartIds.length;e++){var t=this.defaultPartIds[e];this.kernel.replace(t)}this._refresh()},t.prototype.getPartIds=function(){return this.kernel.getAllPartIds()},t.prototype.setTouchNodeCallback=function(e){this.debugCallback=e},t.prototype.getResNodesByPartId=function(e){for(var t=[],o=0;o<this.resNodes.length;o++){var n=this.resNodes[o];n.__partId==e&&t.push(n)}return t},t.prototype.setOpacityExByPartId=function(e,t){for(var o=this.getResNodesByPartId(t),n=0;n<o.length;n++){o[n].opacity=e}},t.prototype.offResNodeTouByPartId=function(e){for(var t=this.getResNodesByPartId(e),o=0;o<t.length;o++){var n=t[o];r.default.unregisterTouchHandler(n)}},t}(cc.Node);o.default=s,cc._RF.pop()},{"./../../../ulframework/utils/Tools":"Tools","./../../../ulframework/view/ResourceNode":"ResourceNode","./../../manager/mgrCfg":"mgrCfg","./../../struct/sAvatar":"sAvatar"}],vBuyItemDialog:[function(e,t,o){"use strict";cc._RF.push(t,"715163ulX1LcJLOXMNUVjuu","vBuyItemDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("./../../manager/mgrCfg"),i=e("../../manager/mgrShop"),s=e("../node/vAvatar"),c=e("../../Const"),l=e("../node/vTitleBar"),u=e("../../manager/mgrDirector"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonBuy=null,t.buttonClose=null,t.labelBuy=null,t.labelName=null,t.nodeTitleBar=null,t.nodeTop=null,t.spriteIcon=null,t.viewAvatar=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vBuyItemDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonBuy:{varname:"buttonBuy",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonBuy"}]},CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_labelBuy:{varname:"labelBuy",vartype:cc.Label},CC_labelName:{varname:"labelName",vartype:cc.Label},CC_nodeTitleBar:{varname:"nodeTitleBar",vartype:cc.Node},CC_nodeTop:{varname:"nodeTop",vartype:cc.Node},CC_spriteIcon:{varname:"spriteIcon",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.uiFadeIn(),(new l.default).parent=this.nodeTitleBar,this.viewAvatar=new s.default,this.viewAvatar.parent=this.spriteIcon.node,this.viewAvatar.scale=.35;var t=r.default.get_from_cake_part_db(this.context.partId);this.spriteIcon.spriteFrame=null,this.viewAvatar.takeOffAll(),t&&t.type==c.CakePartType.body?this.viewAvatar.replace(this.context.partId):this.spriteIcon.loadSpriteFrame(t.icon);var o=r.default.get_from_shop_template_db(this.context.partId),n=r.default.get_from_item_template_db(o.priceUnit);cc.log("AA:",o.priceUnit,o.price),this.labelBuy.string=ul.format("%d%s\u8d2d\u4e70",o.price,n.name||""),this.labelName.string=t.name,this.registerListeners({MSG_SHOP_BUY_SUCCESSED:this.onShopBuySucceed})},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.uiFadeIn=function(){this.nodeTop.y=u.default.height/2,u.default.isDeviceOverHeight()&&(this.nodeTop.y=u.default.height/2-50)},t.prototype.onTouchButtonBuy=function(e){e.isClick()&&(cc.log("partId:",this.context.partId),i.default.requestBuy(this.context.partId))},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.closeDialog()},t.prototype.onShopBuySucceed=function(e){this.closeDialog()},t=__decorate([p],t)}(a.default));o.default=h,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../Const":"Const","../../manager/mgrDirector":"mgrDirector","../../manager/mgrShop":"mgrShop","../node/vAvatar":"vAvatar","../node/vTitleBar":"vTitleBar","./../../manager/mgrCfg":"mgrCfg"}],vCdkDialog:[function(e,t,o){"use strict";cc._RF.push(t,"c35fbcvkuZIP6WQI14yHJwt","vCdkDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("../../manager/mgrTip"),i=e("../../manager/mgrSdk"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonSure=null,t.editboxCdk=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vCdkDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonSure:{varname:"buttonSure",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonSure"}]},CC_editboxCdk:{varname:"editboxCdk",vartype:cc.EditBox}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.onTouchButtonSure=function(e){if(e.isClick()){var t=this.editboxCdk.string;!t||t.length<=0?r.default.showMsgTip("\u8bf7\u8f93\u5165\u6b63\u786e\u7684sdk"):i.default.useCdk(t)}},t=__decorate([c],t)}(a.default));o.default=l,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../manager/mgrSdk":"mgrSdk","../../manager/mgrTip":"mgrTip"}],vChapterItem:[function(e,t,o){"use strict";cc._RF.push(t,"e2857EIqUNISr70YYSX0FOj","vChapterItem"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/ViewBase"),r=e("../../manager/mgrCfg"),i=e("../../manager/mgrStage"),s=e("../../manager/mgrGuide"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonStage1=null,t.buttonStage2=null,t.buttonStage3=null,t.buttonStage4=null,t.buttonStage5=null,t.buttonStage6=null,t.buttonStage7=null,t.buttonStage8=null,t.labelName=null,t.items=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vChapterItem"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonStage1:{varname:"buttonStage1",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonStage1"}]},CC_buttonStage2:{varname:"buttonStage2",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonStage2"}]},CC_buttonStage3:{varname:"buttonStage3",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonStage3"}]},CC_buttonStage4:{varname:"buttonStage4",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonStage4"}]},CC_buttonStage5:{varname:"buttonStage5",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonStage5"}]},CC_buttonStage6:{varname:"buttonStage6",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonStage6"}]},CC_buttonStage7:{varname:"buttonStage7",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonStage7"}]},CC_buttonStage8:{varname:"buttonStage8",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonStage8"}]},CC_labelName:{varname:"labelName",vartype:cc.Label}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buildUi(),this.refresh()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){},t.prototype.fillData=function(e){this.context.chapterId=e,this.refresh()},t.prototype.refresh=function(){if(this.isResourceLoaded()){var e=this.context.chapterId;if(e){var t=r.default.get_from_stage_chapter_db(e);if(t){console.log("@@@: chapterId",e),101==e&&0==i.default.getStageProgress()&&(s.default.registerGuideNode("vStageScene.buttonStageFirst",this.buttonStage1.node),this.sendMsg("MSG_GUIDE_POINT",{id:"vStageScene.beginStageGuide"}));var o=t.name.replace("_","-");this.labelName.string=o;for(var n=1;n<=8;n++){var a=t.stageIds[n-1],c=this["buttonStage"+n.toString()].node,l=c.getChildByName("lock"),u=c.getChildByName("unlock"),d=c.getChildByName("star1"),p=c.getChildByName("star2"),h=c.getChildByName("star3"),f=c.getChildByName("bgName").getChildByName("name").getComponent(cc.Label),g=r.default.get_from_stage_db(a);f.string=g.name,i.default.isStageUnlocked(a)?(l.active=!1,u.active=!0,d.getChildByName("light").active=i.default.getStageRating(a)>=1,d.getChildByName("unlock").active=!1,p.getChildByName("light").active=i.default.getStageRating(a)>=2,p.getChildByName("unlock").active=!1,h.getChildByName("light").active=i.default.getStageRating(a)>=3,h.getChildByName("unlock").active=!1):(l.active=!0,u.active=!1,d.getChildByName("light").active=!1,d.getChildByName("unlock").active=!0,p.getChildByName("light").active=!1,p.getChildByName("unlock").active=!0,h.getChildByName("light").active=!1,h.getChildByName("unlock").active=!0)}}}}},t.prototype.selectStage=function(e){e-=1;var t=r.default.get_from_stage_chapter_db(this.context.chapterId).stageIds[e];this.context.fOnClickStage&&this.context.fOnClickStage(t)},t.prototype.onTouchButtonStage1=function(e){e.isClick()&&(this.selectStage(1),this.sendMsg("MSG_GUIDE_POINT",{id:"vStageScene.buttonStageItem.click"}))},t.prototype.onTouchButtonStage2=function(e){e.isClick()&&this.selectStage(2)},t.prototype.onTouchButtonStage3=function(e){e.isClick()&&this.selectStage(3)},t.prototype.onTouchButtonStage4=function(e){e.isClick()&&this.selectStage(4)},t.prototype.onTouchButtonStage5=function(e){e.isClick()&&this.selectStage(5)},t.prototype.onTouchButtonStage6=function(e){e.isClick()&&this.selectStage(6)},t.prototype.onTouchButtonStage7=function(e){e.isClick()&&this.selectStage(7)},t.prototype.onTouchButtonStage8=function(e){e.isClick()&&this.selectStage(8)},t=__decorate([l],t)}(a.default));o.default=u,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/ViewBase":"ViewBase","../../manager/mgrCfg":"mgrCfg","../../manager/mgrGuide":"mgrGuide","../../manager/mgrStage":"mgrStage"}],vDebugInfoDialog:[function(e,t,o){"use strict";cc._RF.push(t,"47a90qBLBVD9os4hYdSvxl6","vDebugInfoDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/DialogBase"),a=e("../../manager/mgrDirector"),r=e("../../../ulframework/view/DebugMenu"),i=e("../../../ulframework/view/ReuseList"),s=e("../../../ulframework/view/ReuseLayouterVBox"),c=e("../../manager/mgrCop"),l=e("../../../ulframework/utils/Tools"),u=e("../../manager/mgrTip"),d=e("../../manager/mgrRecord"),p=e("../../../ulframework/utils/Timer"),h=cc._decorator,f=h.ccclass,g=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodeInfo=null,t.nodeMenu=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vDebugInfoDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_nodeInfo:{varname:"nodeInfo",vartype:cc.Node},CC_nodeMenu:{varname:"nodeMenu",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.nodeResource.setContentSize(a.default.size),this.nodeInfo.getComponent(cc.Widget).updateAlignment(),this.buildUi()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.isShadowEnabled=function(){return!1},t.prototype.buildUi=function(){var e=this,t=new r.default([["\u5173\u95ed",function(){e.closeDialog(!0)}],["time",function(){u.default.showMsgTip(ul.format("time:%s",l.default.time()))}],["\u91cd\u7f6e\u5b58\u6863",function(){d.default.resetRecord(),u.default.showMsgTip("ojbk"),p.default.callLater(.5,function(){cc.audioEngine.stopAll(),cc.game.restart()})}],["log->console",function(){cc.log=console.log,cc.log("cc.log is refrence to cc.info")}]],200,50,4);t.parent=this.nodeMenu,t.x=5,t.y=-5;var o=this.nodeInfo,n=new i.default;n.parent=o,n.setLayouter((new s.default).setCellSize(o.getContentSize().width-8,16).setGap(4).setPending(4)),n.setCreator(function(e){var t=new cc.Node;t.parent=e;var o=t.addComponent(cc.Label);o.fontSize=16,o.lineHeight=16,o.horizontalAlign=cc.Label.HorizontalAlign.LEFT,o.verticalAlign=cc.Label.VerticalAlign.CENTER,o.overflow=cc.Label.Overflow.SHRINK,t.setContentSize(e.getContentSize()),e.label=o}),n.setSetter(function(e,t){e.label.string=t}),n.setContentSize(o.getContentSize());var a=n.addComponent(cc.Widget);a.top=0,a.bottom=0,a.right=0,a.left=0,a.isAlignOnce=!1;var h=["\u8c03\u8bd5\u4fe1\u606f\uff1a"],f=c.default.getCops(),g=Object.keys(f);g.sort(),h.push("cop:");for(var m=0;m<g.length;m++){var v=g[m],_=f[v];h.push(ul.format("  [%s] = [%s]",v,_))}h.push(""),h.push("ultralisk \u6210\u90fd\u96f7\u517d\u4e92\u52a8 \u7248\u6743\u6240\u6709"),n.setDatas(h)},t=__decorate([f],t)}(n.default));o.default=g,cc._RF.pop()},{"../../../ulframework/utils/Timer":"Timer","../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/DebugMenu":"DebugMenu","../../../ulframework/view/DialogBase":"DialogBase","../../../ulframework/view/ReuseLayouterVBox":"ReuseLayouterVBox","../../../ulframework/view/ReuseList":"ReuseList","../../manager/mgrCop":"mgrCop","../../manager/mgrDirector":"mgrDirector","../../manager/mgrRecord":"mgrRecord","../../manager/mgrTip":"mgrTip"}],vDebugPickerDialog:[function(e,t,o){"use strict";cc._RF.push(t,"05c8eGfY0BH07vCiWwdWExM","vDebugPickerDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/DialogBase"),a=e("../../../ulframework/view/ReuseList"),r=e("../../../ulframework/view/ReuseLayouterVBox"),i=e("../node/LayerColor"),s=e("../../../ulframework/utils/Tools"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelTitle=null,t.layoutList=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vDebugPickerDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_labelTitle:{varname:"labelTitle",vartype:cc.Label},CC_layoutList:{varname:"layoutList",vartype:cc.Layout}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buildUi()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){var e=this;this.labelTitle.string=this.context.title;var t=this.layoutList,o=new a.default;o.setLayouter((new r.default).setCellSize(390,50).setGap(4).setPending(0)),o.setCreator(function(t){var o=new i.default(cc.color(0,0,0,63));o.parent=t,o.setContentSize(t.getContentSize());var n=new cc.Node;n.parent=t;var a=n.addComponent(cc.Label);a.fontSize=20,a.verticalAlign=cc.Label.VerticalAlign.CENTER,t.label=a,s.default.registerTouchHandler(t,function(t){var o=t.target;if("began"==t.name?o.label.node.color=cc.color(0,255,0):"ended"!=t.name&&"cancelled"!=t.name||(o.label.node.color=cc.color(255,255,255)),t.isClick()){cc.log("click",o.data);var n=e.context.callback;n instanceof Function&&(n(o.data.value),e.closeDialog(!0))}})}),o.setSetter(function(e,t){e.label.string=t.text}),o.parent=t.node,o.setContentSize(t.node.getContentSize());var n=this.context.conf;o.setDatas(n)},t=__decorate([l],t)}(n.default));o.default=u,cc._RF.pop()},{"../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/DialogBase":"DialogBase","../../../ulframework/view/ReuseLayouterVBox":"ReuseLayouterVBox","../../../ulframework/view/ReuseList":"ReuseList","../node/LayerColor":"LayerColor"}],vDevTestScene:[function(e,t,o){"use strict";cc._RF.push(t,"d7728C3+aJAF5R+DNx/55Ou","vDevTestScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/SceneBase"),r=e("../../manager/mgrDirector"),i=cc._decorator,s=i.ccclass,c=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonBack=null,t.labelTitle=null,t.layoutBg=null,t.nodeButtonItemTemplate=null,t.nodeScrollViewContent=null,t.scrollViewList=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"scene/vDevTestScene"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonBack:{varname:"buttonBack",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonBack"}]},CC_labelTitle:{varname:"labelTitle",vartype:cc.Label},CC_layoutBg:{varname:"layoutBg",vartype:cc.Layout},CC_nodeButtonItemTemplate:{varname:"nodeButtonItemTemplate",vartype:cc.Node},CC_nodeScrollViewContent:{varname:"nodeScrollViewContent",vartype:cc.Node},CC_scrollViewList:{varname:"scrollViewList",vartype:cc.ScrollView}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.labelTitle.string=this.name,this.buildUi()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){for(var e=[["_Editor","EditorCakeItem",{resolutionRange:{minWidth:1920,maxWidth:1920,minHeight:1080,maxHeight:1080}}],["_Hub","vHubScene"],["_Sign","vSignDialog"],["_debugInfo","vDebugInfoDialog"],["AnimNode","TestAnimNode"],["Particle","TestParticle"],["Sound","TestSound"],["Spine","TestSpine"],["Func","TestFunc"]],t=0;t<e.length;t++){var o=e[t],a=o[0],r=o[1],i=o[2],s=cc.instantiate(this.nodeButtonItemTemplate);s.getChildByName("Label").getComponent(cc.Label).string=a,s.parent=this.nodeScrollViewContent,s.name=r,s.context=i,s.getComponent(n.default).registerOnTouchCallback(this.onTouchButtonItem.bind(this))}this.nodeButtonItemTemplate.active=!1,this.scrollViewList.cancelInnerEvents=!1},t.prototype.onTouchButtonBack=function(e){e.isClick()&&r.default.enterScene("vHubScene")},t.prototype.onTouchButtonItem=function(e){if(e.isClick()){var t=cc.instantiate(this.buttonBack.node);r.default.enterScene(e.target.name,e.target.context),t.parent=cc.director.getScene().getChildByName("Canvas"),t.zIndex=1e3;t.getContentSize();t.getComponent(n.default).registerOnTouchCallback(function(e){e.isClick()&&r.default.enterScene("vDevTestScene")})}},t=__decorate([s],t)}(a.default));o.default=c,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/SceneBase":"SceneBase","../../manager/mgrDirector":"mgrDirector"}],vGameCustomer:[function(e,t,o){"use strict";cc._RF.push(t,"2acffyp289L56mDZRy+E/AT","vGameCustomer"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/ViewBase"),r=e("./../../manager/mgrCfg"),i=e("./vAvatar"),s=e("./../../manager/mgrPool"),c=e("../../Const"),l=e("./../../manager/mgrDirector"),u=cc._decorator,d=u.ccclass,p=(u.property,function(e){function t(t){var o=e.call(this,t)||this;return o.buttonScale=null,o.nodeAvatar=null,o.nodeBubble=null,o.nodeSpine=null,o.spine=null,o.viewAvatar=null,o.minCount=4,o.finishedPartIds=[],o.needFinishPartIds=[],o.setPosition(cc.v2(700,0)),o.init(o.context.stageId,o.context.mustExistPartId),o}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vGameCustomer"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonScale:{varname:"buttonScale",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonScale"}]},CC_nodeAvatar:{varname:"nodeAvatar",vartype:cc.Node},CC_nodeBubble:{varname:"nodeBubble",vartype:cc.Node},CC_nodeSpine:{varname:"nodeSpine",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.viewAvatar=new i.default,this.viewAvatar.parent=this.nodeAvatar,this.nodeBubble.scale=0,this._refresh(),this.context.needMoveToCenter&&this.moveToCenter(this.context.moveToCenterCallback)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.init=function(e,t){var o,n=r.default.get_from_stage_db(e);this.needFinishPartIds=n.script.generatePartIds(t);var a=((o={})[c.CakePartType.plate]=1,o[c.CakePartType.body]=2,o[c.CakePartType.sideDeco]=3,o[c.CakePartType.side]=4,o[c.CakePartType.top]=5,o[c.CakePartType.ornament]=6,o);this.needFinishPartIds=this.needFinishPartIds.sort(function(e,t){var o=r.default.get_from_cake_part_db(e),n=a[o.type],i=r.default.get_from_cake_part_db(t),s=a[i.type];return n<s?-1:n==s?0:n>s?1:void 0});for(var i=0;i<this.needFinishPartIds.length;i++){var s=this.needFinishPartIds[i];cc.log(s)}},t.prototype._refresh=function(){var e=this.context.customerId,t=r.default.get_from_customer_db(e);this.spine&&(s.default.put(this.spine),this.spine.removeFromParent(),this.spine=null),this.spine=s.default.get("spine",t.spineId),this.spine.parent=this.nodeSpine,this.spine.play("mov_3",!0),this.viewAvatar.takeOffAll(),this.viewAvatar.replacePartIdArray(this.needFinishPartIds)},t.prototype.moveToWatting=function(){this.stopAllActions(),this.runAction(cc.moveTo(.5,cc.v2(300,0)))},t.prototype.moveToCenter=function(e){var t=this;if(!this.isResourceLoaded())return this.context.needMoveToCenter=!0,void(this.context.moveToCenterCallback=e);this.stopAllActions(),this.runAction(cc.sequence(cc.moveTo(.3,cc.v2(130,0)),cc.callFunc(function(){t.nodeBubble.runAction(cc.scaleTo(.3,1,1)),e()})))},t.prototype.playErrorAction=function(){this.spine.stopAllActions(),this.spine.runAction(cc.sequence(cc.moveTo(.1,-10,0),cc.moveTo(.1,10,0),cc.moveTo(.1,-10,0),cc.moveTo(.1,10,0),cc.moveTo(.1,0,0))),this.spine.play(["mov_1","mov_3"],!0)},t.prototype.moveToOut=function(e){var t=this;this.stopAllActions(),this.runAction(cc.sequence(cc.callFunc(function(){t.nodeBubble.runAction(cc.scaleTo(.3,1,1))}),cc.delayTime(.3),cc.moveTo(.5,cc.v2(-1e3,0)),cc.callFunc(function(){e()}))),this.spine.play("mov_2")},t.prototype.getCurrentPartId=function(){return this.needFinishPartIds.length>0?this.needFinishPartIds[0]:null},t.prototype.getCurrentPartType=function(){var e=this.getCurrentPartId();return e?r.default.get_from_cake_part_db(e).type:null},t.prototype.markCurrentPartId=function(e){var t=this.getCurrentPartId();return!(!t||e!=t)&&(this.needFinishPartIds.splice(this.needFinishPartIds.indexOf(e),1),this.finishedPartIds.push(e),!0)},t.prototype.checkCurrentPartId=function(e){var t=this.getCurrentPartId();return!(!t||e!=t)||(this.playErrorAction(),!1)},t.prototype.isAllFinished=function(){return this.needFinishPartIds.length<=0},t.prototype.getAvatarWorldPos=function(){return this.viewAvatar.convertToWorldSpaceAR(cc.v2(0,0))},t.prototype.onTouchButtonScale=function(e){e.isClick()&&l.default.openDialog("vShowCakeDialog",{partIds:this.viewAvatar.getPartIds()})},t=__decorate([d],t)}(a.default));o.default=p,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/ViewBase":"ViewBase","../../Const":"Const","./../../manager/mgrCfg":"mgrCfg","./../../manager/mgrDirector":"mgrDirector","./../../manager/mgrPool":"mgrPool","./vAvatar":"vAvatar"}],vGameFailedDialog:[function(e,t,o){"use strict";cc._RF.push(t,"ca2c21Pw1tIO6yEt5NhyeiP","vGameFailedDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("./../../manager/mgrDirector"),i=e("../../manager/mgrSound"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonClose=null,t.buttonConfirm=null,t.labelNpcWord=null,t.nodeStart1=null,t.nodeStart2=null,t.nodeStart3=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vGameFailedDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_buttonConfirm:{varname:"buttonConfirm",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonConfirm"}]},CC_labelNpcWord:{varname:"labelNpcWord",vartype:cc.Label},CC_nodeStart1:{varname:"nodeStart1",vartype:cc.Node},CC_nodeStart2:{varname:"nodeStart2",vartype:cc.Node},CC_nodeStart3:{varname:"nodeStart3",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),i.default.play(104)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.isClickShadowClose=function(){return!1},t.prototype.onTouchButtonClose=function(e){e.isClick()&&r.default.enterScene("vHubScene",{bFromStage:!0})},t.prototype.onTouchButtonConfirm=function(e){e.isClick()&&r.default.enterScene("vHubScene",{bFromStage:!0})},t=__decorate([c],t)}(a.default));o.default=l,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../manager/mgrSound":"mgrSound","./../../manager/mgrDirector":"mgrDirector"}],vGamePartIcon:[function(e,t,o){"use strict";cc._RF.push(t,"ef9a8X8UmVJ/KeAx/9MTX40","vGamePartIcon"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/ViewBase"),a=e("../../manager/mgrCfg"),r=e("./../../manager/mgrPlayer"),i=e("../../Const"),s=e("./vAvatar"),c=e("../../../ulframework/utils/Tools"),l=e("../../manager/mgrSound"),u=cc._decorator,d=u.ccclass,p=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodeBg=null,t.nodeLock=null,t.spriteBg=null,t.spriteIcon=null,t.partId=0,t.viewAvatar=null,t.bTry=!1,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vGamePartIcon"},t.prototype._getResourceBindingConfig=function(){return{CC_nodeBg:{varname:"nodeBg",vartype:cc.Node},CC_nodeLock:{varname:"nodeLock",vartype:cc.Node},CC_spriteBg:{varname:"spriteBg",vartype:cc.Sprite},CC_spriteIcon:{varname:"spriteIcon",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.viewAvatar=new s.default,this.viewAvatar.parent=this.spriteIcon.node,this.viewAvatar.scale=.18,this.spriteBg.node.active=!this.context.bWithoutBg,c.default.registerTouchHandler(this.nodeBg,this.onTouchButtonBg.bind(this)),this._refresh()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fillByPartId=function(e,t){this.partId=e,this.bTry=t,this._refresh()},t.prototype._refresh=function(){if(this.isResourceLoaded()&&this.partId){var e=a.default.get_from_cake_part_db(this.partId);this.nodeLock.active=r.default.getItemAmount(this.partId)<=0&&!this.bTry,this.spriteIcon.spriteFrame=null,this.viewAvatar.takeOffAll(),e&&e.type==i.CakePartType.body?this.viewAvatar.replace(this.partId):this.spriteIcon.loadSpriteFrame(e.icon)}},t.prototype.onTouchButtonBg=function(e){"began"==e.name&&l.default.play(101),this.context.fOnClick instanceof Function&&this.context.fOnClick(e,this.partId)},t=__decorate([d],t)}(n.default));o.default=p,cc._RF.pop()},{"../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/ViewBase":"ViewBase","../../Const":"Const","../../manager/mgrCfg":"mgrCfg","../../manager/mgrSound":"mgrSound","./../../manager/mgrPlayer":"mgrPlayer","./vAvatar":"vAvatar"}],vGameScene:[function(e,t,o){"use strict";cc._RF.push(t,"9fb57dx9U9NOY4by7dwlS5x","vGameScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../manager/mgrDirector"),r=e("./../../manager/mgrCfg"),i=e("../../../ulframework/view/ReuseList"),s=e("../../../ulframework/utils/Tools"),c=e("../node/vGamePartIcon"),l=e("./../../../ulframework/view/FSMSceneBase"),u=e("../node/vGameCustomer"),d=e("../../Const"),p=e("../../manager/mgrPlayer"),h=e("./../../manager/mgrTip"),f=e("./../../../ulframework/utils/Timer"),g=e("../../../ulframework/view/ReuseLayouterVGrid"),m=e("../node/vAvatar"),v=e("../../manager/mgrStage"),_=e("./../../manager/mgrCake"),y=e("./../../manager/mgrSdk"),C=e("./../../manager/mgrGuide"),S=e("./../../manager/mgrSound"),b=e("./../../../ulframework/view/DialogBase"),T=e("../node/vGameShowingPartIcon"),R=cc._decorator,k=R.ccclass,I=(R.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonBack=null,t.labelCustomerCount=null,t.labelScore=null,t.labelTime=null,t.labelWatting=null,t.nodeAvatar=null,t.nodeCustomer=null,t.nodeLeftTop=null,t.nodeList=null,t.nodeOperationCheck=null,t.nodeStars=null,t.nodeTop=null,t.nodeType1=null,t.nodeType2=null,t.nodeType3=null,t.nodeType4=null,t.nodeType5=null,t.nodeType6=null,t.progressBarStar1=null,t.progressBarStar2=null,t.progressBarStar3=null,t.progressBarTime=null,t.listParts=null,t.viewAvatar=null,t.ST_ENTER=1,t.ST_GAME_GENERATE_CUSTOMER=2,t.ST_SELECT_PART=3,t.ST_WAITTING=4,t.ST_PALYING_ANIMATION=5,t.ST_SETTLEMENT=6,t.queueCustomerIds=[],t.mustExistPartIds=[],t.activeCustomers=[],t.completeCustomerIds=[],t.processingCustomer=null,t.curTryPartIds=[],t.score=0,t.remainTime=0,t.maxTime=0,t.starCalcTime=null,t.GAME_STATE_RUNING=1,t.GAME_STATE_END=2,t.gameState=t.GAME_STATE_RUNING,t.showingPartIcon=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"scene/vGameScene"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonBack:{varname:"buttonBack",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonBack"}]},CC_labelCustomerCount:{varname:"labelCustomerCount",vartype:cc.Label},CC_labelScore:{varname:"labelScore",vartype:cc.Label},CC_labelTime:{varname:"labelTime",vartype:cc.Label},CC_labelWatting:{varname:"labelWatting",vartype:cc.Label},CC_nodeAvatar:{varname:"nodeAvatar",vartype:cc.Node},CC_nodeCustomer:{varname:"nodeCustomer",vartype:cc.Node},CC_nodeLeftTop:{varname:"nodeLeftTop",vartype:cc.Node},CC_nodeList:{varname:"nodeList",vartype:cc.Node},CC_nodeOperationCheck:{varname:"nodeOperationCheck",vartype:cc.Node},CC_nodeStars:{varname:"nodeStars",vartype:cc.Node},CC_nodeTop:{varname:"nodeTop",vartype:cc.Node},CC_nodeType1:{varname:"nodeType1",vartype:cc.Node},CC_nodeType2:{varname:"nodeType2",vartype:cc.Node},CC_nodeType3:{varname:"nodeType3",vartype:cc.Node},CC_nodeType4:{varname:"nodeType4",vartype:cc.Node},CC_nodeType5:{varname:"nodeType5",vartype:cc.Node},CC_nodeType6:{varname:"nodeType6",vartype:cc.Node},CC_progressBarStar1:{varname:"progressBarStar1",vartype:cc.ProgressBar},CC_progressBarStar2:{varname:"progressBarStar2",vartype:cc.ProgressBar},CC_progressBarStar3:{varname:"progressBarStar3",vartype:cc.ProgressBar},CC_progressBarTime:{varname:"progressBarTime",vartype:cc.ProgressBar}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),S.default.play(2)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.uiFadeIn(),this.buildUi(),this.fillData(),this.registerAllState(),this.setNextState(this.ST_ENTER),this.tryRecordVideo(),this.registerListeners({MSG_TRY_SUCCESSFUL:this.onMsgTrySuccessful}),this.registerListeners({MSG_ITEM_AMOUNT_CHANGED:this.onMsgItemAmountChanged}),C.default.registerGuideNode("vGameScene.nodeAvatar",this.nodeAvatar)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){if(e.prototype.update.call(this,t),this.isResourceLoaded()&&!b.default.hasDialogExists()&&this.gameState!=this.GAME_STATE_END){this.context.stageId>1&&(this.remainTime-=t),this.remainTime<=0&&(this.gameState=this.GAME_STATE_END,cc.log("hubsceneupdate: this.ST_SETTLEMENT"),this.setNextState(this.ST_SETTLEMENT));var o=this.remainTime/this.maxTime;this.progressBarTime.progress=o,this.labelTime.string=s.default.formatTime(this.remainTime,"%M:%S");var n=r.default.get_from_stage_db(this.context.stageId);if(n.script.isShowStar()){this.nodeStars.active=!0;var a=this.starCalcTime[0],i=this.starCalcTime[1];this.progressBarStar1.progress=o>i?1:o>a?1:o/a,this.progressBarStar2.progress=o>i?1:o>a?(o-a)/(i-a):0,this.progressBarStar3.progress=o>i?(o-i)/(1-i):0,this.labelCustomerCount.string=ul.format("\u5269\u4f59\u987e\u5ba2: %d",this.queueCustomerIds.length)}else this.nodeStars.active=!1,this.labelCustomerCount.string="\u5269\u4f59\u987e\u5ba2: \u221e";n.script.isShowScore()?(this.labelScore.node.active=!0,this.labelScore.string=ul.format("\u5f53\u524d\u5206\u6570\uff1a%d",this.score)):this.labelScore.node.active=!1}},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.registerAllState=function(){this.registerState(this.ST_ENTER,"__st_enter_enter","__st_enter_execute","__enter_leave"),this.registerState(this.ST_GAME_GENERATE_CUSTOMER,"__st_generate_customer_enter","__st_generate_customer_execute","__generate_customer_leave"),this.registerState(this.ST_SELECT_PART,"__st_select_part_enter","__st_select_part_execute","__select_part_leave"),this.registerState(this.ST_WAITTING,"__st_waitting_enter","__st_waitting_execute","__waitting_leave"),this.registerState(this.ST_PALYING_ANIMATION,"__st_playing_animation_enter","__st_playing_animation_execute","__playing_animation_leave"),this.registerState(this.ST_SETTLEMENT,"__st_settlement_enter","__st_settlement_execute","__settlement_leave")},t.prototype.tryRecordVideo=function(){y.default.isOpenVideoRecord()&&y.default.recordGameVideo("start",120)},t.prototype.uiFadeIn=function(){this.nodeTop.y=a.default.height/2,this.nodeLeftTop.x=-a.default.width/2,this.nodeLeftTop.y=a.default.height/2,a.default.isDeviceOverHeight()&&(this.nodeTop.y=a.default.height/2-50)},t.prototype.buildUi=function(){var e=this;a.default.isDeviceOverHeight()&&(this.nodeTop.y=a.default.height/2-50),this.viewAvatar=new m.default,this.viewAvatar.parent=this.nodeAvatar;for(var t=1;t<=6;t++){var o=this["nodeType"+t.toString()],n=o.getChildByName("icon").getComponent(cc.Sprite),l=r.default.get_from_cake_type_db(t);n.loadSpriteFrameAndKeepSize(l.icon),s.default.registerTouchHandler(o,function(e){e.isClick()})}var u=(new g.default).setCellSize(85,105).setGap(20,0).setCols(5).setPending(15),d=new i.default;d.parent=this.nodeList,d.setContentSize(this.nodeList.getContentSize()),d.setLayouter(u),d.setCreator(function(t){var o=new c.default({fOnClick:e.selectPart.bind(e)});o.parent=t,t.item=o}),d.setSetter(function(t,o){var n=t.item,a=r.default.get_from_stage_db(e.context.stageId);n.fillByPartId(o,!!e.curTryPartIds[o]||a.script.isPartDefaultOpen()),60001==o&&0==v.default.getStageProgress()&&(C.default.registerGuideNode("vGameScene.nodeBody",t),e.sendMsg("MSG_GUIDE_POINT",{id:"vGameScene.beginGameGuide"})),10001==o&&C.default.registerGuideNode("vGameScene.nodeSide",t)}),this.listParts=d,this.listParts.setTouchScrollEnabled(!1)},t.prototype.fillData=function(){var e=r.default.get_from_stage_db(this.context.stageId);this.remainTime=e.time,this.maxTime=e.time,this.starCalcTime=e.starCalcTime},t.prototype.__st_enter_enter=function(){var e=r.default.get_from_stage_db(this.context.stageId);this.queueCustomerIds=e.script.generateCustomerIds(),this.setNextState(this.ST_GAME_GENERATE_CUSTOMER),this.mustExistPartIds=ul.clone(e.poolAd)},t.prototype.__st_enter_execute=function(){},t.prototype.__enter_leave=function(){},t.prototype.__st_generate_customer_enter=function(){var e=this;if(this.queueCustomerIds.length<=0)this.setNextState(this.ST_SETTLEMENT);else{var t=this.mustExistPartIds.length>0?this.mustExistPartIds.splice(0,1)[0]:null;t=y.default.getCopAdMode()==d.AdMode.none?null:t;var o=this.queueCustomerIds.splice(0,1)[0];this.processingCustomer=new u.default({stageId:this.context.stageId,customerId:o,mustExistPartId:t}),this.processingCustomer.parent=this.nodeCustomer,this.processingCustomer.moveToCenter(function(){e.setNextState(e.ST_SELECT_PART)})}},t.prototype.__st_generate_customer_execute=function(){},t.prototype.__generate_customer_leave=function(){},t.prototype.__st_select_part_enter=function(){var e=this;if(this.processingCustomer.isAllFinished()){this.nodeList.scale=0,this.labelWatting.node.active=!0,this.completeCustomerIds.push(this.processingCustomer.context.customerId);var t=this.viewAvatar.getPartIds();this.viewAvatar.takeOffAll();var o=new m.default;o.parent=this.nodeAvatar,o.replacePartIdArray(t),o.runAction(cc.sequence(cc.spawn(cc.moveTo(.3,this.nodeAvatar.convertToNodeSpaceAR(this.processingCustomer.getAvatarWorldPos())),cc.scaleTo(.3,.75)),cc.callFunc(function(){e.processingCustomer.moveToOut(function(){e.setNextState(e.ST_GAME_GENERATE_CUSTOMER),e.processingCustomer.destroy(),e.processingCustomer=null})}),cc.removeSelf())),this.score+=_.default.calcScoreByPartIds(t),this.labelScore.node.runAction(cc.sequence(cc.scaleTo(.3,.9),cc.scaleTo(.3,1.1),cc.scaleTo(.3,1)))}else{this.nodeList.scale=1,this.labelWatting.node.active=!1;var n=this.processingCustomer.getCurrentPartType();this.selectPartType(n),this.setNextState(this.ST_WAITTING)}},t.prototype.__st_select_part_execute=function(){},t.prototype.__select_part_leave=function(){},t.prototype.__st_waitting_enter=function(){},t.prototype.__st_waitting_execute=function(){},t.prototype.__waitting_leave=function(){},t.prototype.__st_playing_animation_enter=function(){},t.prototype.__st_playing_animation_execute=function(){},t.prototype.__playing_animation_leave=function(){},t.prototype.__st_settlement_enter=function(){r.default.get_from_stage_db(this.context.stageId).script.finishGame({remainTime:this.remainTime,score:this.score,customerCount:this.completeCustomerIds.length,bAddition:this.context.bAddition}),this.gameState=this.GAME_STATE_END},t.prototype.__st_settlement_execute=function(){b.default.hasDialogExists()||a.default.enterScene("vHubScene",{bFromStage:!0})},t.prototype.__settlement_leave=function(){},t.prototype.selectPartType=function(e){for(var t=1;t<=6;t++){var o=this["nodeType"+t.toString()],n=o.getChildByName("selected"),a=o.getChildByName("normal");n.active=t==e,a.active=t!=e,o.scaleX=t==e?1.1:1,o.scaleY=t==e?1.15:1}this.fillPartList(e)},t.prototype.fillPartList=function(e){var t=r.default.get_from_stage_db(this.context.stageId).script.pools[e],o=ul.clone(t);for(o.indexOf(this.processingCustomer.getCurrentPartId())<0&&o.push(this.processingCustomer.getCurrentPartId());o.length>10;){var n=s.default.random(0,o.length-1);o[n]!=this.processingCustomer.getCurrentPartId()&&o.splice(n,1)}for(var a=[];o.length>0;)a.push(o.splice(0,1)[0]);this.listParts.setDatas(a)},t.prototype.selectPart=function(e,t){var o=this;if(this.getState()==this.ST_WAITTING&&(!this.getNextState()||this.getNextState()==this.ST_WAITTING)){var n=r.default.get_from_stage_db(this.context.stageId);if(p.default.getItemAmount(t)<=0&&null==this.curTryPartIds[t]&&!n.script.isPartDefaultOpen()){if(!e.isClick())return;n.poolAd.indexOf(t)<0?a.default.openDialog("vBuyItemDialog",{partId:t}):a.default.openDialog("vAdTryDialog",{partId:t})}else{if("began"==e.name){this.showingPartIcon=new T.default,this.showingPartIcon.fillByPartId(t),this.showingPartIcon.parent=h.default.getTipIceNode();var i=this.showingPartIcon.parent.convertToNodeSpaceAR(e.getLocation());this.showingPartIcon.setPosition(i),this.showingPartIcon.__originPos=i}if(this.showingPartIcon)if("moved"==e.name)this.showingPartIcon.setPosition(this.showingPartIcon.parent.convertToNodeSpaceAR(e.getLocation()));else if("cancelled"==e.name||"ended"==e.name){if(s.default.isWorldInLocalNode(this.nodeOperationCheck,e.getLocation())&&this.processingCustomer.checkCurrentPartId(t)){this.setNextState(this.ST_PALYING_ANIMATION);var c=this.showingPartIcon;this.showingPartIcon=null;var l=c.parent.convertToNodeSpaceAR(this.nodeAvatar.convertToWorldSpaceAR(cc.v2(0,0)));return void c.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,l),cc.fadeOut(.2)),cc.callFunc(function(){o.processingCustomer.markCurrentPartId(t),o.viewAvatar.replace(t),c.destroy(),c=null,o.setNextState(o.ST_SELECT_PART),f.default.callLater(.1,function(){o.sendMsg("MSG_GUIDE_POINT",{id:"vGameScene.materialMake"})})})))}var u=this.showingPartIcon;this.showingPartIcon=null,u.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,u.__originPos),cc.fadeOut(.2)),cc.callFunc(function(){u.destroy(),u=null})))}}}},t.prototype.onTouchButtonBack=function(e){e.isClick()&&h.default.alertPrompt2("\u63d0\u793a","\u63d0\u524d\u9000\u51fa\u4e0d\u80fd\u83b7\u5f97\u672c\u5173\u5956\u52b1\u54e6~","\u9000\u51fa","\u53d6\u6d88",function(){a.default.enterScene("vHubScene")})},t.prototype.onMsgTrySuccessful=function(e){this.curTryPartIds[e.partId]=!0,this.listParts.refreshActiveCells()},t.prototype.onMsgItemAmountChanged=function(){this.listParts.refreshActiveCells()},t=__decorate([k],t)}(l.default));o.default=I,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/ReuseLayouterVGrid":"ReuseLayouterVGrid","../../../ulframework/view/ReuseList":"ReuseList","../../Const":"Const","../../manager/mgrDirector":"mgrDirector","../../manager/mgrPlayer":"mgrPlayer","../../manager/mgrStage":"mgrStage","../node/vAvatar":"vAvatar","../node/vGameCustomer":"vGameCustomer","../node/vGamePartIcon":"vGamePartIcon","../node/vGameShowingPartIcon":"vGameShowingPartIcon","./../../../ulframework/utils/Timer":"Timer","./../../../ulframework/view/DialogBase":"DialogBase","./../../../ulframework/view/FSMSceneBase":"FSMSceneBase","./../../manager/mgrCake":"mgrCake","./../../manager/mgrCfg":"mgrCfg","./../../manager/mgrGuide":"mgrGuide","./../../manager/mgrSdk":"mgrSdk","./../../manager/mgrSound":"mgrSound","./../../manager/mgrTip":"mgrTip"}],vGameSettlementDialog:[function(e,t,o){"use strict";cc._RF.push(t,"f7f3cHsVhtAS6xZVs0p5DR/","vGameSettlementDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("./../../../ulframework/view/ReuseList"),i=e("./../../../ulframework/view/ReuseLayouterHBox"),s=e("../node/vGameSettlementItem"),c=e("../../manager/mgrStage"),l=(e("./../../manager/mgrDirector"),e("../../manager/mgrAd")),u=e("./../../manager/mgrSdk"),d=e("../../Const"),p=e("./../../manager/mgrPlayer"),h=e("./../../manager/mgrTip"),f=e("../../manager/mgrSound"),g=e("./../../Const"),m=(e("./../../../ulframework/utils/Timer"),e("../../../ulframework/utils/Tools"),cc._decorator),v=m.ccclass,_=(m.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonCarefulDouble=null,t.buttonCarefulSingle=null,t.buttonClose=null,t.buttonGetReleax=null,t.buttonNoAd=null,t.buttonShareVide=null,t.labelButtonSignReleax=null,t.labelNpcWord=null,t.labelTipCareful=null,t.labelTipReleax=null,t.nodeAdIconReleax=null,t.nodeCareful=null,t.nodeGetReleax=null,t.nodeList=null,t.nodeNoAd=null,t.nodeProgress=null,t.nodeReleax=null,t.nodeShareVideoReward=null,t.nodeStart1=null,t.nodeStart2=null,t.nodeStart3=null,t.nodeToogleParent=null,t.toggleDoubleReward=null,t.itemsReuseList=null,t.result=null,t.magnification=1,t.bGetedReward=!1,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vGameSettlementDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonCarefulDouble:{varname:"buttonCarefulDouble",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonCarefulDouble"}]},CC_buttonCarefulSingle:{varname:"buttonCarefulSingle",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonCarefulSingle"}]},CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_buttonGetReleax:{varname:"buttonGetReleax",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonGetReleax"}]},CC_buttonNoAd:{varname:"buttonNoAd",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonNoAd"}]},CC_buttonShareVide:{varname:"buttonShareVide",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonShareVide"}]},CC_labelButtonSignReleax:{varname:"labelButtonSignReleax",vartype:cc.Label},CC_labelNpcWord:{varname:"labelNpcWord",vartype:cc.Label},CC_labelTipCareful:{varname:"labelTipCareful",vartype:cc.Label},CC_labelTipReleax:{varname:"labelTipReleax",vartype:cc.Label},CC_nodeAdIconReleax:{varname:"nodeAdIconReleax",vartype:cc.Node},CC_nodeCareful:{varname:"nodeCareful",vartype:cc.Node},CC_nodeGetReleax:{varname:"nodeGetReleax",vartype:cc.Node},CC_nodeList:{varname:"nodeList",vartype:cc.Node},CC_nodeNoAd:{varname:"nodeNoAd",vartype:cc.Node},CC_nodeProgress:{varname:"nodeProgress",vartype:cc.Node},CC_nodeReleax:{varname:"nodeReleax",vartype:cc.Node},CC_nodeShareVideoReward:{varname:"nodeShareVideoReward",vartype:cc.Node},CC_nodeStart1:{varname:"nodeStart1",vartype:cc.Node},CC_nodeStart2:{varname:"nodeStart2",vartype:cc.Node},CC_nodeStart3:{varname:"nodeStart3",vartype:cc.Node},CC_nodeToogleParent:{varname:"nodeToogleParent",vartype:cc.Node},CC_toggleDoubleReward:{varname:"toggleDoubleReward",vartype:cc.Toggle}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),u.default.isOpenVideoRecord()&&u.default.recordGameVideo("stop"),f.default.play(103)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.result=this.context.result,this.bGetedReward=!1,this.buildUi(),this.fillData(),this.fillAd(),this.registerListeners({MSG_AD_EVENT_SUCCESSD:this.onMsgAdEventSuccessd,MSG_SDK_SHARE_VIDEO_RESULT:this.onMsgSdkShareVideoResult})},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.isClickShadowClose=function(){return!1},t.prototype.onOpenDialogCompleted=function(){},t.prototype.buildUi=function(){var e=(new i.default).setCellSize(84,84).setGap(10).setPending(10),t=new r.default;t.parent=this.nodeList,t.setContentSize(this.nodeList.getContentSize()),t.setLayouter(e),t.setCreator(function(e){var t=new s.default;t.parent=e,e.item=t}),t.setSetter(function(e,t){e.item.fillByItemId(t.itemId,t.amount)}),this.itemsReuseList=t,this.itemsReuseList.setTouchScrollEnabled(!1)},t.prototype.fillData=function(){this.labelNpcWord.string=this.result.rating>0?"\u4f60\u505a\u7684\u771f\u7684\u592a\u68d2\u4e86!":"\u5931\u8d25\u4e86\u771f\u53ef\u60dc",this.nodeStart1.active=this.result.rating>=1,this.nodeStart2.active=this.result.rating>=2,this.nodeStart3.active=this.result.rating>=3,this.buttonShareVide.node.active=u.default.isOpenVideoRecord(),this.nodeShareVideoReward.active=p.default.getItemAmount(g.default.ITEM_ID_VIDEO_SHARE_COUNT)>0;var e=[];this.result.rewardNum>0&&e.push({itemId:g.default.ITEM_ID_GOLD,amount:this.result.rewardNum}),this.itemsReuseList.setDatas(e);var t=c.default.getPowerCountAndMax(),o=t[0],n=t[1];this.nodeProgress.height=o/n*37.6},t.prototype.fillAd=function(){var e=l.default.preCheckCanTriggerAdEvent("game_reward");this.nodeNoAd.active=!e,this.nodeReleax.active=e&&u.default.getCopAdMode()==d.AdMode.releax,this.nodeCareful.active=e&&u.default.getCopAdMode()==d.AdMode.careful,this.toggleDoubleReward.node.on("toggle",this.refreshAdIcon.bind(this)),this.refreshAdIcon(),this.labelTipReleax.string="\u53cc\u500d\u5956\u52b1",this.labelTipCareful.string="\u89c2\u770b\u5e7f\u544a\u83b7\u5f97\u53cc\u500d\u5956\u52b1!",c.default.isPowerFull()&&(this.magnification=7,this.labelTipReleax.string="\u516b\u500d\u5956\u52b1",this.labelTipCareful.string="\u89c2\u770b\u5e7f\u544a\u83b7\u5f97\u516b\u500d\u5956\u52b1!")},t.prototype.refreshAdIcon=function(){var e=this.toggleDoubleReward.isChecked;cc.log("refreshAdIcon isChecked : ",e),this.nodeAdIconReleax.active=e},t.prototype.tryCloseDialog=function(){if(!this.bClosing){for(var e=this.itemsReuseList.getDatas(),t=0;t<e.length;t++){var o=e[t];h.default.addGotItemTip(o.itemId,o.amount)}this.bGetedReward=!0,this.closeDialog()}},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.tryCloseDialog()},t.prototype.onTouchButtonCarefulDouble=function(e){e.isClick()&&l.default.triggerAdEvent("game_reward",null,!0)},t.prototype.onTouchButtonCarefulSingle=function(e){e.isClick()&&this.tryCloseDialog()},t.prototype.onTouchButtonNoAd=function(e){e.isClick()&&this.tryCloseDialog()},t.prototype.onTouchButtonGetReleax=function(e){e.isClick()&&(this.toggleDoubleReward.isChecked?l.default.triggerAdEvent("game_reward",null,!0):this.tryCloseDialog())},t.prototype.onTouchButtonShareVide=function(e){e.isClick()&&u.default.isOpenVideoRecord()&&u.default.shareGameVideo()},t.prototype.onMsgAdEventSuccessd=function(e){if(1!=this.bGetedReward&&"game_reward"==e.adEventId){for(var t=this.itemsReuseList.getDatas(),o=0;o<t.length;o++){var n=t[o];p.default.addItemAmount(n.itemId,n.amount*this.magnification,"\u7ed3\u7b97\u5e7f\u544a\u5956\u52b1"),h.default.addGotItemTip(n.itemId,n.amount*(this.magnification+1))}this.magnification>1&&c.default.cleanPowerCount(),this.bGetedReward=!0,this.closeDialog()}},t.prototype.onMsgSdkShareVideoResult=function(e){e.isSuccess&&(this.buttonShareVide.node.active=!1)},t=__decorate([v],t)}(a.default));o.default=_,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/DialogBase":"DialogBase","../../Const":"Const","../../manager/mgrAd":"mgrAd","../../manager/mgrSound":"mgrSound","../../manager/mgrStage":"mgrStage","../node/vGameSettlementItem":"vGameSettlementItem","./../../../ulframework/utils/Timer":"Timer","./../../../ulframework/view/ReuseLayouterHBox":"ReuseLayouterHBox","./../../../ulframework/view/ReuseList":"ReuseList","./../../Const":"Const","./../../manager/mgrDirector":"mgrDirector","./../../manager/mgrPlayer":"mgrPlayer","./../../manager/mgrSdk":"mgrSdk","./../../manager/mgrTip":"mgrTip"}],vGameSettlementItem:[function(e,t,o){"use strict";cc._RF.push(t,"b9f82Tuu7pMP7B+iQfxH6Sx","vGameSettlementItem"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/ViewBase"),a=e("./../../manager/mgrCfg"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelName=null,t.spriteIcon=null,t.itemId=0,t.amount=0,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vGameSettlementItem"},t.prototype._getResourceBindingConfig=function(){return{CC_labelName:{varname:"labelName",vartype:cc.Label},CC_spriteIcon:{varname:"spriteIcon",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this._refresh()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fillByItemId=function(e,t){this.itemId=e,this.amount=t,this._refresh()},t.prototype._refresh=function(){if(this.isResourceLoaded()&&this.itemId){var e=a.default.get_from_item_template_db(this.itemId);this.spriteIcon.loadSpriteFrameAndKeepSize(e.icon),this.amount>1?this.labelName.string=e.name+"x"+this.amount.toString():this.labelName.string=e.name}},t=__decorate([i],t)}(n.default));o.default=s,cc._RF.pop()},{"../../../ulframework/view/ViewBase":"ViewBase","./../../manager/mgrCfg":"mgrCfg"}],vGameShowingPartIcon:[function(e,t,o){"use strict";cc._RF.push(t,"2582cmsdz9HlbynUnnpk5Fw","vGameShowingPartIcon"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/ViewBase"),a=e("./vAvatar"),r=e("../../manager/mgrCfg"),i=e("../../Const"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.spriteIcon=null,t.partId=0,t.viewAvatar=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vGameShowingPartIcon"},t.prototype._getResourceBindingConfig=function(){return{CC_spriteIcon:{varname:"spriteIcon",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.viewAvatar=new a.default,this.viewAvatar.parent=this.spriteIcon.node,this.viewAvatar.scale=.25,this._refresh()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fillByPartId=function(e){this.partId=e,this._refresh()},t.prototype._refresh=function(){if(this.isResourceLoaded()&&this.partId){var e=r.default.get_from_cake_part_db(this.partId);this.spriteIcon.spriteFrame=null,this.viewAvatar.takeOffAll(),e&&e.type==i.CakePartType.body?this.viewAvatar.replace(this.partId):this.spriteIcon.loadSpriteFrame(e.icon)}},t=__decorate([c],t)}(n.default));o.default=l,cc._RF.pop()},{"../../../ulframework/view/ViewBase":"ViewBase","../../Const":"Const","../../manager/mgrCfg":"mgrCfg","./vAvatar":"vAvatar"}],vGotItemDialog:[function(e,t,o){"use strict";cc._RF.push(t,"c5e75nVVFlNsKBjMpEmvHDz","vGotItemDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("../../manager/mgrCfg"),i=e("../../manager/mgrPlayer"),s=e("../../manager/mgrPool"),c=e("../../manager/mgrSound"),l=e("../../Const"),u=e("./../node/vAvatar"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonClose=null,t.labelDesc=null,t.nodeEff=null,t.spriteIcon=null,t.viewAvatar=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vGotItemDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_labelDesc:{varname:"labelDesc",vartype:cc.Label},CC_nodeEff:{varname:"nodeEff",vartype:cc.Node},CC_spriteIcon:{varname:"spriteIcon",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),c.default.play(102)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buildUi(),this.fillData(),i.default.markDisplayedGotItem(this.context.itemId)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.onOpenDialogCompleted=function(){this.nodeEff.scale=0;var e=s.default.get("animNode","jiesuan");e.play(),e.parent=this.nodeEff,this.nodeEff.runAction(cc.scaleTo(.1,2,2))},t.prototype.buildUi=function(){this.viewAvatar=new u.default,this.viewAvatar.parent=this.spriteIcon.node,this.viewAvatar.scale=.5},t.prototype.fillData=function(){var e=this.context.itemId,t=this.context.amount,o=r.default.get_from_item_template_db(e);this.spriteIcon.spriteFrame=null;var n=r.default.get_from_cake_part_db(e);n&&n.type==l.CakePartType.body?this.viewAvatar.replace(e):this.spriteIcon.loadSpriteFrame(o.icon),this.labelDesc.string=o.name+"*"+t},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.closeDialog()},t=__decorate([p],t)}(a.default));o.default=h,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../Const":"Const","../../manager/mgrCfg":"mgrCfg","../../manager/mgrPlayer":"mgrPlayer","../../manager/mgrPool":"mgrPool","../../manager/mgrSound":"mgrSound","./../node/vAvatar":"vAvatar"}],vGuideArrow:[function(e,t,o){"use strict";cc._RF.push(t,"059d2vsboRBSqFIQYk8E6SK","vGuideArrow"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/ViewBase"),a=cc._decorator,r=a.ccclass,i=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vGuideArrow"},t.prototype._getResourceBindingConfig=function(){return{}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=__decorate([r],t)}(n.default));o.default=i,cc._RF.pop()},{"../../../ulframework/view/ViewBase":"ViewBase"}],vGuideMask:[function(e,t,o){"use strict";cc._RF.push(t,"1e813/+31BG6587xEYKG0RQ","vGuideMask"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/ViewBase"),a=e("../../manager/mgrDirector"),r=e("../../Const"),i=e("../../../ulframework/utils/Tools"),s=e("../../manager/mgrTip"),c=e("../../manager/mgrGuide"),l=cc._decorator,u=l.ccclass,d=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodeLeftBottom=null,t.spriteBlockBottom=null,t.spriteBlockLeft=null,t.spriteBlockRight=null,t.spriteBlockTop=null,t.spriteHole=null,t.rect=null,t.maskType=r.GuideMaskType.none_passAll,t.bFadeIn=!1,t._mask_click_last_time=0,t._mask_click_count=0,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vGuideMask"},t.prototype._getResourceBindingConfig=function(){return{CC_nodeLeftBottom:{varname:"nodeLeftBottom",vartype:cc.Node},CC_spriteBlockBottom:{varname:"spriteBlockBottom",vartype:cc.Sprite},CC_spriteBlockLeft:{varname:"spriteBlockLeft",vartype:cc.Sprite},CC_spriteBlockRight:{varname:"spriteBlockRight",vartype:cc.Sprite},CC_spriteBlockTop:{varname:"spriteBlockTop",vartype:cc.Sprite},CC_spriteHole:{varname:"spriteHole",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.updateMask(),this.updateListeners()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.setMaskType=function(e){this.maskType=e,this.updateMask(),this.updateListeners()},t.prototype.setRect=function(e){this.rect=e,this.updateMask()},t.prototype.updateListeners=function(){if(this.isResourceLoaded()){var e=this.maskType;this.spriteHole.node.opacity=0,this.spriteBlockLeft.node.opacity=0,this.spriteBlockRight.node.opacity=0,this.spriteBlockTop.node.opacity=0,this.spriteBlockBottom.node.opacity=0,i.default.unregisterTouchHandler(this.spriteHole.node),i.default.unregisterTouchHandler(this.spriteBlockLeft.node),i.default.unregisterTouchHandler(this.spriteBlockRight.node),i.default.unregisterTouchHandler(this.spriteBlockTop.node),i.default.unregisterTouchHandler(this.spriteBlockBottom.node),e==r.GuideMaskType.mask_passAll||e==r.GuideMaskType.none_passAll||(e==r.GuideMaskType.mask_blockAll||e==r.GuideMaskType.none_blockkAll?(i.default.registerTouchHandler(this.spriteHole.node,this.onTouchMask.bind(this),!0),i.default.registerTouchHandler(this.spriteBlockLeft.node,this.onTouchMask.bind(this),!0),i.default.registerTouchHandler(this.spriteBlockRight.node,this.onTouchMask.bind(this),!0),i.default.registerTouchHandler(this.spriteBlockTop.node,this.onTouchMask.bind(this),!0),i.default.registerTouchHandler(this.spriteBlockBottom.node,this.onTouchMask.bind(this),!0)):e!=r.GuideMaskType.mask_passHole&&e!=r.GuideMaskType.none_passHole||(i.default.registerTouchHandler(this.spriteBlockLeft.node,this.onTouchMask.bind(this),!0),i.default.registerTouchHandler(this.spriteBlockRight.node,this.onTouchMask.bind(this),!0),i.default.registerTouchHandler(this.spriteBlockTop.node,this.onTouchMask.bind(this),!0),i.default.registerTouchHandler(this.spriteBlockBottom.node,this.onTouchMask.bind(this),!0)))}},t.prototype.updateMask=function(){if(this.isResourceLoaded()){this.nodeResource.setContentSize(a.default.size),this.nodeLeftBottom.getComponent(cc.Widget).updateAlignment();var e,t=this.nodeResource.getContentSize(),o=this.rect,n=this.maskType,i=n==r.GuideMaskType.mask_blockAll||n==r.GuideMaskType.mask_passAll||n==r.GuideMaskType.mask_passHole;if(o)this.spriteHole.node.x=o.x,this.spriteHole.node.y=o.y,this.spriteHole.node.setContentSize(o.size),(e=this.spriteBlockLeft.getComponent(cc.Widget)).left=0,e.right=t.width-o.x,e.top=0,e.bottom=0,e.updateAlignment(),(e=this.spriteBlockRight.getComponent(cc.Widget)).left=o.xMax,e.right=0,e.top=0,e.bottom=0,e.updateAlignment(),(e=this.spriteBlockTop.getComponent(cc.Widget)).left=o.x,e.right=t.width-o.xMax,e.top=0,e.bottom=o.yMax,e.updateAlignment(),this.spriteBlockBottom.enabled=!0,(e=this.spriteBlockBottom.getComponent(cc.Widget)).left=o.x,e.right=t.width-o.xMax,e.top=t.height-o.y,e.bottom=0,e.updateAlignment();else(e=this.spriteBlockLeft.getComponent(cc.Widget)).left=0,e.right=0,e.top=0,e.bottom=0,e.updateAlignment();i?o?(this.spriteHole.enabled=!0,this.spriteBlockLeft.enabled=!0,this.spriteBlockRight.enabled=!0,this.spriteBlockTop.enabled=!0,this.spriteBlockBottom.enabled=!0):(this.spriteHole.enabled=!1,this.spriteBlockLeft.enabled=!0,this.spriteBlockRight.enabled=!1,this.spriteBlockTop.enabled=!1,this.spriteBlockBottom.enabled=!1):(this.spriteHole.enabled=!1,this.spriteBlockLeft.enabled=!1,this.spriteBlockRight.enabled=!1,this.spriteBlockTop.enabled=!1,this.spriteBlockBottom.enabled=!1)}},t.prototype.fadeIn=function(){if(this.bFadeIn=!0,this.isResourceLoaded()){var e=this.nodeLeftBottom;cc.isValid(e)&&(e.opacity=0,e.stopAllActions(),e.runAction(cc.fadeIn(.3)))}},t.prototype.fadeOut=function(){if(this.bFadeIn=!1,this.isResourceLoaded()){var e=this.nodeLeftBottom;cc.isValid(e)&&(e.stopAllActions(),e.runAction(cc.fadeOut(.3)))}},t.prototype._onClickMaskLeftTop=function(){var e=this._mask_click_last_time||0;(i.default.time()-e<.5?this._mask_click_count++:this._mask_click_count=0,cc.log("vGuideMask._onClickMaskLeftTop",this._mask_click_count),this._mask_click_last_time=i.default.time(),this._mask_click_count>=19)&&(this._mask_click_count=0,s.default.alertPrompt2("\u63d0\u793a","\u662f\u5426\u8df3\u8fc7\u65b0\u624b\u5f15\u5bfc\uff1f","\u53d6\u6d88","\u8df3\u8fc7",null,function(){c.default._debugCancelDebug()}).parent.zIndex=r.default.GLOBAL_ORDER_DIALOG+1)},t.prototype.onTouchMask=function(e){e.isClick()&&(this.sendMsg("MSG_GUIDE_POINT",{id:"vGuideMask.click"}),e.getLocationX()<=100&&e.getLocationY()>=a.default.height-100&&this._onClickMaskLeftTop())},t=__decorate([u],t)}(n.default));o.default=d,cc._RF.pop()},{"../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/ViewBase":"ViewBase","../../Const":"Const","../../manager/mgrDirector":"mgrDirector","../../manager/mgrGuide":"mgrGuide","../../manager/mgrTip":"mgrTip"}],vGuideTip:[function(e,t,o){"use strict";cc._RF.push(t,"54dbe1CSJhPS58JzJXVJ0sg","vGuideTip"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/ViewBase"),a=e("../../manager/mgrCfg"),r=e("../../manager/mgrPool"),i=e("../../manager/mgrPlayer"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelContent=null,t.labelName=null,t.nodeArrow=null,t.nodeSpine=null,t.spriteNameBg=null,t.spine=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vGuideTip"},t.prototype._getResourceBindingConfig=function(){return{CC_labelContent:{varname:"labelContent",vartype:cc.Label},CC_labelName:{varname:"labelName",vartype:cc.Label},CC_nodeArrow:{varname:"nodeArrow",vartype:cc.Node},CC_nodeSpine:{varname:"nodeSpine",vartype:cc.Node},CC_spriteNameBg:{varname:"spriteNameBg",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buildUi()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){cc.isValid(this.spine)&&(r.default.put(this.spine),this.spine.removeFromParent()),this.spine=null,e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){var e=this.context.guideId,t=this.context.step,o=a.default.get("guide_db",e,t);if(o.tipSpineId){var n=r.default.get("spine",o.tipSpineId);n&&(n.parent=this.nodeSpine,n.play("mov_1",!0),this.spine=n)}o.tipName?(this.spriteNameBg.node.active=!0,this.labelName.string=o.tipName):this.spriteNameBg.node.active=!1;var s=o.tipContent;s=s.replace("PLAYER_NAME",i.default.getName()),this.labelContent.string=s,this.nodeArrow.active=!o.bTipArrowDisabled},t.prototype.setAnchorPoint=function(e,t){this.isResourceLoaded()&&this.nodeResource.setAnchorPoint(e,t)},t=__decorate([c],t)}(n.default));o.default=l,cc._RF.pop()},{"../../../ulframework/view/ViewBase":"ViewBase","../../manager/mgrCfg":"mgrCfg","../../manager/mgrPlayer":"mgrPlayer","../../manager/mgrPool":"mgrPool"}],vGuideView:[function(e,t,o){"use strict";cc._RF.push(t,"38f2bEVSjVPJ6lsbQuojwI3","vGuideView");var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),a=this&&this.__decorate||function(e,t,o,n){var a,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(i=(r<3?a(i):r>3?a(t,o,i):a(t,o))||i);return r>3&&i&&Object.defineProperty(t,o,i),i};Object.defineProperty(o,"__esModule",{value:!0});var r=e("../../manager/mgrCfg"),i=e("../../manager/mgrGuide"),s=e("../../manager/mgrPool"),c=e("./vGuideMask"),l=e("./vGuideTip"),u=e("./vGuideArrow"),d=e("../../../ulframework/view/ViewBase"),p=e("../../manager/mgrSound"),h=e("../../../ulframework/utils/Timer"),f=e("../../../ulframework/utils/Tools"),g=cc._decorator,m=g.ccclass,v=(g.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bHide=!1,t.slideIndex=0,t}return n(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t),this.updatePos()},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this),this.bHide||(cc.warn("vGuideView.onCleanup \u5f15\u5bfc\u5f02\u5e38\u9000\u51fa\uff0c\u5e76\u6ca1\u6709\u8c03\u7528\u8fc7hideAndRemove\u51fd\u6570"),cc.warn("  \u5c1d\u8bd5\u53d6\u6d88\u5f15\u5bfc"),i.default.cancelGuide()),cc.isValid(this.animClick)&&(s.default.put(this.animClick),this.animClick.removeFromParent(),this.animClick=null)},t.prototype.buildUi=function(){var e=this.context.guideId,t=this.context.step,o=r.default.get("guide_db",e,t);if(cc.isValid(this.mask)&&(this.mask.destroy(),this.mask=null),cc.isValid(this.tip)&&(this.tip.destroy(),this.tip=null),cc.isValid(this.arrow)&&(this.arrow.destroy(),this.arrow=null),this.mask=new c.default,this.mask.parent=this,this.mask.setMaskType(o.maskType),o.tipContent&&(this.tip=new l.default({guideId:e,step:t}),this.tip.parent=this),"click"==o.arrowType){var n=o.bFlipArrow?-1:1,a=new cc.Node;a.parent=this,a.scaleX=n,a.rotation=o.arrowRotate,this.nodeSpine=a;var i=s.default.get("animNode","guideclick");i.parent=a,this.animClick=i}else"slide"==o.arrowType&&(this.arrow=new u.default,this.arrow.parent=this,this.arrow.scaleX=o.bFlipArrow?-1:1,this.playSlideArrowAction())},t.prototype.playSlideArrowAction=function(){var e=this.context.guideId,t=this.context.step,o=r.default.get("guide_db",e,t),n=i.default.getGuideNodes(o.nodeNames);if(n.length<2)return cc.warn("vGuideView.playSlideArrowAction nodes not enough!"),this.arrow.destroy(),void(this.arrow=null);var a=this.slideIndex%n.length,s=n[a],c=f.default.convertRectToNodeSpace(this,f.default.calcNodeBoundingBoxToWorld(s,o.nodeExt));if(0==a)this.arrow.setPosition(c.center),this.arrow.opacity=0,this.arrow.runAction(cc.sequence(cc.fadeIn(.3),cc.callFunc(this.playSlideArrowAction.bind(this))));else if(a==n.length-1){var l=this.arrow.position.sub(c.center).mag()/450;this.arrow.runAction(cc.sequence(cc.moveTo(l,c.center),cc.fadeOut(.3),cc.callFunc(this.playSlideArrowAction.bind(this))))}else{l=this.arrow.position.sub(c.center).mag()/450;this.arrow.runAction(cc.sequence(cc.moveTo(l,c.center),cc.callFunc(this.playSlideArrowAction.bind(this))))}this.slideIndex++},t.prototype.show=function(){this.buildUi();var e=this.context.guideId,t=this.context.step,o=r.default.get("guide_db",e,t);o.soundId&&p.default.play(o.soundId),this.mask&&this.mask.fadeIn(),this.arrow&&(this.arrow.stopActionByTag(1),this.arrow.opacity=0,this.arrow.runAction(cc.fadeIn(.3)).setTag(1)),this.nodeSpine&&(this.nodeSpine.stopActionByTag(1),this.nodeSpine.opacity=0,this.nodeSpine.runAction(cc.fadeIn(.3)).setTag(1)),this.tip&&(this.tip.stopActionByTag(1),this.tip.opacity=0,this.tip.runAction(cc.fadeIn(.3)).setTag(1))},t.prototype.hideAndRemove=function(){var e=this;this.bHide=!0,cc.isValid(this.mask)&&this.mask.fadeOut(),cc.isValid(this.arrow)&&(this.arrow.stopAllActions(),this.arrow.runAction(cc.fadeOut(.3))),cc.isValid(this.nodeSpine)&&(this.nodeSpine.stopAllActions(),this.nodeSpine.runAction(cc.fadeOut(.3))),cc.isValid(this.tip)&&(this.tip.stopAllActions(),this.tip.runAction(cc.fadeOut(.3))),h.default.callLater(.3,function(){e.destroy()},this)},t.prototype.updatePos=function(){var e=this.context.guideId,t=this.context.step,o=r.default.get("guide_db",e,t),n=this.calcFirstNodeRect(),a=f.default.convertRectToNodeSpace(this,n);if(this.mask&&this.mask.setRect(n),this.tip)if(a){var i=0,s=0,c=0,l=0,u=o.tipDir||"left";"left"==u||"leftTop"==u||"leftBottom"==u?(i=a.x-10,c=1):"right"==u||"rightTop"==u||"rightBottom"==u?(i=a.xMax+10,c=0):(i=a.center.x,c=.5),"top"==u||"leftTop"==u||"rightTop"==u?(s=a.yMax+10,l=0):"bottom"==u||"leftBottom"==u||"rightBottom"==u?(s=a.y-10,l=1):(s=a.center.y,l=.5),cc.log("update tipPos",c,l,i,s),this.tip.setAnchorPoint(c,l),this.tip.x=i+(o.tipOffset[0]||0),this.tip.y=s+(o.tipOffset[1]||0)}else this.tip.setAnchorPoint(.5,.5),this.tip.x=o.tipOffset[0]||0,this.tip.y=o.tipOffset[1]||0;this.nodeSpine&&"click"==o.arrowType&&(a?cc.isValid(this.nodeSpine)&&this.nodeSpine.setPosition(a.center):cc.warn("vGuideView.updatePos rect not found!"))},t.prototype.calcFirstNodeRect=function(){var e=this.context.guideId,t=this.context.step,o=r.default.get("guide_db",e,t),n=o.nodeNames[0];if(!n)return null;var a=i.default.getGuideNode(n);return a?f.default.calcNodeBoundingBoxToWorld(a,o.nodeExt):null},t=a([m],t)}(d.default));o.default=v,cc._RF.pop()},{"../../../ulframework/utils/Timer":"Timer","../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/ViewBase":"ViewBase","../../manager/mgrCfg":"mgrCfg","../../manager/mgrGuide":"mgrGuide","../../manager/mgrPool":"mgrPool","../../manager/mgrSound":"mgrSound","./vGuideArrow":"vGuideArrow","./vGuideMask":"vGuideMask","./vGuideTip":"vGuideTip"}],vHubScene:[function(e,t,o){"use strict";cc._RF.push(t,"5896dix2f5DQpPQCLGzWG30","vHubScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/SceneBase"),r=e("../../manager/mgrSound"),i=e("../../manager/mgrDirector"),s=e("../../manager/mgrPlayer"),c=e("../../manager/mgrGuide"),l=e("../../manager/mgrTip"),u=e("../../../ulframework/utils/Timer"),d=e("../../manager/mgrSign"),p=e("../node/vTitleBar"),h=e("../../Const"),f=e("../../manager/mgrStage"),g=e("../../manager/mgrAd"),m=e("../../manager/mgrSdk"),v=e("../node/vJumpOtherGame"),_=e("../../manager/mgrRole"),y=e("../../manager/mgrShop"),C=cc._decorator,S=C.ccclass,b=(C.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonDevTest=null,t.buttonFreeMall=null,t.buttonMatch=null,t.buttonMoreGame=null,t.buttonSetting=null,t.buttonShare=null,t.buttonSign=null,t.buttonStart=null,t.nodeBg=null,t.nodeJumpOtherGame=null,t.nodeLeftTop=null,t.nodeStart=null,t.nodeTitleBar=null,t.nodeTop=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"scene/vHubScene"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonDevTest:{varname:"buttonDevTest",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonDevTest"}]},CC_buttonFreeMall:{varname:"buttonFreeMall",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonFreeMall"}]},CC_buttonMatch:{varname:"buttonMatch",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonMatch"}]},CC_buttonMoreGame:{varname:"buttonMoreGame",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonMoreGame"}]},CC_buttonSetting:{varname:"buttonSetting",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonSetting"}]},CC_buttonShare:{varname:"buttonShare",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonShare"}]},CC_buttonSign:{varname:"buttonSign",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonSign"}]},CC_buttonStart:{varname:"buttonStart",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonStart"}]},CC_nodeBg:{varname:"nodeBg",vartype:cc.Node},CC_nodeJumpOtherGame:{varname:"nodeJumpOtherGame",vartype:cc.Node},CC_nodeLeftTop:{varname:"nodeLeftTop",vartype:cc.Node},CC_nodeStart:{varname:"nodeStart",vartype:cc.Node},CC_nodeTitleBar:{varname:"nodeTitleBar",vartype:cc.Node},CC_nodeTop:{varname:"nodeTop",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this),r.default.play(1)},t.prototype.onResourceLoaded=function(){var t=this;e.prototype.onResourceLoaded.call(this),this.uiFadeIn(),this.buildUi(),this.fillData(),this.registerListeners({MSG_SHARE_RESULT:this.onMsgShareResult,MSG_ADV_VALID_COUNT:this.onMsgAdValidCount,MSG_WALL_CHANGE:this.onMsgWallChange}),this.refreshBts(),s.default.getName().length<=0?i.default.openDialog("vIntitleDialog",{endCallback:function(){t._tryGuide(),t._tryOpenSomeDialog(),t._tryAlertWxgzhReward()}}):(this._tryGuide(),this._tryOpenSomeDialog(),this._tryAlertWxgzhReward()),this.context.bFromStage&&i.default.openDialog("vStageChooseDialog"),g.default.preCheckCanTriggerAdEvent("wrap_scene")?g.default.triggerAdEvent("wrap_scene",null,!0):g.default.triggerAdEvent("banner_all");var o=cc.view.getFrameSize();i.default.isDeviceOverHeight()?m.default.openCrossRecommend(10,Math.floor(.21*o.height)):m.default.openCrossRecommend(10,Math.floor(.16*o.height))},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t),this.refreshBts()},t.prototype.onDestroy=function(){g.default.closeAdv("banner_all"),m.default.closeCrossRecommend(),e.prototype.onDestroy.call(this)},t.prototype._tryOpenSomeDialog=function(){if(!c.default.isGuiding()){var e=_.default.getOfflineReward(),t=e[0],o=e[1];t>0?i.default.openDialog("vOfflineDialog",{pastTime:t,income:o}):0!=f.default.getStageProgress()&&(d.default.getState()!=h.SignState.canSign||i.default.openDialog("vSignDialog"))}},t.prototype._tryGuide=function(){c.default.registerGuideNode("vHubScene.buttonStage",this.buttonStart.node),0==f.default.getStageProgress()&&this.sendMsg("MSG_GUIDE_POINT",{id:"vHubScene.beginHubGuide"})},t.prototype.uiFadeIn=function(){this.nodeTop.y=i.default.height/2,this.nodeLeftTop.x=-i.default.width/2,this.nodeLeftTop.y=i.default.height/2,i.default.isDeviceOverHeight()&&(this.nodeTop.y=i.default.height/2-50,this.nodeLeftTop.y=i.default.height/2-50)},t.prototype.buildUi=function(){this.refreshBg(),new p.default({bHideEnergy:!1}).parent=this.nodeTitleBar,(new v.default).parent=this.nodeJumpOtherGame;this.nodeStart.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.4,1.05),cc.scaleTo(.4,1)))),i.default.isDeviceOverHeight()&&(this.nodeTitleBar.parent.y=i.default.height/2-50)},t.prototype.fillData=function(){},t.prototype.refreshBg=function(){},t.prototype.refreshBts=function(){this.isResourceLoaded()&&(this.buttonShare.node.active=s.default.canShare(),this.buttonMoreGame.node.active="1"==m.default.getCopByKey("b_more_game"),this.buttonSign.node.active=!d.default.isSignOver(),this.buttonFreeMall.node.active=y.default.canSupplyItem(h.default.ITEM_ID_GOLD)||y.default.canSupplyItem(h.default.ITEM_ID_ENERGY),this.buttonDevTest.node.active=!1)},t.prototype._tryAlertWxgzhReward=function(){if(s.default.isNeedAlertWxgzhReward){var e=s.default.takeWxgzhReward();u.default.callLater(.5,function(){l.default.showMsgTip("\u5fae\u4fe1\u516c\u4f17\u53f7\u5956\u52b1 \u91d1\u5e01x"+e)}),c.default.isGuiding()||l.default.addGotItemTip(h.default.ITEM_ID_GOLD,e)}},t.prototype.onTouchButtonSetting=function(e){e.isClick()&&i.default.openDialog("vSettingDialog")},t.prototype.onTouchButtonShare=function(e){e.isClick()&&s.default.tryShowShare(null)},t.prototype.onTouchButtonSign=function(e){e.isClick()&&i.default.openDialog("vSignDialog")},t.prototype.onTouchButtonMoreGame=function(e){e.isClick()&&i.default.openDialog("vMoreGameDialog")},t.prototype.onTouchButtonStart=function(e){e.isClick()&&(this.sendMsg("MSG_GUIDE_POINT",{id:"vHubScene.buttonStage.click"}),i.default.openDialog("vStageChooseDialog"))},t.prototype.onTouchButtonFreeMall=function(e){e.isClick()&&i.default.openDialog("vShopDialog")},t.prototype.onTouchButtonMatch=function(e){e.isClick()&&i.default.enterScene("vRankScene")},t.prototype.onTouchButtonDevTest=function(e){e.isClick()&&i.default.enterScene("vDevTestScene")},t.prototype.onMsgShareResult=function(e){this.refreshBts()},t.prototype.onMsgAdValidCount=function(e){this.refreshBts()},t.prototype.onMsgWallChange=function(e){this.refreshBg()},t=__decorate([S],t)}(a.default));o.default=b,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/utils/Timer":"Timer","../../../ulframework/view/SceneBase":"SceneBase","../../Const":"Const","../../manager/mgrAd":"mgrAd","../../manager/mgrDirector":"mgrDirector","../../manager/mgrGuide":"mgrGuide","../../manager/mgrPlayer":"mgrPlayer","../../manager/mgrRole":"mgrRole","../../manager/mgrSdk":"mgrSdk","../../manager/mgrShop":"mgrShop","../../manager/mgrSign":"mgrSign","../../manager/mgrSound":"mgrSound","../../manager/mgrStage":"mgrStage","../../manager/mgrTip":"mgrTip","../node/vJumpOtherGame":"vJumpOtherGame","../node/vTitleBar":"vTitleBar"}],vInfiniteSettlementDialog:[function(e,t,o){"use strict";cc._RF.push(t,"a3450ec2tBLKqbilRKdcQLZ","vInfiniteSettlementDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("../../manager/mgrDirector"),i=e("./../../manager/mgrRank"),s=e("../../Const"),c=e("./../../manager/mgrTip"),l=e("./../../manager/mgrSdk"),u=e("../../manager/mgrPlayer"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonBack=null,t.buttonClose=null,t.buttonShare=null,t.labelCustomerCount=null,t.labelHistoryMaxScore=null,t.labelNpcWord=null,t.labelScore=null,t.nodeStart1=null,t.nodeStart2=null,t.nodeStart3=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vInfiniteSettlementDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonBack:{varname:"buttonBack",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonBack"}]},CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_buttonShare:{varname:"buttonShare",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonShare"}]},CC_labelCustomerCount:{varname:"labelCustomerCount",vartype:cc.Label},CC_labelHistoryMaxScore:{varname:"labelHistoryMaxScore",vartype:cc.Label},CC_labelNpcWord:{varname:"labelNpcWord",vartype:cc.Label},CC_labelScore:{varname:"labelScore",vartype:cc.Label},CC_nodeStart1:{varname:"nodeStart1",vartype:cc.Node},CC_nodeStart2:{varname:"nodeStart2",vartype:cc.Node},CC_nodeStart3:{varname:"nodeStart3",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buttonShare.node.active=1==l.default.getCopNumberValueByKey("b_share")&&u.default.canShare(),this.fillData()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.isClickShadowClose=function(){return!1},t.prototype.fillData=function(){this.labelCustomerCount.string=this.context.customerCount,this.labelScore.string=this.context.bAddition?ul.format("%d(+20%%)",1.2*this.context.score):this.context.score.toString(),this.labelHistoryMaxScore.string=i.default.getMaxScore(s.default.SERVER_RANK_ID).toString()},t.prototype.preClose=function(){var e=this.context.bAddition?1.2*this.context.score:this.context.score;e>i.default.getMaxScore(s.default.SERVER_RANK_ID)?c.default.alertPrompt("\u63d0\u4ea4","\u672c\u6b21\u8868\u73b0\u975e\u5e38\u597d\uff01\u521b\u9020\u4e86\u65b0\u7684\u8bb0\u5f55!","\u786e\u5b9a",function(){i.default.setMaxScore(s.default.SERVER_RANK_ID,e),i.default.requestUploadToRank(s.default.SERVER_RANK_ID,i.default.getMaxScore(s.default.SERVER_RANK_ID)),r.default.enterScene("vRankScene")}):r.default.enterScene("vRankScene")},t.prototype.onTouchButtonBack=function(e){e.isClick()&&this.preClose()},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.preClose()},t.prototype.onTouchButtonShare=function(e){e.isClick()&&u.default.tryShowShare(null)},t=__decorate([p],t)}(a.default));o.default=h,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../Const":"Const","../../manager/mgrDirector":"mgrDirector","../../manager/mgrPlayer":"mgrPlayer","./../../manager/mgrRank":"mgrRank","./../../manager/mgrSdk":"mgrSdk","./../../manager/mgrTip":"mgrTip"}],vIntitleDialog:[function(e,t,o){"use strict";cc._RF.push(t,"876dc8EyqpFiq0Rl9xQvWgn","vIntitleDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("./../../manager/mgrPlayer"),i=cc._decorator,s=i.ccclass,c=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonRandom=null,t.buttonSure=null,t.labelName=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vIntitleDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonRandom:{varname:"buttonRandom",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonRandom"}]},CC_buttonSure:{varname:"buttonSure",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonSure"}]},CC_labelName:{varname:"labelName",vartype:cc.Label}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this);var t=r.default.calcRandomName();this.labelName.string=t},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.isClickShadowClose=function(){return!1},t.prototype.onTouchButtonRandom=function(e){if(e.isClick()){var t=r.default.calcRandomName();this.labelName.string=t}},t.prototype.onTouchButtonSure=function(e){if(e.isClick()){var t=this.labelName.string;r.default.setName(t),this.closeDialog(),this.context.endCallback instanceof Function&&this.context.endCallback()}},t=__decorate([s],t)}(a.default));o.default=c,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","./../../manager/mgrPlayer":"mgrPlayer"}],vJumpOtherGame:[function(e,t,o){"use strict";cc._RF.push(t,"ee49aaD80RP75oc36yvMFIp","vJumpOtherGame"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/ViewBase"),r=e("../../manager/mgrCfg"),i=e("../../manager/mgrSdk"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonIcon=null,t.spriteIcon=null,t.showIndex=0,t.dbData=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vJumpOtherGame"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonIcon:{varname:"buttonIcon",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonIcon"}]},CC_spriteIcon:{varname:"spriteIcon",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.nodeResource.active="1"==i.default.getCopByKey("b_jump_other_game"),this.changeIndex(),this.repeatAction()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.repeatAction=function(){var e=this;this.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1.5),cc.rotateTo(.125,15).easing(cc.easeOut(1.5)),cc.rotateTo(.25,-15).easing(cc.easeInOut(1.5)),cc.rotateTo(.25,15).easing(cc.easeInOut(1.5)),cc.rotateTo(.25,-15).easing(cc.easeInOut(1.5)),cc.rotateTo(.125,0).easing(cc.easeIn(1.5)),cc.delayTime(1.5),cc.callFunc(function(){e.changeIndex()}))))},t.prototype.changeIndex=function(){var e=r.default.getDb("jump_other_game_db"),t=ul.length(e);if(this.showIndex++,this.showIndex>t&&(this.showIndex=1),this.dbData=r.default.get_from_jump_other_game_db(this.showIndex),!this.dbData)return this.stopAllActions(),this.spriteIcon.spriteFrame=null,void(this.active=!1);this.spriteIcon.loadSpriteFrame(this.dbData.icon)},t.prototype.onTouchButtonIcon=function(e){e.isClick()&&this.dbData&&i.default.jumpOtherGame(this.dbData.gameIndex)},t=__decorate([c],t)}(a.default));o.default=l,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/ViewBase":"ViewBase","../../manager/mgrCfg":"mgrCfg","../../manager/mgrSdk":"mgrSdk"}],vLevelBar:[function(e,t,o){"use strict";cc._RF.push(t,"f87e2eS/4NPPYnhCtVcVVe5","vLevelBar"),Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,a=n.ccclass,r=(n.property,function(e){function t(){var t=e.call(this)||this;return t.maxLevel=5,t.curLevel=5,t.space=-5,t.itemPath="2d/ui/common/star",t.layoutStyle=cc.Layout.Type.HORIZONTAL,t.levelSprites={},t}return __extends(t,e),t.prototype.setItemPath=function(e){this.itemPath=e},t.prototype.setLevel=function(e,t){this.maxLevel=e,this.curLevel=t,this.generate()},t.prototype.setLayoutStyle=function(e){this.layoutStyle=e},t.prototype.setSpace=function(e){this.space=e},t.prototype.generate=function(){for(var e=0;e<this.maxLevel;e++){if(null==(n=this.levelSprites[e]))(n=new cc.Node).parent=this,this.levelSprites[e]=n,n.addComponent(cc.Sprite).loadSpriteFrame(this.itemPath),n.setContentSize(19,17)}var t=this.getComponent(cc.Layout);null==t&&((t=this.addComponent(cc.Layout)).type=this.layoutStyle,t.resizeMode=cc.Layout.ResizeMode.CONTAINER,this.layoutStyle==cc.Layout.Type.HORIZONTAL?t.spacingX=this.space:t.spacingY=this.space,this.setAnchorPoint(.5,.5));for(var o=this.maxLevel;o>0;o--){var n=this.levelSprites[o-1];o>this.curLevel?n.active=!1:n.active=!0}t.updateLayout()},t=__decorate([a],t)}(cc.Node));o.default=r,cc._RF.pop()},{}],vLoadingScene:[function(e,t,o){"use strict";cc._RF.push(t,"a4eb2KLAtNH1L/gNfF/rXug","vLoadingScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../manager/mgrCfg"),r=e("../../../ulframework/manager/Manager"),i=e("../../manager/mgrDirector"),s=e("../../../ulframework/view/SceneBase"),c=e("../../manager/mgrSdk"),l=e("../../manager/mgrSound"),u=e("../../../ulframework/utils/Tools"),d=e("./../../manager/mgrRank"),p=e("./../../Const"),h=cc._decorator,f=h.ccclass,g=(h.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodeProgress=null,t.curProgress=0,t}return __extends(t,e),t.prototype._getResourceName=function(){return"scene/vLoadingScene"},t.prototype._getResourceBindingConfig=function(){return{CC_nodeProgress:{varname:"nodeProgress",vartype:cc.Node}}},t.prototype.onLoad=function(){cc.log("vLoadingScene.onLoad"),e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.registerListeners({MSG_CHANNEL_INFO_RESULT:this.onMsgChannelInfoResult}),this.buildUi(),this.beginLoading()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){},t.prototype.beginLoading=function(){var e=this;this.context.beginTime=u.default.time();var t=a.default.getLoadUrls().concat(["2d/animation/defaultDialogOpen","2d/animation/defaultDialogClose"]);cc.loader.loadResArray(t,function(t,o,n){var a=t/o;e.curProgress=a>e.curProgress?a:e.curProgress,e.updateProgress()},function(t,o){t&&cc.error("loadResArray error : ",t.message),e.loadFinish()}),this.updateProgress()},t.prototype.loadFinish=function(){a.default.processDb(),r.default.loadAllManagers(),d.default.requestSelfData(p.default.SERVER_RANK_ID),d.default.requestNextBatchPlayers(p.default.SERVER_RANK_ID),n.default.setSoundPlayHandler(function(){l.default.play(101)});var e=u.default.time()-this.context.beginTime;cc.log("loading finish, \u7528\u65f6"+1e3*e+"ms"),c.default.onLoadingComplete()},t.prototype.updateProgress=function(){cc.log("@:this.process: ",this.curProgress),this.nodeProgress.height=280*this.curProgress},t.prototype.startGame=function(){i.default.enterScene("vHubScene")},t.prototype.onMsgChannelInfoResult=function(e){this.startGame()},t=__decorate([f],t)}(s.default));o.default=g,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/manager/Manager":"Manager","../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/SceneBase":"SceneBase","../../manager/mgrCfg":"mgrCfg","../../manager/mgrDirector":"mgrDirector","../../manager/mgrSdk":"mgrSdk","../../manager/mgrSound":"mgrSound","./../../Const":"Const","./../../manager/mgrRank":"mgrRank"}],vMark:[function(e,t,o){"use strict";cc._RF.push(t,"fd723UmBTpHV5u37EQQBUDy","vMark"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/ViewBase"),a=cc._decorator,r=a.ccclass,i=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelCount=null,t.nodeRedPoint=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vMark"},t.prototype._getResourceBindingConfig=function(){return{CC_labelCount:{varname:"labelCount",vartype:cc.Label},CC_nodeRedPoint:{varname:"nodeRedPoint",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.refreshCount()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.setCount=function(e){this.context.count=e,this.isResourceLoaded()&&this.refreshCount()},t.prototype.refreshCount=function(){var e=this.context.count||"";this.labelCount.string=e},t=__decorate([r],t)}(n.default));o.default=i,cc._RF.pop()},{"../../../ulframework/view/ViewBase":"ViewBase"}],vMoreGameDialog:[function(e,t,o){"use strict";cc._RF.push(t,"b0c60HvL+lNSr7PtpATjgxA","vMoreGameDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonClose=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vMoreGameDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.closeDialog()},t=__decorate([i],t)}(a.default));o.default=s,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase"}],vMsgTip:[function(e,t,o){"use strict";cc._RF.push(t,"89714dAk3pNcohO3hCJp5Yp","vMsgTip"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/ViewBase"),a=e("../../manager/mgrTip"),r=e("../../manager/mgrDirector"),i=cc._decorator,s=i.ccclass,c=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelContent=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vMsgTip"},t.prototype._getResourceBindingConfig=function(){return{CC_labelContent:{varname:"labelContent",vartype:cc.Label}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buildUi(),this.fillData()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){this.labelContent.node.width=.9*r.default.width},t.prototype.fillData=function(){this.context.text&&this.setText(this.context.text),this.context.textColor&&this.setColorEx(this.context.textColor,this.context.outlineColor)},t.prototype.setText=function(e){this.context.text=e,this.isResourceLoaded()&&(this.labelContent.string=e)},t.prototype.setColorEx=function(e,t){if(this.context.textColor=e,this.context.outlineColor=t,this.isResourceLoaded()){this.labelContent.node.color=e;var o=this.labelContent.getComponent(cc.LabelOutline);t?(o.enabled=!0,o.color=t):o.enabled=!1}},t.prototype.play=function(e,t){this.parent=a.default.getTipRootNode(),t=t||50;var o=e||r.default.center,n=cc.v2(o.x,o.y+t);o=this.parent.convertToNodeSpace(o),n=this.parent.convertToNodeSpace(n),this.scale=0,this.setPosition(o),this.stopAllActions(),this.runAction(cc.spawn(cc.scaleTo(.15,1).easing(cc.easeIn(2)),cc.moveTo(1.1,n).easing(cc.easeOut(1.2)),cc.sequence(cc.fadeIn(.15).easing(cc.easeIn(2)),cc.delayTime(.65),cc.fadeOut(.3),cc.removeSelf())))},t=__decorate([s],t)}(n.default));o.default=c,cc._RF.pop()},{"../../../ulframework/view/ViewBase":"ViewBase","../../manager/mgrDirector":"mgrDirector","../../manager/mgrTip":"mgrTip"}],vNextChapterDialog:[function(e,t,o){"use strict";cc._RF.push(t,"82daek/+YhHx6toJZIjbLfy","vNextChapterDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("../../manager/mgrAd"),i=e("../../manager/mgrStage"),s=e("../../manager/mgrCfg"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonClose=null,t.buttonOpen=null,t.labelStage=null,t.nodeAdIcon=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vNextChapterDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_buttonOpen:{varname:"buttonOpen",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonOpen"}]},CC_labelStage:{varname:"labelStage",vartype:cc.Label},CC_nodeAdIcon:{varname:"nodeAdIcon",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.fillData(),this.registerListeners({MSG_AD_EVENT_SUCCESSD:this.onMsgAdEventSuccessd})},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fillData=function(){var e=this.context.chapterId,t=s.default.get_from_stage_chapter_db(e);if(t){var o=t.stageIds;this.labelStage.string=ul.format("\u7b2c%d-%d\u5173",o[0],o[o.length-1])}var n=r.default.preCheckCanTriggerAdEvent("open_chapter");this.nodeAdIcon.active=n},t.prototype.openDo=function(){var e=this.context.chapterId;i.default.openChapter(e),this.context.callFun&&this.context.callFun(),this.closeDialog()},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.closeDialog()},t.prototype.onTouchButtonOpen=function(e){e.isClick()&&(r.default.preCheckCanTriggerAdEvent("open_chapter")?r.default.triggerAdEvent("open_chapter",null,!0):this.openDo())},t.prototype.onMsgAdEventSuccessd=function(e){"open_chapter"==e.adEventId&&this.openDo()},t=__decorate([l],t)}(a.default));o.default=u,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../manager/mgrAd":"mgrAd","../../manager/mgrCfg":"mgrCfg","../../manager/mgrStage":"mgrStage"}],vOfflineDialog:[function(e,t,o){"use strict";cc._RF.push(t,"cf1a7JwcKVA84dbVcrs8L6X","vOfflineDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("../../manager/mgrPlayer"),i=e("../../Const"),s=e("../../manager/mgrTip"),c=e("../../manager/mgrAd"),l=e("../../manager/mgrSdk"),u=e("../../manager/mgrRole"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonCarefulDouble=null,t.buttonCarefulSingle=null,t.buttonClose=null,t.buttonGetReleax=null,t.buttonNoAd=null,t.labelButtonSignReleax=null,t.labelContent=null,t.labelTipCareful=null,t.labelTipReleax=null,t.nodeAdIconReleax=null,t.nodeCareful=null,t.nodeGetReleax=null,t.nodeNoAd=null,t.nodeReleax=null,t.nodeToogleParent=null,t.toggleDoubleReward=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vOfflineDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonCarefulDouble:{varname:"buttonCarefulDouble",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonCarefulDouble"}]},CC_buttonCarefulSingle:{varname:"buttonCarefulSingle",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonCarefulSingle"}]},CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_buttonGetReleax:{varname:"buttonGetReleax",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonGetReleax"}]},CC_buttonNoAd:{varname:"buttonNoAd",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonNoAd"}]},CC_labelButtonSignReleax:{varname:"labelButtonSignReleax",vartype:cc.Label},CC_labelContent:{varname:"labelContent",vartype:cc.Label},CC_labelTipCareful:{varname:"labelTipCareful",vartype:cc.Label},CC_labelTipReleax:{varname:"labelTipReleax",vartype:cc.Label},CC_nodeAdIconReleax:{varname:"nodeAdIconReleax",vartype:cc.Node},CC_nodeCareful:{varname:"nodeCareful",vartype:cc.Node},CC_nodeGetReleax:{varname:"nodeGetReleax",vartype:cc.Node},CC_nodeNoAd:{varname:"nodeNoAd",vartype:cc.Node},CC_nodeReleax:{varname:"nodeReleax",vartype:cc.Node},CC_nodeToogleParent:{varname:"nodeToogleParent",vartype:cc.Node},CC_toggleDoubleReward:{varname:"toggleDoubleReward",vartype:cc.Toggle}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.fillData(),this.fillAd(),this.registerListeners({MSG_AD_EVENT_SUCCESSD:this.onMsgAdEventSuccessd})},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.isClickShadowClose=function(){return!1},t.prototype.fillData=function(){var e=this.context.pastTime,t=this.context.income,o=Math.floor(e/3600),n=Math.floor(e/60)%60,a="";o&&(a+=o+"\u5c0f\u65f6"),n&&(a+=n+"\u5206\u949f");var r="\u5df4\u5566\u5566\u86cb\u7cd5\u5e97, \u5728\u60a8\u79bb\u7ebf\u7684"+a+"\uff08\u6700\u59278\u5c0f\u65f6\uff09,\u671f\u95f4\u83b7\u5f97 "+t+" \u91d1\u5e01";this.labelContent.string=r},t.prototype.fillAd=function(){var e=c.default.preCheckCanTriggerAdEvent("offline_reward");this.nodeNoAd.active=!e,this.nodeReleax.active=e&&l.default.getCopAdMode()==i.AdMode.releax,this.nodeCareful.active=e&&l.default.getCopAdMode()==i.AdMode.careful,this.toggleDoubleReward.node.on("toggle",this.refreshAdIcon.bind(this)),this.refreshAdIcon()},t.prototype.refreshAdIcon=function(){var e=this.toggleDoubleReward.isChecked;cc.log("refreshAdIcon isChecked : ",e),this.nodeAdIconReleax.active=e},t.prototype.gotReward=function(e){void 0===e&&(e=1);var t=this.context.income;r.default.addItemAmount(i.default.ITEM_ID_GOLD,t*e,"\u5e7f\u544a\u5956\u52b1"),s.default.addGotItemTip(i.default.ITEM_ID_GOLD,t*e,null),u.default.markOfflineRewardGeted()},t.prototype.onTouchButtonClose=function(e){e.isClick()&&(this.gotReward(),this.closeDialog())},t.prototype.onTouchButtonCarefulDouble=function(e){e.isClick()&&c.default.triggerAdEvent("offline_reward",null,!0)},t.prototype.onTouchButtonCarefulSingle=function(e){e.isClick()&&(this.gotReward(),this.closeDialog())},t.prototype.onTouchButtonGetReleax=function(e){e.isClick()&&(this.toggleDoubleReward.isChecked?c.default.triggerAdEvent("offline_reward",null,!0):(this.gotReward(),this.closeDialog()))},t.prototype.onTouchButtonNoAd=function(e){e.isClick()&&(this.gotReward(),this.closeDialog())},t.prototype.onMsgAdEventSuccessd=function(e){"offline_reward"==e.adEventId&&(this.gotReward(2),this.closeDialog())},t=__decorate([p],t)}(a.default));o.default=h,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../Const":"Const","../../manager/mgrAd":"mgrAd","../../manager/mgrPlayer":"mgrPlayer","../../manager/mgrRole":"mgrRole","../../manager/mgrSdk":"mgrSdk","../../manager/mgrTip":"mgrTip"}],vPromptDialog:[function(e,t,o){"use strict";cc._RF.push(t,"1ae53LpSWxJTYS5zS3gAoda","vPromptDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.button1=null,t.button2=null,t.button3=null,t.buttonClose=null,t.labelContent=null,t.labelTitle=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vPromptDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_button1:{varname:"button1",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButton1"}]},CC_button2:{varname:"button2",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButton2"}]},CC_button3:{varname:"button3",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButton3"}]},CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_labelContent:{varname:"labelContent",vartype:cc.Label},CC_labelTitle:{varname:"labelTitle",vartype:cc.Label}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.labelTitle.string=this.context.title||"\u6807\u9898",this.labelContent.string=this.context.content||"\u5185\u5bb9";for(var t=this.context.btnTexts||[],o=0;o<2;o++){var n=this["button"+(o+1)],a=n.node.getComponentInChildren(cc.Label);null!=t[o]?a.string=t[o]:n.node.active=!1}this.buttonClose.node.active=!1},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.isClickShadowClose=function(){return this.context.btnTexts.length<=0},t.prototype.onOpenDialogCompleted=function(){e.prototype.onOpenDialogCompleted.call(this)},t.prototype.triggerCallback=function(e){var t=(this.context.callbacks||[])[e];null!=t&&t()||this.closeDialog()},t.prototype.onTouchButton1=function(e){e.isClick()&&this.triggerCallback(0)},t.prototype.onTouchButton2=function(e){e.isClick()&&this.triggerCallback(1)},t.prototype.onTouchButton3=function(e){e.isClick()&&this.triggerCallback(2)},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.closeDialog()},t=__decorate([i],t)}(a.default));o.default=s,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase"}],vRankItem:[function(e,t,o){"use strict";cc._RF.push(t,"398c742dJZCUbtKUku4bz8Z","vRankItem"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/ViewBase"),a=cc._decorator,r=a.ccclass,i=(a.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelName=null,t.labelRank=null,t.labelScore=null,t.nodeRank1=null,t.nodeRank2=null,t.nodeRank3=null,t.player=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vRankItem"},t.prototype._getResourceBindingConfig=function(){return{CC_labelName:{varname:"labelName",vartype:cc.Label},CC_labelRank:{varname:"labelRank",vartype:cc.Label},CC_labelScore:{varname:"labelScore",vartype:cc.Label},CC_nodeRank1:{varname:"nodeRank1",vartype:cc.Node},CC_nodeRank2:{varname:"nodeRank2",vartype:cc.Node},CC_nodeRank3:{varname:"nodeRank3",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this._refresh()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fillBySRankPlayer=function(e){this.player=e,this._refresh()},t.prototype._refresh=function(){if(this.isResourceLoaded()&&this.player){var e=this.player;this.nodeRank1.active=1==e.rank,this.nodeRank2.active=2==e.rank,this.nodeRank3.active=3==e.rank,this.labelRank.node.active=e.rank>3,this.labelRank.string=e.rank.toString(),this.labelName.string=e.name,this.labelScore.string=e.score.toString()}},t=__decorate([r],t)}(n.default));o.default=i,cc._RF.pop()},{"../../../ulframework/view/ViewBase":"ViewBase"}],vRankScene:[function(e,t,o){"use strict";cc._RF.push(t,"724a3pioFdJl7G2vJ+HvLuP","vRankScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/SceneBase"),r=e("./../../../ulframework/view/ReuseLayouterVBox"),i=e("../../../ulframework/view/ReuseList"),s=e("../node/vRankItem"),c=e("./../../manager/mgrRank"),l=e("../../Const"),u=e("./../../../ulframework/utils/Tools"),d=e("./../../manager/mgrDirector"),p=e("../../manager/mgrStage"),h=e("../../manager/mgrAd"),f=cc._decorator,g=f.ccclass,m=(f.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonClose=null,t.buttonMatch=null,t.labelNoneTip=null,t.labelRank=null,t.nodeLeftTop=null,t.nodeList=null,t.reuseListRankPlayers=null,t.requestCd=1,t.lastRequestTime=0,t.rankId=l.default.SERVER_RANK_ID,t.bLucky=!1,t}return __extends(t,e),t.prototype._getResourceName=function(){return"scene/vRankScene"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_buttonMatch:{varname:"buttonMatch",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonMatch"}]},CC_labelNoneTip:{varname:"labelNoneTip",vartype:cc.Label},CC_labelRank:{varname:"labelRank",vartype:cc.Label},CC_nodeLeftTop:{varname:"nodeLeftTop",vartype:cc.Node},CC_nodeList:{varname:"nodeList",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.bLucky=h.default.preCheckCanTriggerAdEvent("more_20persent_pvp_score"),this.uiFadeIn(),this.buildUi(),this.fillData(),this.registerListeners({MSG_PVP_RESPONSE_PLAYER_FROM_RANK:this.onMsgPvpResponsePlayerFromRank.bind(this),MSG_PVP_SELF_DATA_CHANGED:this.onMsgPvpSelfDataChanged.bind(this)}),h.default.preCheckCanTriggerAdEvent("wrap_scene")?h.default.triggerAdEvent("wrap_scene",null,!0):h.default.triggerAdEvent("banner_all")},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){h.default.closeAdv("banner_all"),e.prototype.onDestroy.call(this)},t.prototype.uiFadeIn=function(){this.nodeLeftTop.x=-d.default.width/2,this.nodeLeftTop.y=d.default.height/2,d.default.isDeviceOverHeight()},t.prototype.buildUi=function(){var e=this,t=(new r.default).setCellSize(460,86).setGap(0).setPending(0),o=new i.default;o.parent=this.nodeList,o.setContentSize(this.nodeList.getContentSize()),o.setLayouter(t),o.setCreator(function(e){var t=new s.default;t.parent=e,e.item=t}),o.setSetter(function(t,o){t.item.fillBySRankPlayer(o);var n=c.default.getPlayers(e.rankId);n[n.length-1].rank==o.rank&&u.default.time()-e.lastRequestTime>e.requestCd&&(e.lastRequestTime=u.default.time(),c.default.requestNextBatchPlayers(e.rankId))}),this.reuseListRankPlayers=o},t.prototype.fillData=function(){var e=c.default.getPlayers(this.rankId);this.labelNoneTip.node.active=e.length<=0,this.reuseListRankPlayers.setDatas(e);var t=c.default.getSelfPlayer(this.rankId);cc.log("@@selfRank: ",t),!t||t.rank>100||t.rank<0?this.labelRank.string="\u672a\u4e0a\u699c":this.labelRank.string=ul.format("\u7b2c%d\u540d",t.rank)},t.prototype.onTouchButtonMatch=function(e){e.isClick()&&p.default.tryBeginStage(1e4)&&(this.bLucky?d.default.openDialog("vAdLuckyMatchDialog"):d.default.enterScene("vGameScene",{stageId:1e4}))},t.prototype.onTouchButtonClose=function(e){e.isClick()&&d.default.enterScene("vHubScene")},t.prototype.onMsgPvpResponsePlayerFromRank=function(e){this.fillData()},t.prototype.onMsgPvpSelfDataChanged=function(e){this.fillData()},t=__decorate([g],t)}(a.default));o.default=m,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/ReuseList":"ReuseList","../../../ulframework/view/SceneBase":"SceneBase","../../Const":"Const","../../manager/mgrAd":"mgrAd","../../manager/mgrStage":"mgrStage","../node/vRankItem":"vRankItem","./../../../ulframework/utils/Tools":"Tools","./../../../ulframework/view/ReuseLayouterVBox":"ReuseLayouterVBox","./../../manager/mgrDirector":"mgrDirector","./../../manager/mgrRank":"mgrRank"}],vSettingDialog:[function(e,t,o){"use strict";cc._RF.push(t,"b6a484SnfpANqyJTQaACiPG","vSettingDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("../../manager/mgrSound"),i=e("../../manager/mgrTip"),s=e("../../manager/mgrSdk"),c=e("../../Const"),l=e("../../../ulframework/utils/Tools"),u=e("../../manager/mgrDirector"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonCdk=null,t.buttonClose=null,t.buttonEffect=null,t.buttonMusic=null,t.buttonVideoRecord=null,t.nodeBg=null,t.nodeCdk=null,t.nodeKefu=null,t.nodeSwitchCloseEffect=null,t.nodeSwitchCloseMusic=null,t.nodeSwitchCloseVideoRecord=null,t.nodeSwitchOpenEffect=null,t.nodeSwitchOpenMusic=null,t.nodeSwitchOpenVideoRecord=null,t.nodeVideoRecord=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vSettingDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonCdk:{varname:"buttonCdk",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonCdk"}]},CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_buttonEffect:{varname:"buttonEffect",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonEffect"}]},CC_buttonMusic:{varname:"buttonMusic",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonMusic"}]},CC_buttonVideoRecord:{varname:"buttonVideoRecord",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonVideoRecord"}]},CC_nodeBg:{varname:"nodeBg",vartype:cc.Node},CC_nodeCdk:{varname:"nodeCdk",vartype:cc.Node},CC_nodeKefu:{varname:"nodeKefu",vartype:cc.Node},CC_nodeSwitchCloseEffect:{varname:"nodeSwitchCloseEffect",vartype:cc.Node},CC_nodeSwitchCloseMusic:{varname:"nodeSwitchCloseMusic",vartype:cc.Node},CC_nodeSwitchCloseVideoRecord:{varname:"nodeSwitchCloseVideoRecord",vartype:cc.Node},CC_nodeSwitchOpenEffect:{varname:"nodeSwitchOpenEffect",vartype:cc.Node},CC_nodeSwitchOpenMusic:{varname:"nodeSwitchOpenMusic",vartype:cc.Node},CC_nodeSwitchOpenVideoRecord:{varname:"nodeSwitchOpenVideoRecord",vartype:cc.Node},CC_nodeVideoRecord:{varname:"nodeVideoRecord",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.refreshEffect(),this.refreshMusic(),this.refreshVideoRecord(),this.nodeVideoRecord.active=s.default.isCopOpenVideoRecord(),this.nodeCdk.active=1==s.default.getCopNumberValueByKey("b_cdk"),this.nodeKefu.active=1==s.default.getCopNumberValueByKey("b_kefu_email"),l.default.registerTouchHandler(this.nodeBg,this.onTouchNodeBg.bind(this))},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.refreshEffect=function(){var e=r.default.getEffectVolume()>0;this.nodeSwitchCloseEffect.active=!e,this.nodeSwitchOpenEffect.active=e},t.prototype.refreshMusic=function(){var e=r.default.getMusicVolmue()>0;this.nodeSwitchCloseMusic.active=!e,this.nodeSwitchOpenMusic.active=e},t.prototype.refreshVideoRecord=function(){var e=s.default.isOpenVideoRecord();this.nodeSwitchCloseVideoRecord.active=!e,this.nodeSwitchOpenVideoRecord.active=e},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.closeDialog()},t.prototype.onTouchButtonEffect=function(e){e.isClick()&&(r.default.getEffectVolume()>0?r.default.setEffectVolume(0):r.default.setEffectVolume(1),this.refreshEffect())},t.prototype.onTouchButtonMusic=function(e){e.isClick()&&(r.default.getMusicVolmue()>0?r.default.setMusicVomue(0):r.default.setMusicVomue(1),this.refreshMusic())},t.prototype.onTouchButtonVideoRecord=function(e){e.isClick()&&(c.default.IS_OPEN_VIDEO_RECORD?(c.default.IS_OPEN_VIDEO_RECORD=!1,i.default.showMsgTip("\u5173\u95ed\u81ea\u52a8\u5f55\u5236")):(c.default.IS_OPEN_VIDEO_RECORD=!0,i.default.showMsgTip("\u5f00\u542f\u81ea\u52a8\u5f55\u5236")),this.refreshVideoRecord())},t.prototype.onTouchButtonCdk=function(e){e.isClick()&&u.default.openDialog("vCdkDialog")},t.prototype.onTouchNodeBg=function(e){if("began"==e.name)this._b_drag_to_right=!0,this._turn_count=0,this._b_poped=!1;else if("moved"==e.name){var t=e.getStartLocation(),o=e.getLocation();this._b_drag_to_right?o.x<t.x-20&&(this._b_drag_to_right=!1,this._turn_count++,cc.log("turn left",this._turn_count)):o.x>t.x+20&&(this._b_drag_to_right=!0,this._turn_count++,cc.log("turn right",this._turn_count)),this._b_poped||this._turn_count>=20&&(u.default.openDialog("vDebugInfoDialog",null,!0),this._b_poped=!0)}},t=__decorate([p],t)}(a.default));o.default=h,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/DialogBase":"DialogBase","../../Const":"Const","../../manager/mgrDirector":"mgrDirector","../../manager/mgrSdk":"mgrSdk","../../manager/mgrSound":"mgrSound","../../manager/mgrTip":"mgrTip"}],vShopDialog:[function(e,t,o){"use strict";cc._RF.push(t,"1cdb1NkriBBq6zYvyg9eK7F","vShopDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("../../manager/mgrDirector"),i=e("../../../ulframework/view/ReuseList"),s=e("../node/vTitleBar"),c=e("../../manager/mgrAd"),l=e("./../../../ulframework/view/ReuseLayouterVBox"),u=e("../../manager/mgrPool"),d=e("../../manager/mgrShop"),p=e("../../manager/mgrSdk"),h=e("../../Const"),f=function(e){function t(t){var o=e.call(this,t)||this;return o.buttonBack=null,o.nodeBg=null,o.nodeLeftTop=null,o.nodeListFree=null,o.nodeTitleBar=null,o.nodeTop=null,o.listFree=null,o.context.bImmediately=!0,o}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vShopDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonBack:{varname:"buttonBack",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonBack"}]},CC_nodeBg:{varname:"nodeBg",vartype:cc.Node},CC_nodeLeftTop:{varname:"nodeLeftTop",vartype:cc.Node},CC_nodeListFree:{varname:"nodeListFree",vartype:cc.Node},CC_nodeTitleBar:{varname:"nodeTitleBar",vartype:cc.Node},CC_nodeTop:{varname:"nodeTop",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.nodeResource.setContentSize(r.default.size),this.uiFadeIn(),this.buildUi(),this.fillData(),this.registerListeners({MSG_AD_EVENT_SUCCESSD:this.onMsgAdEventSuccessd,MSG_ADV_VALID_COUNT:this.onMsgAdvValidCount})},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){this.listFree.getActiveCellsByFilter(function(e){return!0}).forEach(function(e){e.item&&(e.item.removeFromParent(),u.default.put(e.item),e.item=null)}),e.prototype.onDestroy.call(this)},t.prototype.uiFadeIn=function(){this.nodeTop.y=r.default.height/2,this.nodeLeftTop.x=-r.default.width/2,this.nodeLeftTop.y=r.default.height/2,r.default.isDeviceOverHeight()&&(this.nodeTop.y=r.default.height/2-50,this.nodeLeftTop.y=r.default.height/2-50)},t.prototype.buildUi=function(){(new s.default).parent=this.nodeTitleBar,r.default.isDeviceOverHeight()&&(this.nodeTitleBar.parent.y=r.default.height/2-50);var e=(new l.default).setCellSize(466,185).setGap(0).setPending(10),t=new i.default;t.parent=this.nodeListFree,t.setContentSize(this.nodeListFree.getContentSize()),t.setLayouter(e),t.setCreator(function(e){}),t.setSetter(function(e,t){var o=t.uiViewName;o&&(e.item&&e.item.__pool_key!=o&&(u.default.put(e.item),e.item.removeFromParent(!1),e.item=null),e.item||(e.item=u.default.get("view",o),e.item.parent=e),e.item.fillData(t.id))}),this.listFree=t},t.prototype.fillData=function(){var e=[];if(p.default.isOpenPay())for(var t=d.default.getAllShopItemListByCategory([2]),o=0;o<t.length;o++){var n=t[o];e.push({id:n.id,uiViewName:"vShopItem"})}c.default.preCheckCanTriggerAdEventWithoutCd("free_gold")&&e.push({id:"free_gold",uiViewName:"vShopFreeItem"}),c.default.preCheckCanTriggerAdEventWithoutCd("free_energy")&&e.push({id:"free_energy",uiViewName:"vShopFreeItem"}),this.listFree.setDatas(e)},t.prototype.onTouchButtonBack=function(e){e.isClick()&&this.closeDialog()},t.prototype.onMsgAdEventSuccessd=function(e){},t.prototype.onMsgAdvValidCount=function(){h.default.AD_VIDEO_VALID_COUNT<=0&&this.closeDialog()},t}(a.default);o.default=f,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../../ulframework/view/ReuseList":"ReuseList","../../Const":"Const","../../manager/mgrAd":"mgrAd","../../manager/mgrDirector":"mgrDirector","../../manager/mgrPool":"mgrPool","../../manager/mgrSdk":"mgrSdk","../../manager/mgrShop":"mgrShop","../node/vTitleBar":"vTitleBar","./../../../ulframework/view/ReuseLayouterVBox":"ReuseLayouterVBox"}],vShopFreeItem:[function(e,t,o){"use strict";cc._RF.push(t,"d5913F/RaBFUIdOeby2/zj/","vShopFreeItem"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/ViewBase"),r=e("../../manager/mgrCfg"),i=e("../../manager/mgrAd"),s=e("../../manager/mgrTip"),c=e("./../../Const"),l=e("../../manager/mgrStage"),u=cc._decorator,d=u.ccclass,p=(u.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonItem=null,t.buttonWatch=null,t.labelAcount=null,t.labelCDTime=null,t.nodeBg1=null,t.nodeBg2=null,t.spriteGiftIcon=null,t.spriteIcon=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vShopFreeItem"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonItem:{varname:"buttonItem",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonItem"}]},CC_buttonWatch:{varname:"buttonWatch",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonWatch"}]},CC_labelAcount:{varname:"labelAcount",vartype:cc.Label},CC_labelCDTime:{varname:"labelCDTime",vartype:cc.Label},CC_nodeBg1:{varname:"nodeBg1",vartype:cc.Node},CC_nodeBg2:{varname:"nodeBg2",vartype:cc.Node},CC_spriteGiftIcon:{varname:"spriteGiftIcon",vartype:cc.Sprite},CC_spriteIcon:{varname:"spriteIcon",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.refresh()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t),this.isResourceLoaded()&&this.context.adEventId&&this.fillAdButtonLabel()},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fillData=function(e){this.context.adEventId=e,this.refresh()},t.prototype.refresh=function(){var e;if(this.isResourceLoaded()){var t=this.context.adEventId;if(t){this.nodeBg1.active="free_energy"==t,this.nodeBg2.active="free_energy"!=t;var o=r.default.get_from_ad_event_db(t);if(o){var n=o.param.rewards[0],a=r.default.get_from_item_template_db(n[0]);if(a){this.labelAcount.string=ul.format("x%d","free_gold"==t?this.getFreeDiamondCount():n[1]),this.spriteIcon.loadSpriteFrame(a.icon);var i=((e={})[c.default.ITEM_ID_GOLD]="2d/ui/mall/icon01",e[c.default.ITEM_ID_ENERGY]="2d/ui/mall/icon02",e);this.spriteGiftIcon.loadSpriteFrame(i[a.id])}}}}},t.prototype.fillAdButtonLabel=function(){var e=this.context.adEventId,t=i.default.getAdEventRemainCd(e);if(t<=0)this.labelCDTime.string="";else{var o=Math.floor(t/60)%60,n=Math.floor(t)%60,a=ul.format("%02d:%02d",o,n);this.labelCDTime.string=a}},t.prototype.getFreeDiamondCount=function(){return 20+3*(l.default.getStageProgress()+1)},t.prototype.onTouchButtonItem=function(e){if(e.isClick()){var t=this.context.adEventId;if(i.default.getAdEventRemainCd(t)>0)s.default.showMsgTip("\u5e7f\u544a\u51b7\u5374\u4e2d");else if("free_gold"==t){cc.log("@@@@@@@@@@@@@@@@@@@@AAAAA");var o=this.getFreeDiamondCount();i.default.triggerAdEvent(this.context.adEventId,{rewards:[[c.default.ITEM_ID_GOLD,o,o]],rewardBoxId:0},!0)}else cc.log("@@@@@@@@@@@@@@@@@@@@BBBBBB"),i.default.triggerAdEvent(this.context.adEventId,null,!0)}},t.prototype.onTouchButtonWatch=function(e){if(e.isClick()){var t=this.context.adEventId;if(i.default.getAdEventRemainCd(t)>0)s.default.showMsgTip("\u5e7f\u544a\u51b7\u5374\u4e2d");else if("free_gold"==t){cc.log("@@@@@@@@@@@@@@@@@@@@AAAAA");var o=this.getFreeDiamondCount();i.default.triggerAdEvent(this.context.adEventId,{rewards:[[c.default.ITEM_ID_GOLD,o,o]],rewardBoxId:0},!0)}else cc.log("@@@@@@@@@@@@@@@@@@@@BBBBBB"),i.default.triggerAdEvent(this.context.adEventId,null,!0)}},t=__decorate([d],t)}(a.default));o.default=p,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/ViewBase":"ViewBase","../../manager/mgrAd":"mgrAd","../../manager/mgrCfg":"mgrCfg","../../manager/mgrStage":"mgrStage","../../manager/mgrTip":"mgrTip","./../../Const":"Const"}],vShopItem:[function(e,t,o){"use strict";cc._RF.push(t,"a810evHoL1Naop9CZNBP9OU","vShopItem"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/ViewBase"),r=e("../../manager/mgrCfg"),i=e("../../manager/mgrShop"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonBuy=null,t.buttonItem=null,t.labelContent=null,t.labelDesc=null,t.nodeBg1=null,t.nodeBg2=null,t.spriteGiftIcon=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vShopItem"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonBuy:{varname:"buttonBuy",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonBuy"}]},CC_buttonItem:{varname:"buttonItem",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonItem"}]},CC_labelContent:{varname:"labelContent",vartype:cc.Label},CC_labelDesc:{varname:"labelDesc",vartype:cc.Label},CC_nodeBg1:{varname:"nodeBg1",vartype:cc.Node},CC_nodeBg2:{varname:"nodeBg2",vartype:cc.Node},CC_spriteGiftIcon:{varname:"spriteGiftIcon",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.refresh()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.fillData=function(e){this.context.shopId=e,this.refresh()},t.prototype.refresh=function(){if(this.isResourceLoaded()){var e=this.context.shopId;if(e){this.nodeBg1.active=11==e,this.nodeBg2.active=11!=e;var t=r.default.get_from_shop_template_db(e);t&&(this.labelContent.string=t.desc,this.labelDesc.string=t.price+"\u5143 \u8d2d\u4e70",this.spriteGiftIcon.loadSpriteFrame(t.sprIcon))}}},t.prototype.onTouchButtonBuy=function(e){e.isClick()&&i.default.requestBuy(this.context.shopId)},t.prototype.onTouchButtonItem=function(e){e.isClick()&&i.default.requestBuy(this.context.shopId)},t=__decorate([c],t)}(a.default));o.default=l,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/ViewBase":"ViewBase","../../manager/mgrCfg":"mgrCfg","../../manager/mgrShop":"mgrShop"}],vShowCakeDialog:[function(e,t,o){"use strict";cc._RF.push(t,"13b145e68JBLorHuQ8+Eeb+","vShowCakeDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/DialogBase"),a=e("../node/vAvatar"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodeAvatar=null,t.viewAvatar=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vShowCakeDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_nodeAvatar:{varname:"nodeAvatar",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.viewAvatar=new a.default,this.viewAvatar.parent=this.nodeAvatar,this.viewAvatar.replacePartIdArray(this.context.partIds)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t=__decorate([i],t)}(n.default));o.default=s,cc._RF.pop()},{"../../../ulframework/view/DialogBase":"DialogBase","../node/vAvatar":"vAvatar"}],vSignBigItem:[function(e,t,o){"use strict";cc._RF.push(t,"b3756gxCjdCapL+T32yTw89","vSignBigItem"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("./vSignSmallItem"),a=cc._decorator,r=a.ccclass,i=(a.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vSignBigItem"},t=__decorate([r],t)}(n.default));o.default=i,cc._RF.pop()},{"./vSignSmallItem":"vSignSmallItem"}],vSignDialog:[function(e,t,o){"use strict";cc._RF.push(t,"31106ESJ2RPm5M3zahmRYia","vSignDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/DialogBase"),r=e("../../manager/mgrSign"),i=e("../../Const"),s=e("../../manager/mgrTip"),c=e("../../manager/mgrSdk"),l=e("../node/vSignSmallItem"),u=e("../../manager/mgrAd"),d=e("../../manager/mgrPlayer"),p=cc._decorator,h=p.ccclass,f=(p.property,"double_reward_sign"),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonClose=null,t.buttonNoAd=null,t.buttonSignCarefulDouble=null,t.buttonSignCarefulSingle=null,t.buttonSignReleax=null,t.labelButtonSignReleax=null,t.labelDay=null,t.nodeAdIconReleax=null,t.nodeCareful=null,t.nodeItem1=null,t.nodeItem2=null,t.nodeItem3=null,t.nodeItem4=null,t.nodeItem5=null,t.nodeItem6=null,t.nodeItem7=null,t.nodeNoAd=null,t.nodeNoSign=null,t.nodeReleax=null,t.nodeSignReleax=null,t.nodeSigned=null,t.nodeToogleParent=null,t.toggleDoubleReward=null,t.items=[],t.bCanTrigAd=!1,t}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vSignDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonClose:{varname:"buttonClose",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonClose"}]},CC_buttonNoAd:{varname:"buttonNoAd",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonNoAd"}]},CC_buttonSignCarefulDouble:{varname:"buttonSignCarefulDouble",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonSignCarefulDouble"}]},CC_buttonSignCarefulSingle:{varname:"buttonSignCarefulSingle",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonSignCarefulSingle"}]},CC_buttonSignReleax:{varname:"buttonSignReleax",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonSignReleax"}]},CC_labelButtonSignReleax:{varname:"labelButtonSignReleax",vartype:cc.Label},CC_labelDay:{varname:"labelDay",vartype:cc.Label},CC_nodeAdIconReleax:{varname:"nodeAdIconReleax",vartype:cc.Node},CC_nodeCareful:{varname:"nodeCareful",vartype:cc.Node},CC_nodeItem1:{varname:"nodeItem1",vartype:cc.Node},CC_nodeItem2:{varname:"nodeItem2",vartype:cc.Node},CC_nodeItem3:{varname:"nodeItem3",vartype:cc.Node},CC_nodeItem4:{varname:"nodeItem4",vartype:cc.Node},CC_nodeItem5:{varname:"nodeItem5",vartype:cc.Node},CC_nodeItem6:{varname:"nodeItem6",vartype:cc.Node},CC_nodeItem7:{varname:"nodeItem7",vartype:cc.Node},CC_nodeNoAd:{varname:"nodeNoAd",vartype:cc.Node},CC_nodeNoSign:{varname:"nodeNoSign",vartype:cc.Node},CC_nodeReleax:{varname:"nodeReleax",vartype:cc.Node},CC_nodeSignReleax:{varname:"nodeSignReleax",vartype:cc.Node},CC_nodeSigned:{varname:"nodeSigned",vartype:cc.Node},CC_nodeToogleParent:{varname:"nodeToogleParent",vartype:cc.Node},CC_toggleDoubleReward:{varname:"toggleDoubleReward",vartype:cc.Toggle}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t),this.isResourceLoaded()&&(this.bClosing||this.fillData())},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.onOpenDialogCompleted=function(){this.buildUI(),this.fillData(),this.fillAd(),this.registerListeners({MSG_AD_EVENT_SUCCESSD:this.onMsgAdEventSuccessd})},t.prototype.buildUI=function(){for(var e=[this.nodeItem1,this.nodeItem2,this.nodeItem3,this.nodeItem4,this.nodeItem5,this.nodeItem6,this.nodeItem7],t=0;t<=e.length;t++){var o=new l.default({day:t+1,fOnClick:this.onClickItem.bind(this)});o.parent=e[t],this.items.push(o)}},t.prototype.fillData=function(){if(!(this.items.length<=0)){for(var e=r.default.getSignDay(),t=0;t<this.items.length;t++){var o=this.items[t];o.fillData(),e==t+1&&r.default.getState()==i.SignState.canSign?(o.__focused=!0,o.getActionByTag(1)||(o.stopAllActions(),o.setScale(1),o.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,1.1).easing(cc.easeInOut(1.5)),cc.scaleTo(.5,1).easing(cc.easeInOut(1.5))))).setTag(1))):(o.__focused=!1,o.stopAllActions(),o.setScale(1))}r.default.getState()==i.SignState.canSign?(this.nodeSigned.active=!1,this.nodeNoSign.active=!0):(this.nodeSigned.active=!0,this.nodeNoSign.active=!1),this.labelDay.string=r.default.getSignedDayCount().toString()}},t.prototype.fillAd=function(){this.bCanTrigAd=u.default.preCheckCanTriggerAdEvent(f),this.nodeNoAd.active=!this.bCanTrigAd,this.nodeReleax.active=this.bCanTrigAd&&c.default.getCopAdMode()==i.AdMode.releax,this.nodeCareful.active=this.bCanTrigAd&&c.default.getCopAdMode()==i.AdMode.careful,this.toggleDoubleReward.node.on("toggle",this.refreshAdIcon.bind(this)),this.refreshAdIcon()},t.prototype._sign=function(){var e=r.default.sign();e.bSuccessd&&(s.default.addGotItemTip(e.rewardItemId,e.rewardAmount),this.fillData())},t.prototype.canSign=function(){var e=r.default.getState();return e==i.SignState.canSign||(e==i.SignState.signed?(s.default.showMsgTip("\u5df2\u7ecf\u7b7e\u8fc7\u4e86"),!1):e==i.SignState.signOver?(s.default.showMsgTip("\u5df2\u7ecf\u4e0d\u80fd\u7b7e\u5230\u4e86"),!1):e==i.SignState.waitGap?(s.default.showMsgTip("\u518d\u7b49\u7b49"),!1):void 0)},t.prototype.refreshAdIcon=function(){var e=this.toggleDoubleReward.isChecked;cc.log("refreshAdIcon isChecked : ",e),this.nodeAdIconReleax.active=e},t.prototype.onTouchButtonClose=function(e){e.isClick()&&this.closeDialog()},t.prototype.onTouchButtonNoAd=function(e){e.isClick()&&this.canSign()&&this._sign()},t.prototype.onTouchButtonSignCarefulDouble=function(e){e.isClick()&&this.canSign()&&u.default.triggerAdEvent(f,null,!0)},t.prototype.onTouchButtonSignCarefulSingle=function(e){e.isClick()&&this.canSign()&&this._sign()},t.prototype.onTouchButtonSignReleax=function(e){if(e.isClick()){var t=this.toggleDoubleReward.isChecked;this.canSign()&&(t?u.default.triggerAdEvent(f,null,!0):this._sign())}},t.prototype.onClickItem=function(e){},t.prototype.onMsgAdEventSuccessd=function(e){if(e.adEventId==f){var t=r.default.sign();t.bSuccessd&&(d.default.addItemAmount(t.rewardItemId,t.rewardAmount,"\u5e7f\u544a\u7b7e\u5230"),s.default.addGotItemTip(t.rewardItemId,2*t.rewardAmount),this.fillData())}},t=__decorate([h],t)}(a.default);o.default=g,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../Const":"Const","../../manager/mgrAd":"mgrAd","../../manager/mgrPlayer":"mgrPlayer","../../manager/mgrSdk":"mgrSdk","../../manager/mgrSign":"mgrSign","../../manager/mgrTip":"mgrTip","../node/vSignSmallItem":"vSignSmallItem"}],vSignSmallItem:[function(e,t,o){"use strict";cc._RF.push(t,"3ad79tkqF5Oj53opf17adpn","vSignSmallItem"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/ViewBase"),r=e("../../manager/mgrCfg"),i=e("../../manager/mgrSign"),s=cc._decorator,c=s.ccclass,l=(s.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonItem=null,t.labelCount=null,t.labelTitle=null,t.nodeBg=null,t.nodeGeted=null,t.nodeMask=null,t.spriteIcon=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vSignSmallItem"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonItem:{varname:"buttonItem",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonItem"}]},CC_labelCount:{varname:"labelCount",vartype:cc.Label},CC_labelTitle:{varname:"labelTitle",vartype:cc.Label},CC_nodeBg:{varname:"nodeBg",vartype:cc.Node},CC_nodeGeted:{varname:"nodeGeted",vartype:cc.Node},CC_nodeMask:{varname:"nodeMask",vartype:cc.Node},CC_spriteIcon:{varname:"spriteIcon",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.buildUI(),this.fillData()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUI=function(){},t.prototype.fillData=function(){if(this.isResourceLoaded()){var e=this.context.day,t=i.default.getSignDay(),o=i.default.getSignIndex(),n=null;e<t?(n=r.default.quietGet("sign_db",e,0),this.nodeGeted.active=!0):e==t?(n=r.default.quietGet("sign_db",e,o))?this.nodeGeted.active=!1:(n=r.default.quietGet("sign_db",e,0),this.nodeGeted.active=!0):(n=r.default.quietGet("sign_db",e,0),this.nodeGeted.active=!1);var a=r.default.get_from_item_template_db(n.rewardItemId);this.spriteIcon.loadSpriteFrameAndKeepSize(a.icon),this.labelTitle.string="",this.labelCount.string="x"+n.rewardAmount}},t.prototype.onTouchButtonItem=function(e){e.isClick()&&this.context.fOnClick&&this.context.fOnClick(this.context.day)},t=__decorate([c],t)}(a.default));o.default=l,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/ViewBase":"ViewBase","../../manager/mgrCfg":"mgrCfg","../../manager/mgrSign":"mgrSign"}],vStageChooseDialog:[function(e,t,o){"use strict";cc._RF.push(t,"c5168Y5waFPgr2y1byGUJWH","vStageChooseDialog"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/ReuseList"),r=e("../../manager/mgrAd"),i=e("../../manager/mgrTip"),s=e("../../manager/mgrDirector"),c=e("../../manager/mgrStage"),l=e("../../manager/mgrCfg"),u=e("../node/vChapterItem"),d=e("../node/vTitleBar"),p=e("../node/vJumpOtherGame"),h=e("../../../ulframework/view/DialogBase"),f=e("../../manager/mgrGuide"),g=e("../../../ulframework/view/ReuseLayouterHBox"),m=function(e){function t(t){var o=e.call(this,t)||this;return o.buttonBack=null,o.buttonLeft=null,o.buttonRight=null,o.nodeBg=null,o.nodeJumpOtherGame=null,o.nodeLeftTop=null,o.nodeListChapter=null,o.nodeListChapterButton=null,o.nodeTitleBar=null,o.nodeTop=null,o.listChapter=null,o.curIndex=0,o.context.bImmediately=!0,o}return __extends(t,e),t.prototype._getResourceName=function(){return"dialog/vStageChooseDialog"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonBack:{varname:"buttonBack",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonBack"}]},CC_buttonLeft:{varname:"buttonLeft",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonLeft"}]},CC_buttonRight:{varname:"buttonRight",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonRight"}]},CC_nodeBg:{varname:"nodeBg",vartype:cc.Node},CC_nodeJumpOtherGame:{varname:"nodeJumpOtherGame",vartype:cc.Node},CC_nodeLeftTop:{varname:"nodeLeftTop",vartype:cc.Node},CC_nodeListChapter:{varname:"nodeListChapter",vartype:cc.Node},CC_nodeListChapterButton:{varname:"nodeListChapterButton",vartype:cc.Node},CC_nodeTitleBar:{varname:"nodeTitleBar",vartype:cc.Node},CC_nodeTop:{varname:"nodeTop",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.nodeResource.setContentSize(s.default.size),this.uiFadeIn(),this.buildUi(),this.fillData(),this.goToLastChapter(),this.refreshButton(),f.default.isGuiding()&&this.listChapter.setTouchScrollEnabled(!1),this.registerListeners({}),this.tryOpenChapter(c.default.getLastChapterId(),null)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.uiFadeIn=function(){this.nodeTop.y=s.default.height/2,this.nodeLeftTop.x=-s.default.width/2,this.nodeLeftTop.y=s.default.height/2,s.default.isDeviceOverHeight()&&(this.nodeTop.y=s.default.height/2-50,this.nodeLeftTop.y=s.default.height/2-50)},t.prototype.buildUi=function(){var e=this;new d.default({bHideDiamond:!1}).parent=this.nodeTitleBar,s.default.isDeviceOverHeight()&&(this.nodeTitleBar.parent.y=s.default.height/2-50),(new p.default).parent=this.nodeJumpOtherGame;var t=(new g.default).setCellSize(576,732).setGap(0).setPending(0),o=new a.default;o.parent=this.nodeListChapter,o.setContentSize(this.nodeListChapter.getContentSize()),o.setLayouter(t),o.setCreator(function(t){var o=new u.default({fOnClickStage:e.onClickStage.bind(e)});o.parent=t,t.item=o}),o.setSetter(function(e,t){e.item.fillData(t)}),this.listChapter=o,this.listChapter.setTouchScrollEnabled(!1)},t.prototype.fillData=function(){var e=[];l.default.forDb_from_stage_chapter_db(function(t,o){e.push(o.id)}),this.listChapter.setDatas(e)},t.prototype.goToLastChapter=function(){var e=c.default.getLastChapterId();this.listChapter.jumpToData(e,null),this.curIndex=e%100-1},t.prototype.tryOpenChapter=function(e,t){if(!c.default.isChapterOpen(e)){if(r.default.preCheckCanTriggerAdEvent("open_chapter")){var o={chapterId:e};o.callFun=t,s.default.openDialog("vNextChapterDialog",o)}else c.default.openChapter(e),t instanceof Function&&t();return!0}return!1},t.prototype.enterStage=function(e){c.default.tryBeginStage(e)&&(c.default.beginStage(e),s.default.enterScene("vGameScene",{stageId:e}))},t.prototype.onClickStage=function(e){var t=this;c.default.isStageUnlocked(e)?this.tryOpenChapter(c.default.calcChapterIdByStageId(e),function(){t.enterStage(e)})||this.enterStage(e):i.default.showMsgTip("\u5c1a\u672a\u89e3\u9501")},t.prototype.refreshButton=function(){this.buttonLeft.node.active=this.curIndex>0,this.buttonRight.node.active=this.curIndex<this.listChapter.getDatas().length-1},t.prototype.onTouchButtonBack=function(e){e.isClick()&&this.closeDialog()},t.prototype.onTouchButtonLeft=function(e){e.isClick()&&(this.curIndex=this.curIndex-1>0?this.curIndex-1:0,this.listChapter.scrollToIndex(this.curIndex),this.refreshButton())},t.prototype.onTouchButtonRight=function(e){e.isClick()&&(this.curIndex=this.curIndex+1<this.listChapter.getDatas().length?this.curIndex+1:this.listChapter.getDatas().length-1,this.listChapter.scrollToIndex(this.curIndex),this.refreshButton())},t}(h.default);o.default=m,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/view/DialogBase":"DialogBase","../../../ulframework/view/ReuseLayouterHBox":"ReuseLayouterHBox","../../../ulframework/view/ReuseList":"ReuseList","../../manager/mgrAd":"mgrAd","../../manager/mgrCfg":"mgrCfg","../../manager/mgrDirector":"mgrDirector","../../manager/mgrGuide":"mgrGuide","../../manager/mgrStage":"mgrStage","../../manager/mgrTip":"mgrTip","../node/vChapterItem":"vChapterItem","../node/vJumpOtherGame":"vJumpOtherGame","../node/vTitleBar":"vTitleBar"}],vTitleBar:[function(e,t,o){"use strict";cc._RF.push(t,"48573TAqqdOz7+2cBriN3ga","vTitleBar"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/component/ScleableButton"),a=e("../../../ulframework/view/ViewBase"),r=e("../../../ulframework/utils/Timer"),i=e("../../manager/mgrPlayer"),s=e("../../../ulframework/utils/Tools"),c=e("../../Const"),l=e("./../../manager/mgrCfg"),u=e("../../manager/mgrShop"),d=cc._decorator,p=d.ccclass,h=(d.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.buttonDiamond=null,t.buttonEnergy=null,t.labelAmountDiamond=null,t.labelAmountEnergy=null,t.labelRecoverTime=null,t.nodeDiamondAddIcon=null,t.nodeEnergyAddIcon=null,t.spriteIconDiamond=null,t.spriteIconEnergy=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vTitleBar"},t.prototype._getResourceBindingConfig=function(){return{CC_buttonDiamond:{varname:"buttonDiamond",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonDiamond"}]},CC_buttonEnergy:{varname:"buttonEnergy",vartype:n.default,events:[{bindMethod:"registerOnTouchCallback",method:"onTouchButtonEnergy"}]},CC_labelAmountDiamond:{varname:"labelAmountDiamond",vartype:cc.Label},CC_labelAmountEnergy:{varname:"labelAmountEnergy",vartype:cc.Label},CC_labelRecoverTime:{varname:"labelRecoverTime",vartype:cc.Label},CC_nodeDiamondAddIcon:{varname:"nodeDiamondAddIcon",vartype:cc.Node},CC_nodeEnergyAddIcon:{varname:"nodeEnergyAddIcon",vartype:cc.Node},CC_spriteIconDiamond:{varname:"spriteIconDiamond",vartype:cc.Sprite},CC_spriteIconEnergy:{varname:"spriteIconEnergy",vartype:cc.Sprite}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.refreshData(),this.context.bHideEnergy&&(this.labelAmountEnergy.node.parent.active=!1),this.context.bHideDiamond&&(this.labelAmountDiamond.node.parent.active=!1),this.registerListeners({MSG_ITEM_AMOUNT_CHANGED:this.onMsgItemAmountChanged}),r.default.callLoop(.1,this.onTimerLoop.bind(this),this),this.spriteIconDiamond.loadSpriteFrameAndKeepSize(l.default.get_from_item_template_db(c.default.ITEM_ID_GOLD).icon),this.spriteIconEnergy.loadSpriteFrameAndKeepSize(l.default.get_from_item_template_db(c.default.ITEM_ID_ENERGY).icon)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.refreshData=function(){if(this.isResourceLoaded()){this.labelAmountDiamond.string=i.default.getItemAmount(c.default.ITEM_ID_GOLD).toString();var e=i.default.getItemAmount(c.default.ITEM_ID_ENERGY),t=i.default.getRecoverMaxAmount(c.default.ITEM_ID_ENERGY);this.labelAmountEnergy.string=ul.format("%d/%d",e,t);var o=i.default.getRecoverRemainTime(c.default.ITEM_ID_ENERGY);null!=o?(this.labelRecoverTime.node.active=!0,this.labelRecoverTime.string=s.default.formatTime(o,"%M:%S")):(this.labelRecoverTime.string="",this.labelRecoverTime.node.active=!1),this.nodeDiamondAddIcon.active=u.default.canSupplyItem(c.default.ITEM_ID_GOLD),this.nodeEnergyAddIcon.active=u.default.canSupplyItem(c.default.ITEM_ID_ENERGY)}},t.prototype.onTimerLoop=function(){this.refreshData()},t.prototype.onTouchButtonDiamond=function(e){e.isClick()&&u.default.tryOpenShop(c.default.ITEM_ID_GOLD)},t.prototype.onTouchButtonEnergy=function(e){e.isClick()&&u.default.tryOpenShop(c.default.ITEM_ID_ENERGY)},t.prototype.onMsgItemAmountChanged=function(e){this.refreshData()},t=__decorate([p],t)}(a.default));o.default=h,cc._RF.pop()},{"../../../ulframework/component/ScleableButton":"ScleableButton","../../../ulframework/utils/Timer":"Timer","../../../ulframework/utils/Tools":"Tools","../../../ulframework/view/ViewBase":"ViewBase","../../Const":"Const","../../manager/mgrPlayer":"mgrPlayer","../../manager/mgrShop":"mgrShop","./../../manager/mgrCfg":"mgrCfg"}],vUpdaterSceneBase:[function(e,t,o){"use strict";cc._RF.push(t,"c62363WFOdOTol2y4eu214a","vUpdaterSceneBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../view/SceneBase"),a=e("../utils/Timer"),r=e("../../game/Const"),i=e("../../game/manager/mgrDirector"),s=e("../../game/view/node/LayerColor"),c=cc._decorator,l=c.ccclass,u=(c.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.patchInfo=null,t.localPid=null,t.patchs=null,t.patchIdx=null,t.TIMEOUT=5,t.requestPatchInfoXhr=null,t.timeoutTimer=null,t.bNeedRestart=!1,t.bGameStarted=!1,t}return __extends(t,e),t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){var t=this;e.prototype.onResourceLoaded.call(this),jsb.fileUtils.isFileExist("src/patch_info.json")?(cc.log("\u53d1\u73b0patch_info.json\uff0c\u51c6\u5907\u66f4\u65b0"),this.needPlayLogo()?this.playLogo(function(){t.prepareUpdate()}):this.prepareUpdate()):(cc.log("patch_info.json\u672a\u627e\u5230\uff0c\u76f4\u63a5\u8fdb\u5165\u6e38\u620f"),this.startGame())},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){},t.prototype.sendUiMsg=function(e,t){this.onUiMsg(e,t)},t.prototype.onUiMsg=function(e,t){},t.prototype.needPlayLogo=function(){return"true"==cc.sys.localStorage.getItem("B_SKIP_LOGO_ONCE")?(cc.sys.localStorage.setItem("B_SKIP_LOGO_ONCE","false"),!1):!!this.getLogoTextures()},t.prototype.getLogoTextures=function(){var e,t=jsb.fileUtils.getStringFromFile("src/patch_info.json");if(t&&(e=JSON.parse(t)),!e)return null;var o=e.CONF;if(!o)return null;var n=o.LOGO_TEXTURES;return Array.isArray(n)?n:null},t.prototype.playLogo=function(e){var t=this;cc.log("-------------------------"),cc.log("-----   playLogo    -----"),cc.log("-------------------------");for(var o=this.getLogoTextures(),n=o.length-1;n>=0;n--){var a=o[n];cc.loader._getResUuid(a)||(cc.warn(ul.format("vUpdaterSceneBase.playLogo logoTexture not found! fileName=[%s]",a)),o.splice(n,1))}if(o.length<=0)e();else{this.nodeResource.active=!1;var r=new s.default(cc.color(0,0,0,255));r.parent=this,r.setContentSize(i.default.size);for(n=0;n<o.length;n++){a=o[n];var c=i.default.createSpriteNode(a);c.parent=this,c.opacity=0;var l=[];n>0&&l.push(cc.delayTime(3*n)),l.push(cc.fadeIn(.6)),l.push(cc.delayTime(1.8)),l.push(cc.fadeOut(.6)),n==o.length-1&&l.push(cc.callFunc(function(){t.nodeResource.active=!0,r.destroy(),e()}));var u=cc.sequence(l);c.runAction(u)}}},t.prototype.startGame=function(e){if(this.bGameStarted)cc.warn("vUpdataerSceneBase.startGame already started!");else{if(this.bGameStarted=!0,e&&this.patchInfo){var t=cc.sys.localStorage.getItem("GAME_VERSION");if(t)r.default.GAME_VERSION=t;else{var o=this.patchInfo.VERSION;o&&(cc.sys.localStorage.setItem("GAME_VERSION",o),r.default.GAME_VERSION=o)}}if(this.releaseAssetsManager(),this.releaseRequestPatchInfoXhr(),this.bNeedRestart)return cc.log("-------------------------"),cc.log("-----  restarting   -----"),cc.log("-------------------------"),cc.sys.localStorage.setItem("B_SKIP_LOGO_ONCE","true"),cc.audioEngine.stopAll(),void cc.game.restart();cc.log("-------------------------"),cc.log("-----   startGame   -----"),cc.log("-------------------------"),this.sendUiMsg("UPDATER_UI_MSG_ENTER_NEXT_SCENE")}},t.prototype.resetPatch=function(e,t,o,n){cc.log("-------------------------"),cc.log("-----  resetPatch   -----"),cc.log("-------------------------"),cc.log("resetTip",e);var a=this.getPatchPath();jsb.fileUtils.isDirectoryExist(a)&&jsb.fileUtils.removeDirectory(a),cc.sys.localStorage.setItem("PATCH_BID",t.toString()),cc.sys.localStorage.setItem("PATCH_PID",o.toString()),cc.sys.localStorage.setItem("PATCH_PACKAGE_PID",o.toString()),cc.sys.localStorage.setItem("PATCH_CHANNEL",n);var r=[a];cc.sys.localStorage.setItem("UPDATER_SEARCH_PATHS",JSON.stringify(r))},t.prototype.prepareUpdate=function(){cc.log("-------------------------"),cc.log("----- prepareUpdate -----"),cc.log("-------------------------");var e,t=jsb.fileUtils.getStringFromFile("src/patch_info.json");if(t&&(e=JSON.parse(t)),!e)return cc.warn("[warn] patch_info.json \u52a0\u8f7d\u5931\u8d25\uff0c\u76f4\u63a5\u8fdb\u5165\u6e38\u620f\u3002"),void this.startGame();this.patchInfo=e;var o=cc.sys.localStorage.getItem("GAME_VERSION");o||(o=e.VERSION),r.default.GAME_VERSION=o;var n=e.B_ID,a=e.P_ID,i=e.CHANNEL,s=parseInt(cc.sys.localStorage.getItem("PATCH_BID")),c=parseInt(cc.sys.localStorage.getItem("PATCH_PID")),l=parseInt(cc.sys.localStorage.getItem("PATCH_PACKAGE_PID")),u=cc.sys.localStorage.getItem("PATCH_CHANNEL"),d=null;n!=s?d=ul.format("bid not match! package = %s, record = %d",n,s):i!=u?d=ul.format("channel not match! package = %s, record = %d",i,u):a!=l?d=ul.format("package pid not match! package = %s, record = %d",a,l):a>(isNaN(c)?0:c)&&(d=ul.format("package pid is higher! package = %s, record = %s",a,c)),d&&this.resetPatch(d,n,a,i);var p=null;(c=parseInt(cc.sys.localStorage.getItem("PATCH_PID")))?(p=c,cc.log("use record pid",p)):(p=e.P_ID||0,cc.log("use patch_info pid",p)),this.localPid=p;var h=this.getPatchPath();if(!jsb.fileUtils.createDirectory(h))return cc.log("patchPath create faild!",h),void this.startGame();this.buildUi(),this.checkNewVersion()},t.prototype.checkNewVersion=function(){var e=this;this.sendUiMsg("UPDATER_UI_MSG_GET_VERSION");var t=this.patchInfo,o=ul.format("http://%s/%s/%s/%s/%s",t.HOST,t.PATCH_PATH,t.APP,t.CHANNEL,t.PATCH_INFO_FILENAME),n=cc.loader.getXMLHttpRequest();n.onreadystatechange=function(){if(4==n.readyState)if(n.status>=200&&n.status<207){e.stopTimeoutTimer();var t=void 0;try{t=JSON.parse(n.response)}catch(t){cc.warn("vUpdaterScene.checkNewVersion remote patch_info parse except!",n.response),e.startGame()}t?(e.releaseRequestPatchInfoXhr(),e.onPatchInfoDownloadSuccess(t)):(cc.warn("vUpdaterScene.checkNewVersion remote patch_info parse faild!",n.response),e.startGame())}else cc.warn("vUpdateScene.checkNewVersion network faild."),e.startGame()};n.open("GET",o),n.timeout=1e3*this.TIMEOUT,this.requestPatchInfoXhr=n,this.startTimeoutTimer(),n.send()},t.prototype.onPatchInfoDownloadSuccess=function(e){var t=this;cc.log("onPatchInfoDownloadSuccess",e),ul.dump(e);var o=parseInt(e.P_ID)||0,n=this.localPid;cc.log("pid:",n,o),n>o&&(cc.sys.localStorage.setItem("GAME_VERSION",""),cc.warn("local version is higher than remote version"),cc.warn("stop update!"),this.startGame());for(var r=[],i=0;i<e.PATCH_LIST.length;i++){var s=e.PATCH_LIST[i];s.pid>n&&(cc.log("ADD PATCH ->",s.pid,s.version),r.push(s))}this.patchInfo=e,r.length>0?(this.patchs=r,this.patchIdx=0,a.default.callLater(.016,function(){t.downloadPatchByIndexed()})):this.startGame(!0)},t.prototype.downloadPatchByIndexed=function(){this.releaseAssetsManager(),cc.log("downloadPatchByIndexed",this.patchIdx);var e=this.patchInfo,t=this.patchs[this.patchIdx],o=ul.format("http://%s/%s/%s/%s/%s/",e.HOST_CDN||e.HOST,e.PATCH_PATH,e.APP,e.CHANNEL,e.B_ID);cc.log("packageUrl",ul.format("%s%d.zip",o,t.pid));var n={};n[ul.format("%d.zip",t.pid)]={size:0,md5:"",compressed:!0};var r=JSON.stringify({packageUrl:o,version:(this.localPid-1).toString()}),i=new jsb.Manifest(r,this.getPatchPath()),s=JSON.stringify({packageUrl:o,version:t.pid.toString(),assets:n}),c=new jsb.Manifest(s,this.getPatchPath()),l=new jsb.AssetsManager("",this.getPatchPath()),u=new jsb.EventListenerAssetsManager(l,this.onAssetsManagerEvent.bind(this));cc.eventManager.addListener(u,1),this.assetsManager=l,this.assetsManagerListener=u;var d=new a.default(.016,-1,function(){cc.isValid(l)&&l.update()});this.assetsManagerTimer=d,l.loadLocalManifest(i,this.getPatchPath()),l.loadRemoteManifest(c),l.setVersionCompareHandle(function(e,t){return parseFloat(e)-parseFloat(t)}),l.setVerifyCallback(function(e,t){return!0}),d.startAndBindToNode(this)},t.prototype.onPatchDownloadSuccess=function(){var e=this.patchs[this.patchIdx];this.localPid=e.pid,cc.sys.localStorage.setItem("PATCH_PID",this.localPid.toString()),cc.log("save PATCH_PID",this.localPid),e.version&&(cc.sys.localStorage.setItem("GAME_VERSION",e.version),cc.log("save GAME_VERSION",e.version)),this.bNeedRestart=!0,cc.log("check patchIdx",this.patchIdx,this.patchs.length),this.patchIdx<this.patchs.length-1?(this.patchIdx++,this.downloadPatchByIndexed()):(this.sendUiMsg("UPDATER_UI_MSG_DOWNLOAD_SUCCESS"),this.startGame(!0))},t.prototype.onAssetsManagerEvent=function(e){switch(e.getEventCode()){case jsb.EventAssetsManager.ERROR_NO_LOCAL_MANIFEST:cc.log("onAssetsManagerEvent.ERROR_NO_LOCAL_MANIFEST"),this.startGame();break;case jsb.EventAssetsManager.ERROR_DOWNLOAD_MANIFEST:cc.log("onAssetsManagerEvent.ERROR_DOWNLOAD_MANIFEST"),this.startGame();break;case jsb.EventAssetsManager.ERROR_PARSE_MANIFEST:cc.log("onAssetsManagerEvent.ERROR_PARSE_MANIFEST"),this.startGame();break;case jsb.EventAssetsManager.NEW_VERSION_FOUND:cc.log("onAssetsManagerEvent.NEW_VERSION_FOUND");break;case jsb.EventAssetsManager.ALREADY_UP_TO_DATE:cc.log("onAssetsManagerEvent.ALREADY_UP_TO_DATE"),this.sendUiMsg("UPDATER_UI_MSG_DOWNLOAD_PROGRESS",{bytePercent:1,filePercent:1}),this.onPatchDownloadSuccess();break;case jsb.EventAssetsManager.UPDATE_PROGRESSION:cc.log("onAssetsManagerEvent.UPDATE_PROGRESSION"),this.sendUiMsg("UPDATER_UI_MSG_DOWNLOAD_PROGRESS",{bytePercent:e.getPercent()||0,filePercent:e.getPercentByFile()||0});break;case jsb.EventAssetsManager.ASSET_UPDATED:cc.log("onAssetsManagerEvent.ASSET_UPDATED");break;case jsb.EventAssetsManager.ERROR_UPDATING:cc.log("onAssetsManagerEvent.ERROR_UPDATING"),this.startGame();break;case jsb.EventAssetsManager.UPDATE_FINISHED:cc.log("onAssetsManagerEvent.UPDATE_FINISHED"),this.sendUiMsg("UPDATER_UI_MSG_DOWNLOAD_PROGRESS",{bytePercent:1,filePercent:1}),this.onPatchDownloadSuccess();break;case jsb.EventAssetsManager.UPDATE_FAILED:cc.log("onAssetsManagerEvent.UPDATE_FAILED"),this.startGame();break;case jsb.EventAssetsManager.ERROR_DECOMPRESS:cc.log("onAssetsManagerEvent.ERROR_DECOMPRESS"),this.startGame();break;default:cc.log("onAssetsManagerEvent.unknown code",e.getEventCode()),this.startGame()}},t.prototype.getPatchPath=function(){var e=jsb.fileUtils.getWritablePath(),t=e.substr(e.length-1,1);return"/"==t||"\\"==t?e+"patch/":e+"/patch/"},t.prototype.onTimeout=function(){this.startGame()},t.prototype.startTimeoutTimer=function(){var e=this,t=new a.default(this.TIMEOUT,1,function(){e.stopTimeoutTimer(),e.onTimeout()});this.timeoutTimer=t,t.startAndBindToNode(this)},t.prototype.stopTimeoutTimer=function(){this.timeoutTimer&&(this.timeoutTimer.stop(),this.timeoutTimer=null)},t.prototype.releaseRequestPatchInfoXhr=function(){this.requestPatchInfoXhr&&(this.requestPatchInfoXhr.abort(),this.requestPatchInfoXhr=null)},t.prototype.releaseAssetsManager=function(){this.assetsManagerTimer&&(this.assetsManagerTimer.stop(),this.assetsManagerTimer=null),this.assetsManagerListener&&(cc.eventManager.removeListener(this.assetsManagerListener),this.assetsManagerListener=null),this.assetsManager&&(this.assetsManager=null)},t=__decorate([l],t)}(n.default));o.default=u,cc._RF.pop()},{"../../game/Const":"Const","../../game/manager/mgrDirector":"mgrDirector","../../game/view/node/LayerColor":"LayerColor","../utils/Timer":"Timer","../view/SceneBase":"SceneBase"}],vUpdaterScene:[function(e,t,o){"use strict";cc._RF.push(t,"af3f0IjSjlP96U4ugYAGRJe","vUpdaterScene"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../manager/mgrDirector"),a=e("../../../ulframework/updater/vUpdaterSceneBase"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelProcess=null,t.nodeLoadAni=null,t.nodeStar=null,t.progressBar=null,t}return __extends(t,e),t.prototype._getResourceName=function(){return"scene/vUpdaterScene"},t.prototype._getResourceBindingConfig=function(){return{CC_labelProcess:{varname:"labelProcess",vartype:cc.Label},CC_nodeLoadAni:{varname:"nodeLoadAni",vartype:cc.Node},CC_nodeStar:{varname:"nodeStar",vartype:cc.Node},CC_progressBar:{varname:"progressBar",vartype:cc.ProgressBar}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this)},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.buildUi=function(){e.prototype.buildUi.call(this)},t.prototype.onUiMsg=function(t,o){if(e.prototype.onUiMsg.call(this,t,o),"UPDATER_UI_MSG_GET_VERSION"==t)this.progressBar.progress=0,this.labelProcess.string="\u8fdb\u5165\u4e2d";else if("UPDATER_UI_MSG_DOWNLOAD_PROGRESS"==t){if(!o)return;var a=cc.clampf(o.bytePercent||0,0,1),r=(cc.clampf(o.filePercent||0,0,1),this.patchs.length),i=(a+this.patchIdx)/r;this.progressBar.progress=i,this.labelProcess.string="\u8fdb\u5165\u4e2d."}else"UPDATER_UI_MSG_DOWNLOAD_SUCCESS"==t?(this.progressBar.progress=1,this.labelProcess.string="\u8fdb\u5165\u4e2d.."):"UPDATER_UI_MSG_ENTER_NEXT_SCENE"==t&&n.default.enterScene("vLoadingScene")},t=__decorate([i],t)}(a.default));o.default=s,cc._RF.pop()},{"../../../ulframework/updater/vUpdaterSceneBase":"vUpdaterSceneBase","../../manager/mgrDirector":"mgrDirector"}],vWarpSceneNode:[function(e,t,o){"use strict";cc._RF.push(t,"24990fPxkpB16/hRDlVyB4a","vWarpSceneNode"),Object.defineProperty(o,"__esModule",{value:!0});var n=e("../../../ulframework/view/ViewBase"),a=e("../../manager/mgrDirector"),r=cc._decorator,i=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.labelTip=null,t.nodeBottom=null,t.nodeCloudBottom=null,t.nodeCloudCenter=null,t.nodeCloudTop=null,t.originPos=[],t.duration=.6,t.needToPlayFadeInAfterLoaded=!1,t}return __extends(t,e),t.prototype._getResourceName=function(){return"node/vWarpSceneNode"},t.prototype._getResourceBindingConfig=function(){return{CC_labelTip:{varname:"labelTip",vartype:cc.Label},CC_nodeBottom:{varname:"nodeBottom",vartype:cc.Node},CC_nodeCloudBottom:{varname:"nodeCloudBottom",vartype:cc.Node},CC_nodeCloudCenter:{varname:"nodeCloudCenter",vartype:cc.Node},CC_nodeCloudTop:{varname:"nodeCloudTop",vartype:cc.Node}}},t.prototype.onLoad=function(){e.prototype.onLoad.call(this)},t.prototype.onResourceLoaded=function(){e.prototype.onResourceLoaded.call(this),this.nodeResource.setContentSize(a.default.size),this.originPos.push(this.nodeCloudTop.getPosition()),this.originPos.push(this.nodeCloudCenter.getPosition()),this.originPos.push(this.nodeCloudBottom.getPosition()),this.originPos.push(this.nodeBottom.getPosition()),this.duration=this.context.duration||this.duration,this.registerListeners({MSG_SCENE_LOADED:this.onMsgSceneLoaded}),this.setAsDefault(),this.needToPlayFadeInAfterLoaded&&this.playEffectIn()},t.prototype.start=function(){e.prototype.start.call(this)},t.prototype.update=function(t){e.prototype.update.call(this,t)},t.prototype.onDestroy=function(){e.prototype.onDestroy.call(this)},t.prototype.setAsDefault=function(){var e=this.nodeCloudCenter;e.stopAllActions(),e.setPosition(cc.v2(-a.default.size.width-200,e.y)),(e=this.nodeCloudTop).stopAllActions(),e.setPosition(cc.v2(a.default.size.width+200,e.y)),(e=this.nodeCloudBottom).stopAllActions(),e.setPosition(cc.v2(a.default.size.width+200,e.y))},t.prototype.playEffectIn=function(){var e=this;if(this.isResourceLoaded()){var t=this.nodeCloudCenter;t.stopAllActions(),t.setPosition(cc.v2(-a.default.size.width-200,t.y)),t.runAction(cc.sequence(cc.moveTo(this.duration,this.originPos[0]).easing(cc.easeIn(1.5)),cc.delayTime(.01),cc.callFunc(function(){cc.log("    fOnFadeInCompleted"),e.context.fOnFadeInCompleted instanceof Function&&e.context.fOnFadeInCompleted()}))),(t=this.nodeCloudTop).stopAllActions(),t.setPosition(cc.v2(a.default.size.width+200,t.y)),t.runAction(cc.moveTo(this.duration,this.originPos[1]).easing(cc.easeIn(1.5))),(t=this.nodeCloudBottom).stopAllActions(),t.setPosition(cc.v2(a.default.size.width+200,t.y)),t.runAction(cc.moveTo(this.duration,this.originPos[2]).easing(cc.easeIn(1.5)))}else this.needToPlayFadeInAfterLoaded=!0},t.prototype.playEffectOut=function(){var e=this,t=this.nodeCloudCenter;t.stopAllActions(),t.runAction(cc.sequence(cc.moveTo(this.duration,cc.v2(-a.default.size.width-200,t.y)).easing(cc.easeOut(1.5)),cc.delayTime(.01),cc.callFunc(function(){e.context.fOnFadeOutCompleted instanceof Function&&(e.context.fOnFadeOutCompleted(),e.removeFromParent(),e.destroy())}))),(t=this.nodeCloudTop).stopAllActions(),t.runAction(cc.moveTo(this.duration,cc.v2(a.default.size.width+200,t.y)).easing(cc.easeOut(1.5))),(t=this.nodeCloudBottom).stopAllActions(),t.runAction(cc.moveTo(this.duration,cc.v2(a.default.size.width+200,t.y)).easing(cc.easeOut(1.5)))},t.prototype.onMsgSceneLoaded=function(){this.playEffectOut()},t=__decorate([i],t)}(n.default));o.default=s,cc._RF.pop()},{"../../../ulframework/view/ViewBase":"ViewBase","../../manager/mgrDirector":"mgrDirector"}]},{},["ULNativeController","Const","mgrAchievement","mgrAd","mgrAlu","mgrCake","mgrCfg","mgrCop","mgrDebug","mgrDirector","mgrGuide","mgrNative","mgrNetwork","mgrPlayer","mgrPool","mgrRank","mgrRecord","mgrRole","mgrSdk","mgrShop","mgrSign","mgrSound","mgrStage","mgrText","mgrTip","mgrUnitTest","mgrWordFilter","StageScriptBase","StageScriptInfinite","sAchievement","sAvatar","sRankPlayer","TestAnimNode","TestFunc","TestParticle","TestSound","TestSpine","EditorCakeItem","EditorTransformController","vAdLuckyMatchDialog","vAdTryDialog","vAirDropDialog","vBuyItemDialog","vCdkDialog","vDebugInfoDialog","vDebugPickerDialog","vGameFailedDialog","vGameSettlementDialog","vGotItemDialog","vInfiniteSettlementDialog","vIntitleDialog","vMoreGameDialog","vNextChapterDialog","vOfflineDialog","vPromptDialog","vSettingDialog","vShopDialog","vShowCakeDialog","vSignDialog","vStageChooseDialog","LayerColor","singlePageReuseList","vAirDrop","vAvatar","vChapterItem","vGameCustomer","vGamePartIcon","vGameSettlementItem","vGameShowingPartIcon","vGuideArrow","vGuideMask","vGuideTip","vGuideView","vJumpOtherGame","vLevelBar","vMark","vMsgTip","vRankItem","vShopFreeItem","vShopItem","vSignBigItem","vSignSmallItem","vTitleBar","vWarpSceneNode","vDevTestScene","vGameScene","vHubScene","vLoadingScene","vRankScene","vUpdaterScene","init","main","LifeCycleMonitor","ScleableButton","Manager","NetworkAdapterBase","NetworkAdapterHttp","NetworkAdapterHttpUlServer","NetworkManager","NetworkTask","vUpdaterSceneBase","Base64","CfgParser","EventTouchEx","FSMObject","IPoolManagerCacheableObject","MsgHandler","PoolManager","Randomizer","SpriteEx","TaskManager","Timer","Tools","UnitTestCase","ul","AnimNode","DebugMenu","DebugMouseControlNode","DialogBase","FSMSceneBase","IReuseLayouter","Particle","ResourceNode","ReuseLayouterHBox","ReuseLayouterHGrid","ReuseLayouterVBox","ReuseLayouterVGrid","ReuseList","ReusePageView","SceneBase","Spine","SpriteBasedClippingNode","ViewBase","sdkdemocConfig","sdkdemoULCop","sdkdemohttprequest","sdkdemotools","ulsdkdemomanager","ulsdkdemomiddleware","sdkDemoModule"]);